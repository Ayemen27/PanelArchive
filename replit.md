# aaPanel - لوحة تحكم الخادم

## نظرة عامة على المشروع

**aaPanel** هو لوحة تحكم قوية لإدارة الخوادم مكتوبة بلغة Python/Flask. يتيح للمستخدمين إدارة الخوادم بسهولة من خلال واجهة ويب رسومية.

### المعلومات الأساسية
- **اللغة الأساسية**: Python 3.12
- **الإطار**: Flask مع Gunicorn
- **قاعدة البيانات**: SQLite (محلياً) / MySQL/PostgreSQL (إنتاج)
- **المنفذ الافتراضي**: 5000
- **المسار الافتراضي للإنتاج**: `/www/server/panel`

---

## الوضع الحالي للمشروع (آخر تحديث: 30 سبتمبر 2025)

### ✅ ما تم إنجازه
1. **البنية الأساسية**: 
   - التطبيق يعمل على Replit
   - ملف `.env` تم إعداده مع المتغيرات الأساسية
   - `runserver.py` جاهز ويعمل

2. **قاعدة البيانات**:
   - دعم متعدد لقواعد البيانات (SQLite, MySQL, PostgreSQL)
   - نظام migrations متقدم

3. **الأمان**:
   - نظام مراقبة أمني متقدم
   - دعم SSL/HTTPS
   - جدار حماية

### ⚠️ ما يحتاج تطوير
1. **نظام اكتشاف البيئة**: غير مكتمل (نسبة الإنجاز: 70%)
2. **Factory Pattern للإعدادات**: غير موجود (نسبة الإنجاز: 20%)
3. **متغيرات البيئة**: تحتاج تنظيم أفضل (نسبة الإنجاز: 60%)
4. **CI/CD Pipeline**: غير موجود (نسبة الإنجاز: 0%)
5. **نظام المراقبة والتنبيهات**: غير موجود (نسبة الإنجاز: 0%)

---

## البيئات المستهدفة

### 1. بيئة التطوير (Replit)
- المنفذ: ديناميكي من متغير `PORT`
- قاعدة البيانات: SQLite محلية
- بدون nginx
- وضع DEBUG مفعّل

### 2. بيئة الإنتاج (VPS)
- المنفذ: 5000 (خلف nginx)
- قاعدة البيانات: MySQL/PostgreSQL خارجية
- nginx كـ reverse proxy مع SSL
- systemd لإدارة العمليات

---

## البنية التقنية الحالية

### الملفات الرئيسية
- `runserver.py` - نقطة دخول التطبيق
- `runconfig.py` - إعدادات Gunicorn
- `BTPanel/__init__.py` - تهيئة Flask
- `class/config.py` - إعدادات قديمة
- `class_v2/config_v2.py` - إعدادات محدثة

### المجلدات المهمة
- `BTPanel/` - التطبيق الأساسي
- `class/` & `class_v2/` - المنطق البرمجي
- `data/` - ملفات البيانات والإعدادات
- `config/` - ملفات الإعدادات
- `vhost/` - إعدادات nginx/apache

---

## تفضيلات المستخدم والفريق

### متطلبات التوثيق
- يجب تحديث حالة كل مهمة فور إنجازها
- توثيق واضح لما تم إنجازه وما تبقى
- تمكين الفريق من معرفة نقطة التوقف ونقطة الاستكمال

### التواصل
- **اللغة المفضلة**: العربية فقط في جميع الردود
- التوثيق يجب أن يكون واضح ومفصل

---

## القرارات المعمارية

### القرار 1: استخدام Factory Pattern للإعدادات
- **التاريخ**: 30 سبتمبر 2025
- **السبب**: لتسهيل التبديل بين بيئات مختلفة
- **الحالة**: قيد التخطيط

### القرار 2: اعتماد Docker للنقل
- **التاريخ**: 30 سبتمبر 2025
- **السبب**: ضمان توافق البيئات
- **الحالة**: قيد التخطيط

---

## المشاكل المعروفة

1. **التعقيد**: البنية معقدة ومصممة للـ VPS أكثر من التطوير المحلي
2. **الاعتماديات**: بعض الميزات تتطلب root access وخدمات نظام
3. **التوافق**: بعض الميزات قد لا تعمل في Replit

---

## الملاحظات الفنية

### نقاط مهمة للمطورين
- التطبيق يستخدم Gunicorn مع GeventWebSocketWorker
- المسار الافتراضي محدد في الكود: `/www/server/panel`
- المنفذ يُقرأ من ملف `data/port.pl`
- دعم WebSocket موجود

### تحذيرات
- لا تشغل التطبيق كـ root
- تأكد من وجود المجلدات المطلوبة قبل التشغيل
- بعض الميزات تحتاج صلاحيات نظام

---

## آخر التغييرات (السجل)

### 30 سبتمبر 2025
- تم إنشاء ملف التوثيق الأولي
- تم فحص البنية الحالية
- تم تحديد نقاط الضعف والقوة
