# ๐ฅ ุฏููู UFW Firewall ุงูุดุงูู ูู aaPanel

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ูููุฑ ูุนูููุงุช ุดุงููุฉ ุญูู ุฅุนุฏุงุฏ ูุฅุฏุงุฑุฉ UFW (Uncomplicated Firewall) ูู ุชุทุจูู aaPanelุ ุจูุง ูู ุฐูู:

- โ ุฅุนุฏุงุฏ UFW ุชููุงุฆูุงู
- โ ุญูุงูุฉ ูู ูุฌูุงุช Brute Force (SSH rate limiting)
- โ ูุจุฏุฃ ุงูุงูุชูุงุฒุงุช ุงูุฃูู (Principle of Least Privilege)
- โ Logging ููุฑุงูุจุฉ
- โ Integration ูุน Docker ู systemd
- โ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง
- โ ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฃูููุฉ

---

## ๐ฏ ูุง ูู UFWุ

**UFW (Uncomplicated Firewall)** ูู ูุงุฌูุฉ ูุจุณุทุฉ ูุฅุฏุงุฑุฉ firewall ุนูู Linux. ูููุฑ:

### ุงููุฒุงูุง:
- ๐ก๏ธ **ุณูููุฉ ุงูุงุณุชุฎุฏุงู** - ุฃูุงูุฑ ุจุณูุทุฉ ููุงุถุญุฉ
- ๐ **ุฃูุงู ููู** - ูุญูู ูู ุงููุฌูุงุช ูุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจู
- โก **ุฃุฏุงุก ููุชุงุฒ** - ุชุฃุซูุฑ ุถุฆูู ุนูู ุงูุฃุฏุงุก
- ๐ **Logging ูุชูุฏู** - ุชุชุจุน ุฌููุน ูุญุงููุงุช ุงูุงุชุตุงู
- ๐ **Integration ุณูุณ** - ูุนูู ูุน iptables ู Docker

### ุงูุญูุงูุฉ ุงูููุฏูุฉ:
- โ **Port Scanning** - ุญูุงูุฉ ูู ูุญุต ุงูููุงูุฐ
- โ **Brute Force** - rate limiting ููุญูุงูุฉ ูู ุงููุฌูุงุช
- โ **Unauthorized Access** - ุฑูุถ ุงูุงุชุตุงูุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง
- โ **DDoS Mitigation** - ุชูููู ุชุฃุซูุฑ ูุฌูุงุช DDoS

---

## ๐ ุงููููุงุช ุงููุฑุชุจุทุฉ

### ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ:
- `setup_firewall.sh` - ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู ุงูุดุงูู

### ุงูุชูุซูู:
- `FIREWALL_SETUP.md` - ูุฐุง ุงูููู

---

## ๐จ ุชุญุฐูุฑ ุฃููู ุญุฑุฌ - ุฎุทุฑ `ufw reset`

### โ ูุง ุชุณุชุฎุฏู `ufw reset` ุฃุจุฏุงู ูู ุงูุฅูุชุงุฌ!

**`ufw reset` ูู ุฃูุฑ ุฎุทูุฑ ููุบุงูุฉ ููุฌุจ ุนุฏู ุงุณุชุฎุฏุงูู ุนูู ุฎูุงุฏู ุงูุฅูุชุงุฌ ุฃุจุฏุงู.**

#### ููุงุฐุง ูู ุฎุทูุฑุ

ุนูุฏ ุชูููุฐ `ufw reset`:

1. **โ ูุญุฐู ุฌููุน ุงูููุงุนุฏ ููุฑุงู**
   - ูู ููุงุนุฏ ุงูุญูุงูุฉ ุชููุณุญ ูู ุซุงููุฉ ูุงุญุฏุฉ
   - ุงูุฎุงุฏู ูุตุจุญ ููุดููุงู ุชูุงูุงู

2. **โ ูุนุทู UFW ุชูุงูุงู**
   - ุฌุฏุงุฑ ุงูุญูุงูุฉ ูุชููู ุนู ุงูุนูู
   - ูุง ุชูุฌุฏ ุฃู ุญูุงูุฉ ุฎูุงู ูุฐู ุงููุชุฑุฉ

3. **โ ูุชุฑู ุงูุฎุงุฏู ููุดููุงู**
   - ุฃุซูุงุก ุฅุนุงุฏุฉ ุงูุชููููุ ุงูุฎุงุฏู ุจุฏูู ุญูุงูุฉ
   - ุงูููุงุฌููู ูููููู ุงููุตูู ุฅูู ุฃู ูููุฐ

4. **โ ุฅุฐุง ูุดู ุงูุณูุฑูุจุชุ UFW ูุจูู ูุนุทูุงู!**
   - ุฎุทุฃ ุจุณูุท ูู ุงูุณูุฑูุจุช = ุฎุงุฏู ุบูุฑ ูุญูู
   - ุงููุทุงุน ุงูุงุชุตุงู = ุฎุงุฏู ุบูุฑ ูุญูู
   - Ctrl+C = ุฎุงุฏู ุบูุฑ ูุญูู

#### ูุซุงู ุนูู ุงูุณููุงุฑูู ุงููุงุฑุซู:

```bash
# ุงูุณูุฑูุจุช ุงููุฏูู (ุฎุทูุฑ):
sudo ufw reset              # โ UFW ูุนุทู ุงูุขูุ ุงูุฎุงุฏู ููุดูู!
sudo ufw default deny       # โ ุฅุฐุง ูุดู ููุง...
sudo ufw allow 22           # โ ...ุฃู ููุง...
sudo ufw enable             # โ ...ุงูุฎุงุฏู ูุจูู ุจุฏูู ุญูุงูุฉ!

# ูุงุฐุง ูู ุญุฏุซ:
# - ุฎุทุฃ ูู ุงูุณุทุฑ 2ุ โ UFW ูุนุทู ููุฃุจุฏ
# - ุงููุทุน ุงูุงุชุตุงูุ โ UFW ูุนุทู ููุฃุจุฏ  
# - ุถุบุทุช Ctrl+Cุ โ UFW ูุนุทู ููุฃุจุฏ
# ุงููุชูุฌุฉ: ุฎุงุฏู ููุดูู ุชูุงูุงู ูููุฌูุงุช! ๐จ
```

### โ ุงูุทุฑููุฉ ุงูุขููุฉ - ููู ูุนูู ุงูุณูุฑูุจุช ุงูุฌุฏูุฏ

ุงูุณูุฑูุจุช ุงููุญุฏุซ (`setup_firewall.sh`) ูุณุชุฎุฏู ุทุฑููุฉ ุขููุฉ 100%:

#### 1. **ุนุฏู ุงุณุชุฎุฏุงู `reset` ุฃุจุฏุงู**
```bash
# โ ุงูุทุฑููุฉ ุงููุฏููุฉ ุงูุฎุทุฑุฉ:
sudo ufw reset

# โ ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ ุงูุขููุฉ:
# ูุญุต ุงููุงุนุฏุฉ ุงูููุฌูุฏุฉ
if ufw status | grep -q "22/tcp"; then
    # ุชุญุฏูุซ ุงููุงุนุฏุฉ ููุท
    sudo ufw delete allow 22/tcp
    sudo ufw limit 22/tcp
else
    # ุฅุถุงูุฉ ุงููุงุนุฏุฉ
    sudo ufw limit 22/tcp
fi
```

#### 2. **UFW ูุจูู ูููุนููุงู ุฏุงุฆูุงู**
- ูุง ูุชู ุชุนุทูู UFW ุฃุจุฏุงู ุฎูุงู ุงูุนูููุฉ
- ุงูููุงุนุฏ ุชูุญุฏูุซ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู
- ุงูุญูุงูุฉ ูุณุชูุฑุฉ ุทูุงู ุงูููุช

#### 3. **Trap Handler ููุญูุงูุฉ ูู ุงูุฃุฎุทุงุก**
```bash
# ุงูุญูุงูุฉ ุงูุชููุงุฆูุฉ ูู ุญุงูุฉ ุงููุดู
cleanup_on_error() {
    # ุฅุฐุง ุญุฏุซ ุฎุทุฃุ ุชุฃูุฏ ูู ุฃู UFW ูููุนูู
    if ! ufw status | grep -q "Status: active"; then
        echo "y" | ufw enable  # ุฅุนุงุฏุฉ ุชูุนูู ููุฑุงู
    fi
}
trap cleanup_on_error EXIT ERR INT TERM
```

**ุงูููุงุฆุฏ**:
- ูู ูุดู ุงูุณูุฑูุจุช โ UFW ูููุนูู ุชููุงุฆูุงู โ
- ูู ุถุบุทุช Ctrl+C โ UFW ูููุนูู ุชููุงุฆูุงู โ
- ูู ุงููุทุน ุงูุงุชุตุงู โ UFW ูุจูู ูููุนููุงู โ

#### 4. **Idempotent - ุขูู ููุชุดุบูู ุงููุชูุฑุฑ**
```bash
# ููููู ุชุดุบูู ุงูุณูุฑูุจุช 100 ูุฑุฉ ุจุฃูุงู
sudo ./setup_firewall.sh  # ุงููุฑุฉ ุงูุฃููู โ
sudo ./setup_firewall.sh  # ุงููุฑุฉ ุงูุซุงููุฉ โ
sudo ./setup_firewall.sh  # ุงููุฑุฉ ุงูุซุงูุซุฉ โ
# UFW ูุจูู ูููุนููุงู ููุนูู ุจุดูู ุตุญูุญ ุฏุงุฆูุงู
```

#### 5. **ุชุญุฏูุซ ุงูููุงุนุฏ ุจุฏูุงู ูู ุญุฐููุง**
```bash
# ุงูุณูุฑูุจุช ูุชุญูู ูู ุงูููุงุนุฏ ุงูููุฌูุฏุฉ ููุญุฏุซูุง ููุท
- ูุญุต ุงููุงุนุฏุฉ ุงูููุฌูุฏุฉ
- ุญุฐู ุงููุงุนุฏุฉ ุงููุฏููุฉ (ุฅู ูุฌุฏุช)
- ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุฌุฏูุฏุฉ
- UFW ูุจูู ูููุนููุงู ุทูุงู ุงูุนูููุฉ
```

### ๐ ููุงุฑูุฉ: ุงูุทุฑููุฉ ุงูุฎุทุฑุฉ vs ุงูุขููุฉ

| ุงููุนูุงุฑ | ุงูุทุฑููุฉ ุงููุฏููุฉ (`ufw reset`) | ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ (Safe Update) |
|---------|--------------------------------|-------------------------------|
| **ุงูุฃูุงู** | โ ุฎุทุฑ ุฌุฏุงู | โ ุขูู 100% |
| **UFW ุฎูุงู ุงูุชุดุบูู** | โ ูุนุทู | โ ูููุนูู ุฏุงุฆูุงู |
| **ุงูุญูุงูุฉ ูู ุงูุฃุฎุทุงุก** | โ ูุง ููุฌุฏ | โ Trap handler |
| **Idempotent** | โ ูุง | โ ูุนู |
| **ุงูุชุนุงูู ุงูุชููุงุฆู** | โ ูุง | โ ูุนู |
| **ุฎุทุฑ ููุฏุงู ุงูุญูุงูุฉ** | โ๏ธ ุนุงูู ุฌุฏุงู | โ ุตูุฑ |

### ๐ฏ ุงูุฎูุงุตุฉ

**ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ ููุฃูุงู:**
```
โ ูุง ุชุณุชุฎุฏู: sudo ufw reset (ุนูู ุงูุฅุทูุงู!)
โ ุงุณุชุฎุฏู: sudo ./setup_firewall.sh (ุขูู ููุญูู)
```

**ุฅุฐุง ููุช ุจุญุงุฌุฉ ูุฅุนุงุฏุฉ ุงูุชูููู:**
1. โ ุงุณุชุฎุฏู `sudo ./setup_firewall.sh` - ุขูู ููุญูู
2. โ ุฃู ุญุฏูุซ ุงูููุงุนุฏ ูุฏููุงู ุจู `ufw delete` ุซู `ufw allow`
3. โ ุฃู ุงุณุชุฎุฏู `ufw reload` ูุฅุนุงุฏุฉ ุชุญููู ุงูููุงุนุฏ
4. โ **ูุง ุชุณุชุฎุฏู `ufw reset` ุฃุจุฏุงู!**

---

## ๐จ ุฎุทุฑ SSH Lockout - ุญูุงูุฉ ูุงููุฉ

### โ๏ธ ูุง ูู SSH Lockoutุ

**SSH Lockout** ูุญุฏุซ ุนูุฏูุง ุชููุฏ ุงููุตูู ุฅูู ุงูุฎุงุฏู ุนุจุฑ SSH ุจุณุจุจ ุฎุทุฃ ูู ุชูููู firewall:

**ุงูุณููุงุฑูู ุงููุงุฑุซู:**
```bash
# ุฎุงุฏู ูุณุชุฎุฏู SSH ุนูู ุงููููุฐ 2222
# ุงูุณูุฑูุจุช ุงููุฏูู (ุฎุทูุฑ):
1. ูุญุฐู ูุงุนุฏุฉ ุงููููุฐ 2222  # โ ุงููุตูู ููููุฏ ุงูุขู!
2. ูุณุฃู: "ูุง ูู ูููุฐ SSHุ [22]"
3. ุงููุณุชุฎุฏู ูุถุบุท Enter (default: 22)
4. ูุถูู ูุงุนุฏุฉ ูููููุฐ 22 ููุท
5. ุงููุชูุฌุฉ: โ ูุง ูููู ุงูุงุชุตุงู ุจู 2222 ููุง 22
6. ๐ซ ุงูุฎุงุฏู ููููุฏ ุชูุงูุงู - ุชุญุชุงุฌ console access!
```

**ุงูุชูููุฉ:**
- ๐ฐ ุงุณุชุฎุฏุงู console access (ูุฏููุน ุนูุฏ ุจุนุถ ุงููุฒูุฏูู)
- โฑ๏ธ ุชููู ุงูุฎุฏูุฉ (downtime)
- ๐ฐ stress ูููู
- ๐ง ุชุฏุฎู ูุฏูู ูุนูุฏ

### โ ููู ูุญูู ุงูุณูุฑูุจุช ุงูุฌุฏูุฏ ูู SSH Lockoutุ

#### 1. **ุงูุชุดุงู ุชููุงุฆู ุฐูู ููููุฐ SSH ุงููุดุท**

ุงูุณูุฑูุจุช ููุญุต **4 ูุตุงุฏุฑ** ุจุงูุชุฑุชูุจ:

```bash
๐ ูุตุงุฏุฑ ุงูุงูุชุดุงู (ุจุงูุฃููููุฉ):

1. ุงูุงุชุตุงูุงุช ุงููุดุทุฉ (Active Connections)
   โ ุฃุนูู ุฃููููุฉ - ุงููููุฐ ุงูุฐู ุชุชุตู ููู ุงูุขู!
   โ ุงูุฃูุงูุฑ: ss -tnp | netstat -tnp
   
2. ุชูููู sshd (/etc/ssh/sshd_config)
   โ ููุฑุฃ "Port" directive
   โ ูุตุฏุฑ ููุซูู ููุชูููู ุงููุนูู
   
3. ุงูููุงูุฐ ุงููุณุชูุนุฉ (Listening Ports)
   โ ููุญุต ุงูููุงูุฐ ุงูุชู ูุณุชูุน ุนูููุง sshd
   โ ุงูุฃูุฑ: ss -tln
   
4. ููุงุนุฏ UFW ุงูููุฌูุฏุฉ
   โ ููุฑุฃ ููุงุนุฏ SSH ุงูุญุงููุฉ
   โ fallback ุฃุฎูุฑ
```

**ูุซุงู ุนูู ูุงุชุฌ ุงููุญุต:**
```
๐ ูุชุงุฆุฌ ุงููุญุต:
  โข ูู ุงูุงุชุตุงูุงุช ุงููุดุทุฉ: 2222 โ
  โข ูู sshd_config: 2222 โ
  โข ูู ููุงุนุฏ UFW: 2222 โ
  โข ูู ุงูููุงูุฐ ุงููุณุชูุนุฉ: 2222 โ
  
โ ุชู ุงูุชุดุงู ุงููููุฐ ูู ุงูุงุชุตุงูุงุช ุงููุดุทุฉ: 2222
```

#### 2. **ุญูุงูุฉ ููุงุนุฏ SSH - ูุง ุญุฐู ูุจู ุงูุชุฃููุฏ**

**ุงูุทุฑููุฉ ุงูุขููุฉ:**
```bash
# โ ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ ุงูุขููุฉ:
1. ูุญุต ุงููุงุนุฏุฉ ุงูููุฌูุฏุฉ
2. ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุฌุฏูุฏุฉ ุฃููุงู (ุฅุฐุง ูุงูุช ูุฎุชููุฉ)
3. ุงูุชุฃูุฏ ูู ูุฌุงุญ ุงูุฅุถุงูุฉ
4. ููุท ุจุนุฏ ุฐูู: ุญุฐู ุงููุงุนุฏุฉ ุงููุฏููุฉ
5. UFW ูุจูู ูููุนููุงู ุทูุงู ุงูุนูููุฉ

# ุงููุชูุฌุฉ: ุฏุงุฆูุงู ููุงู ูุงุนุฏุฉ SSH ูุดุทุฉ! โ
```

#### 3. **Safeguards ูุชุนุฏุฏุฉ**

```bash
โ ุชุญุฐูุฑุงุช ูุงุถุญุฉ ุนูุฏ ุชุบููุฑ ุงููููุฐ
โ ุทูุจ ุชุฃููุฏ ุตุฑูุญ (ุงูุชุจ "YES" ุจุงูุฃุญุฑู ุงููุจูุฑุฉ)
โ ููุงุฑูุฉ ุงููููุฐ ุงููุทููุจ ูุน ุงูููุชุดู
โ ุงูุชุญูู ูู ุฌูุณุงุช SSH ุงููุดุทุฉ
โ Trap handler ูุงุณุชุนุงุฏุฉ ุงูููุงุนุฏ ุนูุฏ ุงูุฃุฎุทุงุก
```

#### 4. **Trap Handler ููุชุนุงูู ุงูุชููุงุฆู**

```bash
# ุฅุฐุง ุญุฏุซ ุฃู ุฎุทุฃ ุฃู ููุงุทุนุฉ:
cleanup_on_error() {
    1. ุชูุนูู UFW ุฅุฐุง ูุงู ูุนุทูุงู
    2. ุงุณุชุนุงุฏุฉ ูุงุนุฏุฉ SSH ุนูู ุงููููุฐ ุงูููุชุดู
    3. ุฅุนุงุฏุฉ ุชุญููู ุงูููุงุนุฏ
    # ุงููุชูุฌุฉ: ุงูุฎุงุฏู ูุญูู ุฏุงุฆูุงู! โ
}

# ูุนูู ูู ุญุงูุงุช:
- ุฎุทุฃ ูู ุงูุณูุฑูุจุช (error)
- Ctrl+C (interrupt)
- Kill signal (terminate)
- Exit ููุงุฌุฆ
```

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ุงูุฅุนุฏุงุฏ ุงูุฃููู (5 ุฏูุงุฆู)

```bash
# 1. ุชุญููู ุงูุณูุฑูุจุช ุฅูู VPS
scp setup_firewall.sh user@vps:/home/user/

# 2. ููุญ ุตูุงุญูุฉ ุงูุชูููุฐ
chmod +x setup_firewall.sh

# 3. ุชุดุบูู ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู (ุชูุงุนูู)
sudo ./setup_firewall.sh

# ุฃู: ุชุดุบูู ุชููุงุฆู (non-interactive)
sudo ./setup_firewall.sh -y
```

### 2. ุงููุถุน ุงูุชูุงุนูู (Interactive Mode)

ุณูุทูุจ ููู ุงูุณูุฑูุจุช:

**ุฃ. ูููุฐ SSH**
```
ุงููููุฐ ุงูููุชุดู ุญุงููุงู: 2222 โ

ูู ุชุฑูุฏ ุงุณุชุฎุฏุงู ูููุฐ SSH ูุฎุชููุ [y/n]: n
โ ุณูุชู ุงุณุชุฎุฏุงู ุงููููุฐ ุงูููุชุดู: 2222 โ ุขูู!
```

ุฃู ุฅุฐุง ุฃุฑุฏุช ุงูุชุบููุฑ:
```
ูู ุชุฑูุฏ ุงุณุชุฎุฏุงู ูููุฐ SSH ูุฎุชููุ [y/n]: y

โ๏ธ  ุชุญุฐูุฑ: ุชุบููุฑ ูููุฐ SSH ูุฏ ูุคุฏู ูููุฏุงู ุงูุงุชุตุงู!

ุฃุฏุฎู ุฑูู ูููุฐ SSH ุงูุฌุฏูุฏ: 22

๐จ ุงููููุฐ ุงููุทููุจ (22) ูุฎุชูู ุนู ุงูููุชุดู (2222)!

ูู ุฃูุช ูุชุฃูุฏ 100% ุฃู sshd ูุนูู ุนูู ุงููููุฐ 22ุ
ุฅุฐุง ูุงู ุงูุฌูุงุจ ูุงุ ุณุชููุฏ ุงููุตูู ุฅูู ุงูุฎุงุฏู!

ุงูุชุจ 'YES' ุจุงูุฃุญุฑู ุงููุจูุฑุฉ ููุชุฃููุฏ: YES
โ ุชู ูุจูู ุงููููุฐ (ุนูู ูุณุคูููุชู!)
```

**ุจ. ููุงูุฐ ุฅุถุงููุฉ** (ุงุฎุชูุงุฑู)
```
ูู ุชุฑูุฏ ูุชุญ ููุงูุฐ ุฅุถุงููุฉุ [y/n]: y
ุฃุฏุฎู ุฃุฑูุงู ุงูููุงูุฐ ููุตููุฉ ุจูุณุงูุงุช: 3000 8080 5432
```

**ุฌ. ูุณุชูู ุงูุชุณุฌูู**
```
ูุณุชูู ุงูุชุณุฌูู (Logging):
  1) off    - ุจุฏูู ุชุณุฌูู
  2) low    - ููุฎูุถ
  3) medium - ูุชูุณุท (ููุตู ุจู) โญ
  4) high   - ุนุงูู
  5) full   - ูุงูู
  
ุงุฎุชุฑ ูุณุชูู ุงูุชุณุฌูู [3]: 3
```

### 3. ุงููุถุน ุงูุชููุงุฆู (Non-Interactive Mode) - ููู CI/CD

**ููุงุณุชุฎุฏุงู ูู Automation ุฃู CI/CD:**

```bash
# ุงูุทุฑููุฉ 1: ุนูู -y
sudo ./setup_firewall.sh -y

# ุงูุทุฑููุฉ 2: ุนูู --non-interactive
sudo ./setup_firewall.sh --non-interactive

# ุงูุทุฑููุฉ 3: ุนูู --yes
sudo ./setup_firewall.sh --yes
```

**ูุง ูุญุฏุซ ูู Non-Interactive Mode:**
```
โ ุงูุชุดุงู ุชููุงุฆู ููููุฐ SSH (ุจุฏูู ุณุคุงู)
โ ุงุณุชุฎุฏุงู ุงููููุฐ ุงูููุชุดู (ุขูู 100%)
โ ุฅุนุฏุงุฏุงุช ุงูุชุฑุงุถูุฉ ุขููุฉ:
   โข SSH port: ุงูููุชุดู ุชููุงุฆูุงู
   โข HTTP: 80
   โข HTTPS: 443
   โข Logging: medium
โ ูุง ุชูุฌุฏ prompts - ูุนูู ุจุตูุช
โ ูุซุงูู ููู CI/CD pipelines
```

**ูุซุงู: ุงุณุชุฎุฏุงู ูู GitHub Actions**
```yaml
- name: Setup UFW Firewall
  run: |
    chmod +x setup_firewall.sh
    sudo ./setup_firewall.sh -y
```

**ูุซุงู: ุงุณุชุฎุฏุงู ูู Ansible**
```yaml
- name: Setup UFW Firewall
  script: setup_firewall.sh -y
  become: yes
```

### 4. ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏ (1 ุฏูููุฉ)

```bash
# ุนุฑุถ ุญุงูุฉ UFW
sudo ufw status verbose

# ุนุฑุถ ุงูููุงุนุฏ ุงููุฑููุฉ
sudo ufw status numbered

# ุนุฑุถ ุงูุณุฌูุงุช
sudo tail -f /var/log/ufw.log

# ุงูุชุญูู ูู SSH (ูู terminal ุขุฎุฑ!)
ssh -p <detected_port> user@server
```

### 5. ุงุฎุชุจุงุฑ ููู ุจุนุฏ ุงูุฅุนุฏุงุฏ

**โ๏ธ ูุง ุชุบูู terminal ุงูุญุงูู ุญุชู ุชุฎุชุจุฑ!**

```bash
# 1. ุงูุชุญ terminal ุฌุฏูุฏ
# 2. ุงุชุตู ุจุงูุฎุงุฏู:
ssh -p <your_ssh_port> user@server

# 3. ุฅุฐุง ูุฌุญ ุงูุงุชุตุงู:
#    โ ูู ุดูุก ูุนูู! ููููู ุฅุบูุงู Terminal ุงููุฏูู

# 4. ุฅุฐุง ูุดู ุงูุงุชุตุงู:
#    โ ูุง ุชุบูู Terminal ุงููุฏูู!
#    ๐ง ุงุณุชุฎุฏู ุงูุชูุซูู ุฃุฏูุงู ููุฅุตูุงุญ
```

---

## ๐ ุฅุฌุฑุงุกุงุช ุงูุทูุงุฑุฆ - ุฅุฐุง ุญุฏุซ SSH Lockout

### ุงูุณููุงุฑูู 1: ูุง ูุฒุงู ูุฏูู Terminal ููุชูุญ

**โ ุงูุญู ุงูุฃุณุฑุน:**

```bash
# ูู Terminal ุงูููุชูุญ ุงูุญุงูู:

# 1. ูุญุต ุงูููุงุนุฏ ุงูุญุงููุฉ
sudo ufw status numbered

# 2. ุฅุฐุง ูุงูุช ูุงุนุฏุฉ SSH ููุฌูุฏุฉ ุนูู ูููุฐ ุฎุงุทุฆ:
sudo ufw delete <rule_number>

# 3. ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุตุญูุญุฉ
sudo ufw limit <correct_port>/tcp comment 'SSH - fixed'

# 4. ุฅุนุงุฏุฉ ุชุญููู
sudo ufw reload

# 5. ุงุฎุชุจุงุฑ ูู terminal ุขุฎุฑ
ssh -p <correct_port> user@server
```

**ูุซุงู ุนููู:**
```bash
# ูููุชุฑุถ ุฃู SSH ูุนูู ุนูู 2222 ููู ุงููุงุนุฏุฉ ุนูู 22
sudo ufw status numbered
# Output:
# [1] 22/tcp        LIMIT       Anywhere

# ุญุฐู ุงููุงุนุฏุฉ ุงูุฎุงุทุฆุฉ
sudo ufw delete 1

# ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุตุญูุญุฉ
sudo ufw limit 2222/tcp comment 'SSH - corrected'
sudo ufw reload

# ุงุฎุชุจุงุฑ
ssh -p 2222 user@server  # โ ูุฌุจ ุฃู ูุนูู ุงูุขู
```

### ุงูุณููุงุฑูู 2: ููุฏุช ุงููุตูู ุชูุงูุงู (ูุง Terminal ููุชูุญ)

**๐ง ุงูุญููู ุจุงูุชุฑุชูุจ:**

#### ุงูุญู 1: ุงุณุชุฎุฏุงู Console Access (ุงูุฃุณุฑุน)

ูุนุธู ูุฒูุฏู VPS ูููุฑูู **Console Access** (VNC/Serial):

```bash
# 1. ุงูุชุญ Console ูู ููุญุฉ ุงูุชุญูู:
#    - DigitalOcean: Console Access
#    - AWS EC2: EC2 Instance Connect / Session Manager
#    - Google Cloud: Serial Console
#    - Azure: Serial Console
#    - Linode: LISH Console

# 2. ุณุฌู ุฏุฎูู ุจู root/user

# 3. ูุญุต ูููุฐ SSH ุงููุนูู:
grep "^Port" /etc/ssh/sshd_config
# ุฃู
ss -tlnp | grep sshd

# 4. ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุตุญูุญุฉ:
sudo ufw limit <detected_port>/tcp comment 'SSH - emergency fix'
sudo ufw reload

# 5. ุงุฎุชุจุงุฑ ูู ุฌูุงุฒู
ssh -p <detected_port> user@server
```

#### ุงูุญู 2: ุงุณุชุนุงุฏุฉ ูู Backup

```bash
# ูู Console:

# 1. ุนุฑุถ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
ls -lah /root/ufw_backups/

# 2. ุนุฑุถ ุขุฎุฑ backup
cat /root/ufw_backups/ufw_rules_<latest>.txt

# 3. ุฅุฐุง ูุงู ูุญุชูู ุนูู ุงููุงุนุฏุฉ ุงูุตุญูุญุฉุ ููููู:
#    ุฅุถุงูุฉ ุงูููุงุนุฏ ูุฏููุงู ูู ุงูbackup

# ูุซุงู:
# ุฅุฐุง ูุงู backup ูุธูุฑ:
# 2222/tcp     LIMIT       Anywhere

# ุฃุถููุง:
sudo ufw limit 2222/tcp
sudo ufw reload
```

#### ุงูุญู 3: ุชุนุทูู UFW ูุคูุชุงู (ุญู ุฃุฎูุฑ!)

**โ๏ธ ุชุญุฐูุฑ: ูุฐุง ูุชุฑู ุงูุฎุงุฏู ุจุฏูู ุญูุงูุฉ - ุงุณุชุฎุฏูู ููุท ูู ุงูุถุฑูุฑุฉ ุงููุตูู!**

```bash
# ูู Console:

# 1. ุชุนุทูู UFW ูุคูุชุงู
sudo ufw disable

# 2. ุงูุขู ููููู ุงูุงุชุตุงู ุนุจุฑ SSH ุนูู ุฃู ูููุฐ
ssh -p <your_ssh_port> user@server

# 3. ุจุนุฏ ุงูุงุชุตุงูุ ุฃุตูุญ ุงูููุงุนุฏ:
sudo ufw status
sudo ufw limit <correct_ssh_port>/tcp
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 4. ุฅุนุงุฏุฉ ุชูุนูู UFW
sudo ufw enable
sudo ufw reload

# 5. ุงุฎุชุจุฑ ูู terminal ุขุฎุฑ ูุจู ุฅุบูุงู ุงูุฌูุณุฉ ุงูุญุงููุฉ!
```

### ุงูุณููุงุฑูู 3: ูุง ููุฌุฏ Console Access ูุชุงุญ

**ุงูุญููู ุงูุงุญุชุฑุงููุฉ:**

#### ุฃ. ุงุณุชุฎุฏุงู Rescue Mode (ุฅุฐุง ูุงู ูุชุงุญุงู)

```bash
# 1. ุฃุนุฏ ุชุดุบูู VPS ูู Rescue Mode ูู ููุญุฉ ุงูุชุญูู
#    (ูุชุงุญ ูู: DigitalOcean, Linode, Hetzner, OVH)

# 2. ุจุนุฏ ุงูุชุดุบูู ูู Rescue Mode:
#    - ูู ุจู mount ุงููุฑุต ุงูุฃุณุงุณู
#    - ุนุฏู ูููุงุช UFW ูุจุงุดุฑุฉ
#    - ุฃุนุฏ ุงูุชุดุบูู ุงูุนุงุฏู

# ูุซุงู (Ubuntu/Debian):
mkdir /mnt/root
mount /dev/vda1 /mnt/root  # ูุฏ ูุฎุชูู device name

# ุชุนุทูู UFW
rm /mnt/root/etc/ufw/ufw.conf
# ุฃู ุชุนุฏูู rules ูุจุงุดุฑุฉ
nano /mnt/root/etc/ufw/user.rules

# ุฅุนุงุฏุฉ ุงูุชุดุบูู
reboot
```

#### ุจ. ุฅุนุงุฏุฉ ุฅูุดุงุก VPS ูู Snapshot

```bash
# ุฅุฐุง ูุงู ูุฏูู snapshot ูุฏูู:

# 1. ุฃูุดุฆ VPS ุฌุฏูุฏ ูู ุขุฎุฑ snapshot (ูุจู ุชุดุบูู ุงูุณูุฑูุจุช)
# 2. ุงููู IP ุงูุนุงู ุฅูู VPS ุงูุฌุฏูุฏ (ุฅุฐุง ุฃููู)
# 3. ุฃู ุงุณุชุฎุฏู VPS ุงูุฌุฏูุฏ ูุญุฏุซ DNS
# 4. ุงูุขู ูุฏูู ูุตูู ูุงูู

# ููุงุญุธุฉ: ุณุชููุฏ ุฃู ุชุบููุฑุงุช ุจุนุฏ ุขุฎุฑ snapshot
```

### ุงูุณููุงุฑูู 4: ููุน ุงููุดููุฉ ูู ุงูุฃุณุงุณ

**๐ก๏ธ ุงูููุงูุฉ ุฎูุฑ ูู ุงูุนูุงุฌ:**

#### 1. ุงุณุชุฎุฏู Screen ุฃู Tmux

```bash
# ูุจู ุชุดุบูู ุงูุณูุฑูุจุช:
screen -S firewall_setup
# ุฃู
tmux new -s firewall_setup

# ุซู ุดุบู ุงูุณูุฑูุจุช:
sudo ./setup_firewall.sh

# ูุงุฆุฏุฉ:
# - ูู ุงููุทุน ุงูุงุชุตุงูุ ุงูุฌูุณุฉ ุชุจูู
# - ููููู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุจู:
screen -r firewall_setup
# ุฃู
tmux attach -t firewall_setup
```

#### 2. ุงุฎุชุจุงุฑ ูู Environment ุขูู ุฃููุงู

```bash
# 1. ุงุฎุชุจุฑ ุนูู VPS ุชุฌุฑูุจู ุฃููุงู
# 2. ุฃู ุงุณุชุฎุฏู Vagrant/Docker ููุงุฎุชุจุงุฑ ุงููุญูู
# 3. ุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ูุจู ุชุทุจููู ุนูู ุงูุฅูุชุงุฌ
```

#### 3. ุฃุฎุฐ Snapshot ูุจู ุงูุชุบููุฑุงุช

```bash
# ูุจู ุชุดุบูู ุงูุณูุฑูุจุช:
# 1. ุงุฐูุจ ูู ููุญุฉ ุชุญูู VPS
# 2. ุฎุฐ Snapshot ููุฎุงุฏู
# 3. ุดุบู ุงูุณูุฑูุจุช
# 4. ุฅุฐุง ุญุฏุซุช ูุดููุฉุ ุงุณุชุนุฏ ูู Snapshot

# ูู DigitalOcean:
doctl compute droplet-action snapshot <droplet-id> --snapshot-name "before-firewall-setup"

# ูู AWS:
aws ec2 create-snapshot --volume-id <volume-id> --description "before-firewall-setup"
```

#### 4. ุงุณุชุฎุฏู Non-Interactive Mode ููุงุฎุชุจุงุฑ

```bash
# ุงุฎุชุจุฑ ุฃููุงู ูู non-interactive mode:
sudo ./setup_firewall.sh -y

# ูุฐุง ูุณุชุฎุฏู ุงููููุฐ ุงูููุชุดู ุชููุงุฆูุงู (ุขูู)
# ุฅุฐุง ุนูู ุจูุฌุงุญุ ููููู ุงููุซูู ุจู
```

### ูุตุงุฆุญ ุฃูุงู ุฅุถุงููุฉ

**โ ุฃูุถู ุงูููุงุฑุณุงุช:**

```bash
# 1. ุงูุชุญ ุฏุงุฆูุงู 2 terminals:
Terminal 1: ููุชุนุฏููุงุช
Terminal 2: ููุงุฎุชุจุงุฑ (ูุง ุชุบููู!)

# 2. ุงุฎุชุจุฑ ูุจู ุงูุฅุบูุงู:
# ูู Terminal 2:
ssh -p <port> user@server "echo 'Access OK'"

# 3. ุงุณุชุฎุฏู timeout ููุฃูุงูุฑ ุงูุญุฑุฌุฉ:
timeout 30 sudo ./setup_firewall.sh

# 4. ุงุญุชูุธ ุจู SSH keepalive:
# ูู ~/.ssh/config:
Host *
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

---

## ๐ ููู ุงูุณูุงุณุงุช ูุงูููุงุนุฏ

### ุงูุณูุงุณุงุช ุงูุงูุชุฑุงุถูุฉ (Default Policies)

```bash
# ุฑูุถ ุฌููุน ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ
sudo ufw default deny incoming

# ุงูุณูุงุญ ุจุฌููุน ุงูุงุชุตุงูุงุช ุงูุตุงุฏุฑุฉ
sudo ufw default allow outgoing

# ุฑูุถ ุฌููุน ุงูุงุชุตุงูุงุช ุงูููุฌูุฉ
sudo ufw default deny routed
```

**ุงูููุณูุฉ**: **Deny by default, allow explicitly**
- ๐ ูู ุดูุก ูุฑููุถ ุงูุชุฑุงุถูุงู (ุขูู)
- โ ููุท ูุง ุชุญุชุงุฌู ูุณููุญ (principle of least privilege)

### ุงูููุงุนุฏ ุงูููุทุจููุฉ

#### 1. SSH ูุน Rate Limiting โญ

```bash
sudo ufw limit 22/tcp comment 'SSH with rate limiting'
```

**ูุงุฐุง ููุนูุ**
- ูุณูุญ ุจู **6 ูุญุงููุงุช ุงุชุตุงู ุฎูุงู 30 ุซุงููุฉ**
- ุจุนุฏ ุฐูู ูุชู ุญุธุฑ IP ูุคูุชุงู
- ูุญูู ูู ูุฌูุงุช **Brute Force**

**ูุซุงู**:
- ูุญุงูู ูุญุงูู ุชุฎููู ูููุฉ ุงููุฑูุฑ
- ุจุนุฏ 6 ูุญุงููุงุช ูุงุดูุฉ ุฎูุงู 30 ุซุงููุฉ
- ูุชู ุญุธุฑู ูุคูุชุงู โ ุงููุฌูู ููุดู ๐ก๏ธ

#### 2. HTTP (ูููุฐ 80)

```bash
sudo ufw allow 80/tcp comment 'HTTP'
```

- ููู Web traffic ุงูุนุงุฏู
- ููุณุชุฎุฏู ูุจู ุงูุญุตูู ุนูู SSL
- ุจุนุฏ SSLุ ููุนุงุฏ ุชูุฌููู ุชููุงุฆูุงู ุฅูู HTTPS

#### 3. HTTPS (ูููุฐ 443)

```bash
sudo ufw allow 443/tcp comment 'HTTPS'
```

- ููู Web traffic ุงูููุดููุฑ
- ูุทููุจ ูู SSL/TLS
- ุงูุงุชุตุงู ุงูุขูู ูููุณุชุฎุฏููู

#### 4. ููุงูุฐ ูุฎุตุตุฉ (Custom Ports)

```bash
# ูุซุงู: ุชุทุจูู Node.js ุนูู ูููุฐ 3000
sudo ufw allow 3000/tcp comment 'Node.js app'

# ูุซุงู: ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL
sudo ufw allow 5432/tcp comment 'PostgreSQL'
```

---

## ๐ ุฅุฏุงุฑุฉ ุงูููุงุนุฏ

### ุนุฑุถ ุงูููุงุนุฏ

```bash
# ุญุงูุฉ ุจุณูุทุฉ
sudo ufw status

# ุญุงูุฉ ููุตูุฉ (ููุตู ุจู)
sudo ufw status verbose

# ูุงุฆูุฉ ูุฑููุฉ (ููุญุฐู)
sudo ufw status numbered
```

**ูุซุงู ุนูู ุงููุงุชุฌ**:
```
Status: active
Logging: on (medium)

To                         Action      From
--                         ------      ----
22/tcp                     LIMIT       Anywhere
80/tcp                     ALLOW       Anywhere
443/tcp                    ALLOW       Anywhere
3000/tcp                   ALLOW       Anywhere
```

### ุฅุถุงูุฉ ููุงุนุฏ ุฌุฏูุฏุฉ

#### ุทุฑููุฉ 1: ุจุงููููุฐ

```bash
# ุงูุณูุงุญ ุจูููุฐ TCP
sudo ufw allow 8080/tcp

# ุงูุณูุงุญ ุจูููุฐ UDP
sudo ufw allow 3000/udp

# ุงูุณูุงุญ ุจูููุฐ (ุฃู ุจุฑูุชูููู)
sudo ufw allow 5000
```

#### ุทุฑููุฉ 2: ุจุงูุฎุฏูุฉ

```bash
# ุงูุณูุงุญ ุจู SSH
sudo ufw allow ssh

# ุงูุณูุงุญ ุจู HTTP
sudo ufw allow http

# ุงูุณูุงุญ ุจู HTTPS
sudo ufw allow https
```

#### ุทุฑููุฉ 3: ูู IP ูุญุฏุฏ

```bash
# ุงูุณูุงุญ ูู IP ูุงุญุฏ
sudo ufw allow from 192.168.1.100

# ุงูุณูุงุญ ูู IP ุฅูู ูููุฐ ูุญุฏุฏ
sudo ufw allow from 192.168.1.100 to any port 22

# ุงูุณูุงุญ ูู ูุทุงู IPs (subnet)
sudo ufw allow from 192.168.1.0/24
```

#### ุทุฑููุฉ 4: ูุน Rate Limiting

```bash
# ุญูุงูุฉ ูู Brute Force (ููุตู ุจู ููุฎุฏูุงุช ุงูุญุณุงุณุฉ)
sudo ufw limit 22/tcp

# ุญูุงูุฉ API ูู DDoS
sudo ufw limit 8080/tcp
```

#### ุทุฑููุฉ 5: ูุน ุชุนููู (Comment)

```bash
# ุฅุถุงูุฉ ุชุนููู ููุชูุถูุญ
sudo ufw allow 3000/tcp comment 'Node.js Application'
sudo ufw allow 5432/tcp comment 'PostgreSQL Database'
sudo ufw limit 2222/tcp comment 'Custom SSH port'
```

### ุญุฐู ููุงุนุฏ

#### ุทุฑููุฉ 1: ุจุงูุฑูู (ููุตู ุจู)

```bash
# 1. ุนุฑุถ ุงูููุงุนุฏ ูุฑููุฉ
sudo ufw status numbered

# 2. ุญุฐู ุงููุงุนุฏุฉ ุจุฑูููุง
sudo ufw delete 3
```

#### ุทุฑููุฉ 2: ุจุงููุงุนุฏุฉ ููุณูุง

```bash
# ุญุฐู ุจููุณ ุตูุบุฉ ุงูุฅุถุงูุฉ
sudo ufw delete allow 8080/tcp
sudo ufw delete allow from 192.168.1.100
```

### ุชุนุทูู/ุชูุนูู ูุงุนุฏุฉ

```bash
# ุชุนุทูู ูุงุนุฏุฉ
sudo ufw deny 8080/tcp

# ุฅุนุงุฏุฉ ุชูุนูู
sudo ufw allow 8080/tcp
```

### ุฅุนุงุฏุฉ ุชุญููู ุงูููุงุนุฏ

```bash
# ุฅุนุงุฏุฉ ุชุญููู (ุจุฏูู ูุทุน ุงูุงุชุตุงูุงุช ุงูุญุงููุฉ)
sudo ufw reload

# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ
sudo systemctl restart ufw
```

---

## ๐ ุงููุฑุงูุจุฉ ูุงูู Logging

### ูุณุชููุงุช ุงูุชุณุฌูู (Logging Levels)

| ุงููุณุชูู | ุงููุตู | ุงูุงุณุชุฎุฏุงู |
|---------|-------|-----------|
| `off` | ุจุฏูู ุชุณุฌูู | ุบูุฑ ููุตู ุจู |
| `low` | ุงูุญุฏ ุงูุฃุฏูู | ุจูุฆุฉ ุงูุชุทููุฑ |
| `medium` | ูุชูุณุท โญ | **ุงูุฅูุชุงุฌ (ููุตู ุจู)** |
| `high` | ุชูุตููู | ุงุณุชูุดุงู ุงูุฃุฎุทุงุก |
| `full` | ูู ุดูุก | ุชุญููู ุฃููู ุนููู |

### ุชุบููุฑ ูุณุชูู ุงูุชุณุฌูู

```bash
# ุชุนููู ูุณุชูู medium (ููุตู ุจู)
sudo ufw logging medium

# ุชุนููู ูุณุชูู high ููุชุญููู
sudo ufw logging high

# ุชุนุทูู ุงูุชุณุฌูู
sudo ufw logging off
```

### ุนุฑุถ ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุขุฎุฑ 50 ุณุทุฑ
sudo tail -n 50 /var/log/ufw.log

# ูุชุงุจุนุฉ ุงูุณุฌูุงุช ูุจุงุดุฑุฉ (real-time)
sudo tail -f /var/log/ufw.log

# ุงูุจุญุซ ุนู ูุญุงููุงุช ูุญุธูุฑุฉ
sudo grep "BLOCK" /var/log/ufw.log

# ุงูุจุญุซ ุนู IP ูุญุฏุฏ
sudo grep "192.168.1.100" /var/log/ufw.log

# ุนุฑุถ ุขุฎุฑ 100 ูุญุงููุฉ ูุญุธูุฑุฉ
sudo grep "BLOCK" /var/log/ufw.log | tail -n 100
```

### ููู ุงูุณุฌูุงุช

**ูุซุงู ุนูู ุณุทุฑ log**:
```
Jan 15 10:30:45 server kernel: [UFW BLOCK] IN=eth0 OUT= MAC=... SRC=203.0.113.45 DST=198.51.100.10 LEN=60 TOS=0x00 PREC=0x00 TTL=54 ID=12345 DF PROTO=TCP SPT=54321 DPT=22 WINDOW=65535 RES=0x00 SYN URGP=0
```

**ุงูุชูุณูุฑ**:
- `UFW BLOCK` - ุชู ุญุธุฑ ุงูุทูุจ
- `SRC=203.0.113.45` - ุนููุงู IP ุงููุตุฏุฑ
- `DST=198.51.100.10` - ุนููุงู IP ุงููุฌูุฉ
- `DPT=22` - ุงููููุฐ ุงููุณุชูุฏู (SSH)
- `PROTO=TCP` - ุงูุจุฑูุชูููู ุงููุณุชุฎุฏู

### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุฃูุซุฑ IPs ูุญุงููุฉ ููุงุชุตุงู
sudo grep "BLOCK" /var/log/ufw.log | awk '{print $11}' | cut -d'=' -f2 | sort | uniq -c | sort -rn | head -10

# ุฃูุซุฑ ุงูููุงูุฐ ุงุณุชูุฏุงูุงู
sudo grep "BLOCK" /var/log/ufw.log | awk '{print $17}' | cut -d'=' -f2 | sort | uniq -c | sort -rn | head -10

# ูุญุงููุงุช ุงูุงุชุตุงู ุฎูุงู ุขุฎุฑ ุณุงุนุฉ
sudo grep "$(date +%b\ %d\ %H)" /var/log/ufw.log | wc -l
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก (Troubleshooting)

### ุงููุดููุฉ 1: ูุง ุฃุณุชุทูุน ุงูุงุชุตุงู ุจู SSH ุจุนุฏ ุชูุนูู UFW

**ุงูุฃุนุฑุงุถ**:
- ุชู ุชูุนูู UFW
- ููุฏุช ุงูุงุชุตุงู ุจุงูุฎุงุฏู
- ูุง ุชุณุชุทูุน ุฅุนุงุฏุฉ ุงูุงุชุตุงู

**ุงูุณุจุจ**:
- ูู ูุชู ุงูุณูุงุญ ุจูููุฐ SSH ูุจู ุชูุนูู UFW

**ุงูุญู** (ูู console ุงูุฎุงุฏู):
```bash
# 1. ุชุนุทูู UFW ูุคูุชุงู
sudo ufw disable

# 2. ุงูุณูุงุญ ุจู SSH
sudo ufw allow 22/tcp

# 3. ุฅุนุงุฏุฉ ุชูุนูู UFW
sudo ufw enable
```

**ุงูููุงูุฉ**:
- **ุฏุงุฆูุงู** ุงุณูุญ ุจู SSH ูุจู ุชูุนูู UFW
- ุงุณุชุฎุฏู `setup_firewall.sh` ุงูุฐู ููุนู ุฐูู ุชููุงุฆูุงู

---

### ุงููุดููุฉ 2: ุงูุชุทุจูู ูุง ูุนูู ุจุนุฏ ุชูุนูู UFW

**ุงูุฃุนุฑุงุถ**:
- UFW ูููุนูู
- ุงูุชุทุจูู ูุนูู ุนูู ุงููููุฐ 3000
- ุงููุณุชุฎุฏููู ูุง ูุณุชุทูุนูู ุงููุตูู

**ุงูุณุจุจ**:
- ุงููููุฐ 3000 ุบูุฑ ูุณููุญ ูู UFW

**ุงูุญู**:
```bash
# 1. ุชุญูู ูู ุงููููุฐ ุงูุฐู ูุณุชูุน ุนููู ุงูุชุทุจูู
sudo netstat -tlnp | grep LISTEN

# 2. ุงุณูุญ ุจุงููููุฐ
sudo ufw allow 3000/tcp

# 3. ุชุญูู ูู ุงูููุงุนุฏ
sudo ufw status
```

---

### ุงููุดููุฉ 3: UFW ูุง ูุญุธุฑ ุงูุงุชุตุงูุงุช

**ุงูุฃุนุฑุงุถ**:
- UFW ูููุนูู
- ุงูุงุชุตุงูุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง ุชูุฑ

**ุงูุญู**:
```bash
# 1. ุชุญูู ูู ุญุงูุฉ UFW
sudo ufw status verbose

# 2. ุชุญูู ูู ุงูุณูุงุณุงุช ุงูุงูุชุฑุงุถูุฉ
# ูุฌุจ ุฃู ุชููู:
# Default: deny (incoming), allow (outgoing), deny (routed)

# 3. ุฅุฐุง ูุงูุช ุฎุงุทุฆุฉุ ุฃุนุฏ ุชุนููููุง
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 4. ุฅุนุงุฏุฉ ุชุญููู
sudo ufw reload
```

---

### ุงููุดููุฉ 4: Docker ูุชุฌุงูุฒ ููุงุนุฏ UFW

**ุงูุฃุนุฑุงุถ**:
- UFW ูููุนูู
- ุญุงููุงุช Docker ูููู ุงููุตูู ุฅูููุง ุฑุบู ุนุฏู ุงูุณูุงุญ ุจููุงูุฐูุง

**ุงูุณุจุจ**:
- Docker ูุถูู ููุงุนุฏ ูุจุงุดุฑุฉ ุฅูู iptables
- ูุชุฌุงูุฒ UFW

**ุงูุญู**:

#### ุงูุฎุทูุฉ 1: ุชุนุฏูู Docker daemon
```bash
# ุฅูุดุงุก/ุชุนุฏูู /etc/docker/daemon.json
sudo nano /etc/docker/daemon.json
```

ุฃุถู:
```json
{
  "iptables": false
}
```

#### ุงูุฎุทูุฉ 2: ุฅุนุงุฏุฉ ุชุดุบูู Docker
```bash
sudo systemctl restart docker
```

#### ุงูุฎุทูุฉ 3: ุฅุถุงูุฉ ููุงุนุฏ UFW ููุญุงููุงุช
```bash
# ูุซุงู: ุงูุณูุงุญ ุจุงููุตูู ุฅูู ุญุงููุฉ ุนูู ุงููููุฐ 8080
sudo ufw allow 8080/tcp comment 'Docker container'
```

**ุฃู** ุงุณุชุฎุฏู ุงูุญู ุงูุจุฏูู (ููุตู ุจู):

#### ุฅูุดุงุก ููู `/etc/ufw/after.rules`

ุฃุถู ูู ููุงูุฉ ุงูููู:
```bash
# Docker forwarding
*nat
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING ! -o docker0 -s 172.17.0.0/16 -j MASQUERADE
COMMIT

*filter
:DOCKER-USER - [0:0]
-A DOCKER-USER -j RETURN
COMMIT
```

ุซู:
```bash
sudo ufw reload
```

---

### ุงููุดููุฉ 5: Rate Limiting ูุญุธุฑูู ุฃูุง ุฃูุถุงู

**ุงูุฃุนุฑุงุถ**:
- ุชุญุงูู ุงูุงุชุตุงู ุจู SSH ุนุฏุฉ ูุฑุงุช
- ูุชู ุญุธุฑู

**ุงูุณุจุจ**:
- Rate limiting ูุนูู ููุง ูู ูุชููุน
- ูุญุงููุงุชู ุชุจุฏู ููุฌูู brute force

**ุงูุญู ุงููุคูุช**:
```bash
# ูู console ุงูุฎุงุฏู:
# ุฅุนุงุฏุฉ ุชุดุบูู UFW ูุฅุฒุงูุฉ ุงูุญุธุฑ ุงููุคูุช
sudo ufw reload

# ุฃู ุงูุงูุชุธุงุฑ 5-10 ุฏูุงุฆู
```

**ุงูุญู ุงูุฏุงุฆู**:
```bash
# ุงุณุชุฎุฏู SSH keys ุจุฏูุงู ูู ูููุฉ ุงููุฑูุฑ
# ูู ุชุญุชุงุฌ ูุฅุนุงุฏุฉ ุงููุญุงููุฉ

# ุฃู ุงุณูุญ ุจู IP ุงูุฎุงุต ุจู ุจุฏูู rate limiting
sudo ufw allow from YOUR_IP to any port 22
```

---

### ุงููุดููุฉ 6: UFW ูุง ูุจุฏุฃ ุชููุงุฆูุงู ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู

**ุงูุฃุนุฑุงุถ**:
- ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
- UFW ุบูุฑ ูููุนูู

**ุงูุญู**:
```bash
# ุชูุนูู ุงูุจุฏุก ุงูุชููุงุฆู
sudo systemctl enable ufw

# ุงูุชุญูู ูู ุงูุญุงูุฉ
sudo systemctl status ufw
```

---

## ๐ง ุฃูุงูุฑ ูุชูุฏูุฉ

### ุญุฐู ุฌููุน ุงูููุงุนุฏ

```bash
# ุฅุนุงุฏุฉ ุชุนููู UFW ุจุงููุงูู
sudo ufw reset
```

**โ๏ธ ุชุญุฐูุฑ**: ูุฐุง ุณูุญุฐู **ุฌููุน** ุงูููุงุนุฏ!

### ุชุตุฏูุฑ/ุงุณุชูุฑุงุฏ ุงูููุงุนุฏ

#### ุชุตุฏูุฑ ุงูููุงุนุฏ
```bash
# ุญูุธ ุงูููุงุนุฏ ุงูุญุงููุฉ
sudo ufw status numbered > ufw_rules_backup.txt
```

#### ุงุณุชูุฑุงุฏ ุงูููุงุนุฏ (ูุฏูู)
```bash
# ูุฑุงุกุฉ ุงูููู ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูููุงุนุฏ
# (ูุฌุจ ุงูููุงู ุจุฐูู ูุฏููุงู ุญุณุจ ุงูุญุงุฌุฉ)
```

### ููุงุนุฏ ูุชูุฏูุฉ

#### ุงูุณูุงุญ ูู ูุทุงู ูุญุฏุฏ ุฅูู ูููุฐ ูุญุฏุฏ
```bash
sudo ufw allow from 192.168.1.0/24 to any port 5432 proto tcp
```

#### ุฑูุถ IP ูุญุฏุฏ
```bash
sudo ufw deny from 203.0.113.45
```

#### ุงูุณูุงุญ ูู IPv6
```bash
# ุชูุนูู IPv6 ูู /etc/default/ufw
IPv6=yes

# ุซู ุฅุนุงุฏุฉ ุชุญููู
sudo ufw reload
```

---

## ๐ณ Integration ูุน Docker

### ุงููุดููุฉ

Docker ุจุดูู ุงูุชุฑุงุถู:
- ูุถูู ููุงุนุฏ ูุจุงุดุฑุฉ ุฅูู `iptables`
- ูุชุฌุงูุฒ UFW ุชูุงูุงู
- ููุชุญ ููุงูุฐ ุจุฏูู ุนููู

### ุงูุญู ุงูููุตู ุจู

#### ุงูุทุฑููุฉ 1: ุชุนุทูู Docker iptables (ุงูุฃุจุณุท)

**1. ุชุนุฏูู Docker daemon:**
```bash
sudo nano /etc/docker/daemon.json
```

ุฃุถู:
```json
{
  "iptables": false
}
```

**2. ุฅุนุงุฏุฉ ุชุดุบูู Docker:**
```bash
sudo systemctl restart docker
```

**3. ุฅุถุงูุฉ ููุงุนุฏ UFW ูุฏููุงู:**
```bash
# ููุญุงููุฉ ุงูุชู ุชุฑูุฏ ูุดููุง
sudo ufw allow 8080/tcp comment 'Docker web app'
```

**ุงููุฒุงูุง**:
- โ UFW ูุชุญูู ุจุงููุงูู
- โ ุณูู ุงูููู ูุงูุฅุฏุงุฑุฉ

**ุงูุนููุจ**:
- โ Docker networking ุฃูุซุฑ ุชุนููุฏุงู
- โ ูุฏ ุชุญุชุงุฌ ุฅุนุฏุงุฏ manual networking

---

#### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู DOCKER-USER chain (ูุชูุฏู)

**1. ุฅูุดุงุก ููู `/etc/ufw/after.rules`:**
```bash
sudo nano /etc/ufw/after.rules
```

**2. ุฅุถุงูุฉ ูู ููุงูุฉ ุงูููู:**
```bash
# BEGIN UFW AND DOCKER
*filter
:ufw-user-forward - [0:0]
:DOCKER-USER - [0:0]

# UFW-controlled access to Docker
-A DOCKER-USER -j ufw-user-forward
-A DOCKER-USER -j RETURN

# Allow established connections
-A DOCKER-USER -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT

# Drop everything else
-A DOCKER-USER -j DROP
COMMIT
# END UFW AND DOCKER
```

**3. ุฅุนุงุฏุฉ ุชุญููู UFW:**
```bash
sudo ufw reload
```

**4. ุงูุณูุงุญ ุจุงููุตูู ููุญุงููุงุช:**
```bash
# ุงูุณูุงุญ ูู ุฃู ููุงู
sudo ufw route allow proto tcp from any to any port 8080

# ุงูุณูุงุญ ูู IP ูุญุฏุฏ ููุท
sudo ufw route allow proto tcp from 192.168.1.0/24 to any port 8080
```

**ุงููุฒุงูุง**:
- โ Docker networking ูุนูู ุทุจูุนูุงู
- โ UFW ูุชุญูู ุจุงููุตูู

**ุงูุนููุจ**:
- โ ุฃูุซุฑ ุชุนููุฏุงู
- โ ูุญุชุงุฌ ููู ุนููู ูู iptables

---

### Docker Compose ูุซุงู

```yaml
version: '3'
services:
  web:
    image: nginx
    ports:
      - "127.0.0.1:8080:80"  # โญ bind ุฅูู localhost ููุท
    networks:
      - internal

networks:
  internal:
    driver: bridge
```

ุซู:
```bash
# ุงุณุชุฎุฏู nginx/apache ูู reverse proxy
# ูุงูุชุญ ููุท ููุงูุฐ 80/443 ูู UFW
```

**ุงููุงุฆุฏุฉ**:
- ุงูุญุงููุงุช ุบูุฑ ููุดููุฉ ูุจุงุดุฑุฉ
- UFW ูุชุญูู ูู reverse proxy ููุท

---

## ๐ก ุฃูุถู ุงูููุงุฑุณุงุช

### 1. ูุจุฏุฃ ุงูุงูุชูุงุฒุงุช ุงูุฃูู (Principle of Least Privilege)

```bash
# โ ุณูุก: ุงูุณูุงุญ ุจูู ุดูุก
sudo ufw allow from any to any

# โ ุฌูุฏ: ุงูุณูุงุญ ููุท ุจูุง ุชุญุชุงุฌู
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

**ุงููุงุนุฏุฉ**: ุงูุชุญ ููุท ุงูููุงูุฐ ุงูุชู ุชุญุชุงุฌูุง ูุนูุงู.

---

### 2. ุงุณุชุฎุฏู Rate Limiting ููุฎุฏูุงุช ุงูุญุณุงุณุฉ

```bash
# โ SSH ูุน rate limiting
sudo ufw limit 22/tcp

# โ API endpoints
sudo ufw limit 8080/tcp

# โ Login pages
sudo ufw limit 3000/tcp
```

**ุงููุงุฆุฏุฉ**: ุญูุงูุฉ ูู brute force ู DDoS.

---

### 3. ุงุณุชุฎุฏู Comments ููุชูุซูู

```bash
# โ ูุน ุชุนููู ูุงุถุญ
sudo ufw allow 3000/tcp comment 'Node.js Application'
sudo ufw allow 5432/tcp comment 'PostgreSQL Database - Internal only'

# โ ุจุฏูู ุชุนููู (ุตุนุจ ุงูุชุชุจุน)
sudo ufw allow 3000/tcp
```

**ุงููุงุฆุฏุฉ**: ุณูููุฉ ุงูุฅุฏุงุฑุฉ ูุงูุตูุงูุฉ.

---

### 4. ูุนูู Logging

```bash
# โ ุงูุชุณุฌูู ูููุนูู
sudo ufw logging medium

# ุนุฑุถ ุงูุณุฌูุงุช ุจุงูุชุธุงู
sudo tail -f /var/log/ufw.log
```

**ุงููุงุฆุฏุฉ**: ุงูุชุดุงู ุงููุฌูุงุช ูุงูุชูุฏูุฏุงุช ูุจูุฑุงู.

---

### 5. ุงุญูู SSH

#### ุฃ. ุงุณุชุฎุฏู SSH Keys ุจุฏูุงู ูู Passwords

```bash
# ุนูู ุฌูุงุฒู ุงููุญูู
ssh-keygen -t ed25519 -C "your-email@example.com"

# ูุณุฎ ุงูููุชุงุญ ุฅูู ุงูุฎุงุฏู
ssh-copy-id user@server

# ุชุนุทูู Password Authentication
sudo nano /etc/ssh/sshd_config
# ุถุน: PasswordAuthentication no
sudo systemctl restart sshd
```

#### ุจ. ุบููุฑ ูููุฐ SSH ุงูุงูุชุฑุงุถู

```bash
# ูู /etc/ssh/sshd_config
Port 2222

# ูู UFW
sudo ufw limit 2222/tcp comment 'Custom SSH port'
sudo ufw delete allow 22/tcp

# ุฅุนุงุฏุฉ ุชุดุบูู SSH
sudo systemctl restart sshd
```

#### ุฌ. ุนุทูู Root Login

```bash
# ูู /etc/ssh/sshd_config
PermitRootLogin no

# ุฅุนุงุฏุฉ ุชุดุบูู SSH
sudo systemctl restart sshd
```

---

### 6. ุฑุงูุจ ุงูุณุฌูุงุช ุจุงูุชุธุงู

#### ุฅูุดุงุก ุณูุฑูุจุช ูุฑุงูุจุฉ

```bash
# ุฅูุดุงุก /usr/local/bin/ufw-monitor.sh
sudo nano /usr/local/bin/ufw-monitor.sh
```

ุฃุถู:
```bash
#!/bin/bash
# UFW Monitor Script

echo "=== UFW Status ==="
ufw status verbose

echo ""
echo "=== Top 10 Blocked IPs (Last 24h) ==="
grep "$(date +%b\ %d)" /var/log/ufw.log | \
  grep "BLOCK" | \
  awk '{print $11}' | \
  cut -d'=' -f2 | \
  sort | uniq -c | \
  sort -rn | head -10

echo ""
echo "=== Top 10 Targeted Ports (Last 24h) ==="
grep "$(date +%b\ %d)" /var/log/ufw.log | \
  grep "BLOCK" | \
  awk '{print $17}' | \
  cut -d'=' -f2 | \
  sort | uniq -c | \
  sort -rn | head -10
```

ููุญ ุตูุงุญูุงุช:
```bash
sudo chmod +x /usr/local/bin/ufw-monitor.sh
```

ุชุดุบูู:
```bash
sudo /usr/local/bin/ufw-monitor.sh
```

---

### 7. ุงุณุชุฎุฏู Fail2ban ููุญูุงูุฉ ุงูุฅุถุงููุฉ

```bash
# ุชุซุจูุช Fail2ban
sudo apt install -y fail2ban

# ุชูุนูู SSH jail
sudo nano /etc/fail2ban/jail.local
```

ุฃุถู:
```ini
[sshd]
enabled = true
port = 22
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600
```

ุฅุนุงุฏุฉ ุชุดุบูู:
```bash
sudo systemctl restart fail2ban
sudo systemctl enable fail2ban
```

**ุงููุงุฆุฏุฉ**: ุญูุงูุฉ ุฃููู ูู brute force.

---

### 8. ุงุฎุชุจุฑ ุงูููุงุนุฏ ูุจู ุงูุชุทุจูู

```bash
# 1. ุงุฎุชุจุฑ ูู ุฌูุงุฒ ุขุฎุฑ
telnet server-ip 22

# 2. ุงุฎุชุจุฑ ุงูููุงูุฐ ุงูููุชูุญุฉ
nmap server-ip

# 3. ุชุญูู ูู ุงูุงุชุตุงูุงุช ุงูุญุงููุฉ
sudo netstat -tlnp

# 4. ุชุญูู ูู ุงูููุงุนุฏ
sudo ufw status verbose
```

---

### 9. ุงุตูุน ูุณุฎ ุงุญุชูุงุทูุฉ

```bash
# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ
sudo cp /etc/ufw/user.rules /root/ufw_backup/user.rules.$(date +%Y%m%d)
sudo cp /etc/ufw/user6.rules /root/ufw_backup/user6.rules.$(date +%Y%m%d)

# ุฃู ุงุณุชุฎุฏู script
sudo ufw status numbered > /root/ufw_backup/rules_$(date +%Y%m%d).txt
```

---

### 10. ูุซูู ูู ุงูุชุบููุฑุงุช

ุงุญุชูุธ ุจููู:
```bash
# /root/ufw_changes.log
echo "$(date): Added port 3000 for Node.js app" >> /root/ufw_changes.log
echo "$(date): Removed port 8080 - no longer needed" >> /root/ufw_changes.log
```

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุฅุนุฏุงุฏ ุฎุงุฏู Web ุจุณูุท

```bash
# 1. ุฅุนุฏุงุฏ ุงูุณูุงุณุงุช ุงูุงูุชุฑุงุถูุฉ
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 2. ุงูุณูุงุญ ุจู SSH (ูุน rate limiting)
sudo ufw limit 22/tcp comment 'SSH with rate limiting'

# 3. ุงูุณูุงุญ ุจู HTTP ู HTTPS
sudo ufw allow 80/tcp comment 'HTTP'
sudo ufw allow 443/tcp comment 'HTTPS'

# 4. ุชูุนูู UFW
sudo ufw enable

# 5. ุงูุชุญูู
sudo ufw status verbose
```

---

### ูุซุงู 2: ุฎุงุฏู ุชุทุจูู Node.js

```bash
# 1. ุงูุณูุงุณุงุช ุงูุฃุณุงุณูุฉ
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 2. SSH
sudo ufw limit 22/tcp comment 'SSH'

# 3. Nginx reverse proxy
sudo ufw allow 80/tcp comment 'Nginx HTTP'
sudo ufw allow 443/tcp comment 'Nginx HTTPS'

# 4. Node.js (internal only - bind to 127.0.0.1)
# ูุง ุญุงุฌุฉ ููุชุญ ูููุฐ ูู UFW

# 5. ุชูุนูู
sudo ufw enable
```

---

### ูุซุงู 3: ุฎุงุฏู ูุงุนุฏุฉ ุจูุงูุงุช

```bash
# 1. ุงูุณูุงุณุงุช ุงูุฃุณุงุณูุฉ
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 2. SSH
sudo ufw limit 22/tcp comment 'SSH'

# 3. PostgreSQL (ูู application servers ููุท)
sudo ufw allow from 192.168.1.100 to any port 5432 comment 'PostgreSQL from app-server-1'
sudo ufw allow from 192.168.1.101 to any port 5432 comment 'PostgreSQL from app-server-2'

# 4. ุชูุนูู
sudo ufw enable
```

---

### ูุซุงู 4: ูุญูุท Docker ูุงูู

```bash
# 1. ุชุนุทูู Docker iptables
sudo nano /etc/docker/daemon.json
# ุฃุถู: {"iptables": false}
sudo systemctl restart docker

# 2. ุฅุนุฏุงุฏ UFW
sudo ufw default deny incoming
sudo ufw default allow outgoing

# 3. SSH
sudo ufw limit 22/tcp

# 4. Nginx reverse proxy (ููุญุงููุงุช)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# 5. ููุงูุฐ ุงูุญุงููุงุช (ุฅุฐุง ูุฒู)
sudo ufw allow 3000/tcp comment 'Docker container - frontend'
sudo ufw allow 8080/tcp comment 'Docker container - backend'

# 6. ุชูุนูู
sudo ufw enable
```

---

### ูุซุงู 5: ูุชุญ ูููุฐ ูุคูุช

```bash
# ูุชุญ ูููุฐ ูุคูุช (ููุงุฎุชุจุงุฑ)
sudo ufw allow 9000/tcp

# ุจุนุฏ ุงูุงูุชูุงุกุ ุงุญุฐูู
sudo ufw status numbered
sudo ufw delete <number>
```

---

## ๐ ููุฎุต ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

### ุงูุฅุฏุงุฑุฉ ุงูุนุงูุฉ
```bash
sudo ufw enable                    # ุชูุนูู UFW
sudo ufw disable                   # ุชุนุทูู UFW (ุชุญุฐูุฑ: ูุนุทู ุงูุญูุงูุฉ!)
sudo ufw reload                    # ุฅุนุงุฏุฉ ุชุญููู ุงูููุงุนุฏ (ุขูู)
# sudo ufw reset                   # โ ุฎุทุฑ! ูุง ุชุณุชุฎุฏู ูู ุงูุฅูุชุงุฌ ุฃุจุฏุงู!
sudo ufw status                    # ุนุฑุถ ุงูุญุงูุฉ
sudo ufw status verbose            # ุญุงูุฉ ููุตูุฉ
sudo ufw status numbered           # ูุงุฆูุฉ ูุฑููุฉ
```

**โ๏ธ ุชุญุฐูุฑ ููู:**
- โ **ูุง ุชุณุชุฎุฏู `ufw reset` ูู ุงูุฅูุชุงุฌ ุฃุจุฏุงู** - ูุญุฐู ูู ุงูููุงุนุฏ ููุนุทู UFW!
- โ **ูุง ุชุณุชุฎุฏู `ufw disable` ุฅูุง ููุถุฑูุฑุฉ ุงููุตูู** - ูุนุทู ุงูุญูุงูุฉ ุชูุงูุงู!
- โ **ุงุณุชุฎุฏู `ufw reload` ูุฅุนุงุฏุฉ ุชุญููู ุงูููุงุนุฏ** - ุขูู ููุง ูุนุทู ุงูุญูุงูุฉ

### ุฅุถุงูุฉ ููุงุนุฏ
```bash
sudo ufw allow 80/tcp              # ุงูุณูุงุญ ุจูููุฐ
sudo ufw limit 22/tcp              # ูุน rate limiting
sudo ufw allow from 192.168.1.100 # ูู IP ูุญุฏุฏ
sudo ufw allow 3000/tcp comment 'My App'  # ูุน ุชุนููู
```

### ุญุฐู ููุงุนุฏ
```bash
sudo ufw delete allow 80/tcp       # ุญุฐู ุจุงููุงุนุฏุฉ
sudo ufw delete 3                  # ุญุฐู ุจุงูุฑูู
```

### ุงูุณูุงุณุงุช ุงูุงูุชุฑุงุถูุฉ
```bash
sudo ufw default deny incoming     # ุฑูุถ ุงููุงุฑุฏ
sudo ufw default allow outgoing    # ุงูุณูุงุญ ุจุงูุตุงุฏุฑ
sudo ufw default deny routed       # ุฑูุถ ุงูููุฌู
```

### ุงูุชุณุฌูู
```bash
sudo ufw logging medium            # ุชุนููู ุงููุณุชูู
sudo tail -f /var/log/ufw.log      # ุนุฑุถ ุงูุณุฌูุงุช
```

---

## ๐ ุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉ

### ุงูููุงุฑุฏ ุงูุฑุณููุฉ
- [Ubuntu UFW Documentation](https://help.ubuntu.com/community/UFW)
- [UFW Man Page](https://manpages.ubuntu.com/manpages/focal/man8/ufw.8.html)

### ุฃูุงูุฑ ุงููุณุงุนุฏุฉ
```bash
# ูุณุงุนุฏุฉ UFW
man ufw

# ูุณุงุนุฏุฉ ุณุฑูุนุฉ
ufw --help
```

---

## โ Checklist ูุจู ุงูุฅูุชุงุฌ

### ุงูุฃูุงู ุงูุฃุณุงุณู โ
- [ ] UFW ูุซุจุช ููููุนูู
- [ ] ุงูุณูุงุณุงุช ุงูุงูุชุฑุงุถูุฉ: deny incoming, allow outgoing
- [ ] SSH ูุณููุญ ูุน rate limiting
- [ ] HTTP (80) ู HTTPS (443) ูุณููุญูู
- [ ] ุงูููุงูุฐ ุงููุฎุตุตุฉ ููุชุทุจูู ููุชูุญุฉ
- [ ] Logging ูููุนูู (medium ุฃู ุฃุนูู)
- [ ] UFW ุณูุจุฏุฃ ุชููุงุฆูุงู ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู

### ุงูุฃูุงู ุงููุชูุฏู โก
- [ ] โ **ูู ูุชู ุงุณุชุฎุฏุงู `ufw reset` ุฃุจุฏุงู**
- [ ] โ **ุชู ุงุณุชุฎุฏุงู `setup_firewall.sh` ุงูุขูู**
- [ ] โ **UFW ุธู ูููุนููุงู ุทูุงู ุนูููุฉ ุงูุฅุนุฏุงุฏ**
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ูู ุฌูุงุฒ ุฎุงุฑุฌู
- [ ] ุชู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูููุงุนุฏ
- [ ] ุชู ุชูุซูู ุฌููุน ุงูููุงุนุฏ ูุงูุชุบููุฑุงุช
- [ ] Docker integration ูุญู (ุฅุฐุง ูุฒู)
- [ ] Fail2ban ูุซุจุช (ุงุฎุชูุงุฑู ููู ููุตู ุจู)

---

## ๐ ุงูุฎูุงุตุฉ

**UFW** ูู ุฃุฏุงุฉ ูููุฉ ูุจุณูุทุฉ ูุญูุงูุฉ ุฎุงุฏูู. ุจุงุชุจุงุน ูุฐุง ุงูุฏููู:

- โ ูุธุงูู ูุญูู ูู ุงููุฌูุงุช
- โ ููุท ุงูููุงูุฐ ุงูุถุฑูุฑูุฉ ููุชูุญุฉ
- โ SSH ูุญูู ูู brute force
- โ ุงูุณุฌูุงุช ุชุณุงุนุฏู ุนูู ุงููุฑุงูุจุฉ
- โ Integration ูุน Docker ูุนูู ุจุณูุงุณุฉ

**ุชุฐูุฑ**: ุงูุฃูุงู ูู ุนูููุฉ ูุณุชูุฑุฉุ ููุณ ุญุฏุซ ููุฑุฉ ูุงุญุฏุฉ. ุฑุงูุจุ ุญุฏูุซุ ูุญุณูู ุจุงูุชุธุงู.

---

**๐ ุฑูุงุจุท ุฐุงุช ุตูุฉ:**
- [NGINX_SETUP.md](NGINX_SETUP.md) - ุฅุนุฏุงุฏ Nginx
- [SSL_TLS_GUIDE.md](SSL_TLS_GUIDE.md) - ุฅุนุฏุงุฏ SSL/TLS

**๐ง ุงูุณูุฑูุจุชุงุช:**
- `setup_firewall.sh` - ุฅุนุฏุงุฏ ุชููุงุฆู ุดุงูู ูุขูู

---

## ๐ก๏ธ ุชุฐููุฑ ุฃููู ููุงุฆู - ุญุฑุฌ!

### โ ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ ููุฃูุงู

```
โ ูุง ุชุณุชุฎุฏู ุฃุจุฏุงู: sudo ufw reset
โ ูุง ุชุณุชุฎุฏู ุฃุจุฏุงู: sudo ufw disable (ุฅูุง ููุถุฑูุฑุฉ ุงููุตูู)
โ ุงุณุชุฎุฏู ุฏุงุฆูุงู: sudo ./setup_firewall.sh (ุขูู 100%)
โ ุงุณุชุฎุฏู ุฏุงุฆูุงู: sudo ufw reload (ูุฅุนุงุฏุฉ ุงูุชุญููู)
```

### ููุงุฐุง ูุฐุง ูููุ

**`ufw reset` ุฎุทูุฑ ูุฃูู:**
1. ูุญุฐู ูู ุงูููุงุนุฏ ููุฑุงู
2. ูุนุทู UFW ุชูุงูุงู
3. ูุชุฑู ุงูุฎุงุฏู ููุดููุงู ูููุฌูุงุช
4. ุฅุฐุง ูุดู ุงูุณูุฑูุจุชุ UFW ูุจูู ูุนุทูุงู!

**ุงูุณูุฑูุจุช ุงูุขูู (`setup_firewall.sh`) ูุถูู:**
- โ UFW ูุจูู ูููุนููุงู ุทูุงู ุงูููุช
- โ Trap handler ููุญูุงูุฉ ูู ุงูุฃุฎุทุงุก
- โ Idempotent - ุขูู ููุชุดุบูู ุงููุชูุฑุฑ
- โ ุชุญุฏูุซ ุงูููุงุนุฏ ุจุฏูุงู ูู ุญุฐููุง

### ุงูุฅุฌุฑุงุก ุงูุขูู ุฏุงุฆูุงู:

```bash
# โ ุงูุทุฑููุฉ ุงูุขููุฉ
sudo ./setup_firewall.sh

# โ ุฃู ุชุญุฏูุซ ุงูููุงุนุฏ ูุฏููุงู
sudo ufw delete allow 8080/tcp  # ุญุฐู ุงููุงุนุฏุฉ ุงููุฏููุฉ
sudo ufw allow 8080/tcp          # ุฅุถุงูุฉ ุงููุงุนุฏุฉ ุงูุฌุฏูุฏุฉ
sudo ufw reload                  # ุฅุนุงุฏุฉ ุงูุชุญููู

# โ ุงูุทุฑููุฉ ุงูุฎุทุฑุฉ (ูุง ุชุณุชุฎุฏู!)
# sudo ufw reset    โ ูุนุทู UFW ููุชุฑู ุงูุฎุงุฏู ููุดููุงู!
```

**ุชุฐูุฑ:** ุฃูุงู ุฎุงุฏูู ูุนุชูุฏ ุนูู ุจูุงุก UFW ูููุนููุงู ุฏุงุฆูุงู. ูุง ุชุฎุงุทุฑ ุจุงุณุชุฎุฏุงู `ufw reset`!

---

*ุขุฎุฑ ุชุญุฏูุซ: ุฃูุชูุจุฑ 2025 - ุชู ุฅุตูุงุญ ุงูุซุบุฑุฉ ุงูุฃูููุฉ ุงูุญุฑุฌุฉ*
