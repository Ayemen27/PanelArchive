import{_ as e}from"./index.js?v=1758532619827";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1758532619827";import{f as a,a as t,al as i,h as c}from"./public.js?v=1758532619827";import{_ as s}from"./index245.js?v=1758532619827";import{n,a7 as o,t as r,c as m,w as f,p as d}from"./page_layout.js?v=1758532619827";import{F as u,g as p}from"./index39.js?v=1758532619827";import{dc as y,dj as v,aC as b,dQ as _}from"./naive.js?v=1758532619827";import{k as g,P as k,i as w,r as h,X as x,c as j,R,a2 as C,a3 as $,U as z,a4 as D,V as U,aj as P,j as T}from"./vue.js?v=1758532619827";import"./common.js?v=1758532619827";import"./__commonjsHelpers__.js?v=1758532619827";import"./soft2.js?v=1758532619827";import"./soft.js?v=1758532619827";import"./file2.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827";const B={class:"recycle-wrapper"},F={class:"recycle-top"},q={class:"flex gap-20px"},M={class:"config-item"},O={class:"config-item"},N={class:"config-item"},G={class:"recycle-main"},K={class:"tabs"},H={class:"tab-content"},I={class:"mt-10px"},J=d(g({__name:"Recycle",setup(d,{expose:g}){const{t:J}=k(),Q=w("fileStore"),S=h(!1);g({open(){S.value=!0,le()},close(){S.value=!1}});const V=h("all"),X=h(!1),A=h([]),E=h([]),L=h([]),W=h(!1),Y=h(!1),Z=h([{type:"selection",width:40},{key:"name",title:()=>J("file.fileName"),render:e=>x("div",{class:"flex items-center gap-4px"},[x(u,{ext:e.ext},null),x("div",{class:"flex-1 w-0"},[x(y,null,{default:()=>[e.name]})])])},{key:"dname",title:()=>J("file.recycle.originalDirectory"),ellipsis:{tooltip:!0}},{key:"size",title:()=>J("file.size"),width:180,render:e=>n(e.size)},{title:()=>J("file.recycle.removalTime"),key:"time",width:200,render:e=>o(e.time)},a({width:200,options:e=>[{label:J("file.recycle.recover"),onClick:()=>{me(e)}},{label:J("file.recycle.deletePermanently"),onClick:()=>{fe(e)}}]})]),ee=[{key:"restore",label:J("file.recycle.batchRestore"),type:"confirm",confirm:{title:J("file.recycle.batchRestore"),desc:J("file.recycle.batchRestoreConfirm"),api:e=>r.post("/files?action=Re_Recycle_bin",{path:e.rname}),done:()=>{le(),p(Q)},columns:[{key:"name",title:()=>J("file.fileName")}]}},{key:"delete",label:J("file.recycle.batchDeletePermanently"),type:"confirm",confirm:{title:J("file.recycle.batchDeletePermanently"),desc:J("file.recycle.batchDeleteConfirm"),api:e=>r.post("/files?action=Del_Recycle_bin",{path:e.rname}),done:()=>{le()},columns:[{key:"name",title:()=>J("file.fileName")}]}}];async function le(){try{A.value=[],X.value=!0;const{message:e}=await r.post("/files?action=Get_Recycle_bin");m(e)&&(L.value=f(e.dirs)?e.dirs.map((e=>({...e,type:"dir",ext:"folder"}))):[],E.value=f(e.files)?e.files.map((e=>({...e,type:"file",ext:e.name.split(".").pop()||""}))):[],W.value=e.status,Y.value=e.status_db)}finally{X.value=!1}}const ae=["jpg","jpeg","png","bmp","gif","tiff","ico","JPG","webp"],te=["zip","rar","gz","war","tgz"],ie=["mp4","mp3","mpeg","mpg","mov","avi","webm","mkv","mkv","mp3","rmvb","wma","wmv"],ce=["iso","xlsx","xls","doc","docx","tiff","exe","so","7z","bz","dmg","apk","pptx","ppt","xlsb","pdf"],se=j((()=>{let e=[];switch(V.value){case"all":e=[...L.value,...E.value];break;case"folder":e=[...L.value];break;case"file":e=[...E.value];break;case"image":e=E.value.filter((e=>ae.some((l=>e.name.includes(".".concat(l))))));break;case"document":e=E.value.filter((e=>{const l=ae.some((l=>e.name.includes(".".concat(l)))),a=te.some((l=>e.name.includes(".".concat(l)))),t=ie.some((l=>e.name.includes(".".concat(l)))),i=ce.some((l=>e.name.includes(".".concat(l))));return l||a||t||i}));break;case"database":e=[...L.value,...E.value].filter((e=>e.name.includes("BTDB_")));break;default:e=[]}return e.sort(((e,l)=>l.time-e.time)),e})),ne=()=>{le()},oe=async e=>{const l={};"file"!==e&&(l[e]=1),await r.post("/files?action=Recycle_bin",l,{requestOptions:{loading:J("file.recycle.switching"),successMessage:!0}}),le()},re=()=>{i({text:J("file.recycle.emptyTitle"),title:J("file.recycle.emptyTitle"),content:J("file.recycle.emptyConfirm"),onConfirm:async()=>{await r.post("/files?action=Close_Recycle_bin","",{requestOptions:{loading:J("file.recycle.emptying"),successMessage:!0}}),le()}})},me=e=>{t({title:J("file.recycle.restoreFileTitle",{name:e.name}),content:J("file.recycle.restoreFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Re_Recycle_bin",{path:e.rname},{requestOptions:{loading:J("file.recycle.restoring"),successMessage:!0}}),le(),p(Q)}})},fe=e=>{i({text:J("file.delete"),title:J("file.recycle.deleteFileTitle",{name:e.name}),content:J("file.recycle.deleteFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Del_Recycle_bin",{path:e.rname},{requestOptions:{loading:J("file.recycle.deleting"),successMessage:!0}}),le()}})};return(a,t)=>{const i=v,n=b,o=_,r=s,m=c,f=l,d=e;return R(),C(d,{show:U(S),"onUpdate:show":t[7]||(t[7]=e=>P(S)?S.value=e:null),title:a.$t("file.recycle.title"),width:"80%"},{default:$((()=>[z("div",B,[z("div",F,[z("div",q,[z("div",M,[z("div",null,D(a.$t("file.recycle.fileRecycleBin")),1),x(i,{value:U(W),"onUpdate:value":[t[0]||(t[0]=e=>P(W)?W.value=e:null),t[1]||(t[1]=()=>oe("file"))]},null,8,["value"])]),z("div",O,[z("div",null,D(a.$t("file.recycle.databaseRecycleBin")),1),x(i,{value:U(Y),"onUpdate:value":[t[2]||(t[2]=e=>P(Y)?Y.value=e:null),t[3]||(t[3]=()=>oe("db"))]},null,8,["value"])]),z("div",N,D(a.$t("file.recycle.warning")),1)]),x(n,{onClick:re},{default:$((()=>[T(D(a.$t("file.recycle.emptyRecycleBin")),1)])),_:1})]),z("div",G,[z("div",K,[x(r,{value:U(V),"onUpdate:value":[t[4]||(t[4]=e=>P(V)?V.value=e:null),ne],panePadding:"0"},{default:$((()=>[x(o,{name:"all",tab:a.$t("file.recycle.all")},null,8,["tab"]),x(o,{name:"folder",tab:a.$t("file.recycle.folder")},null,8,["tab"]),x(o,{name:"file",tab:a.$t("file.recycle.file")},null,8,["tab"]),x(o,{name:"image",tab:a.$t("file.recycle.image")},null,8,["tab"]),x(o,{name:"document",tab:a.$t("file.recycle.document")},null,8,["tab"]),x(o,{name:"database",tab:a.$t("file.recycle.database")},null,8,["tab"])])),_:1},8,["value"])]),z("div",H,[x(m,{"checked-row-keys":U(A),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>P(A)?A.value=e:null),loading:U(X),"max-height":450,"row-key":"rname",columns:U(Z),data:U(se)},null,8,["checked-row-keys","loading","columns","data"]),z("div",I,[x(f,{"checked-row-keys":U(A),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>P(A)?A.value=e:null),"row-key":"rname","select-width":240,data:U(se),options:ee},null,8,["checked-row-keys","data"])])])])])])),_:1},8,["show","title"])}}}),[["__scopeId","data-v-2e0c3f71"]]);export{J as default};
