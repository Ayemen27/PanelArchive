const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/FileTask.js?v=1758532619827","js/page_layout.js?v=1758532619827","js/vue.js?v=1758532619827","js/__commonjsHelpers__.js?v=1758532619827","js/naive.js?v=1758532619827","js/common.js?v=1758532619827","js/public.js?v=1758532619827","css/public.css?v=1758532619827","css/page_layout.css?v=1758532619827","js/index.js?v=1758532619827","css/index108.css?v=1758532619827","js/soft2.js?v=1758532619827","js/soft.js?v=1758532619827","js/file2.js?v=1758532619827","js/index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827","css/FileTask.css?v=1758532619827","js/PasteConfirm.js?v=1758532619827","js/CalcVerify.js?v=1758532619827","css/CalcVerify.css?v=1758532619827","css/PasteConfirm.css?v=1758532619827","js/UploadFile.js?v=1758532619827","css/UploadFile.css?v=1758532619827","js/RemoteDownload.js?v=1758532619827","js/index.vue_vue_type_script_setup_true_lang.js?v=1758532619827","js/SearchFileContent.js?v=1758532619827","js/ResourceManagerWindow.js?v=1758532619827","css/ResourceManagerWindow.css?v=1758532619827","css/SearchFileContent.css?v=1758532619827","js/FavoriteList.js?v=1758532619827","js/ShareList.js?v=1758532619827","js/ShareDetail.vue_vue_type_script_setup_true_lang.js?v=1758532619827","js/Backup.js?v=1758532619827","js/Recycle.js?v=1758532619827","js/index.vue_vue_type_script_setup_true_lang12.js?v=1758532619827","js/index245.js?v=1758532619827","css/index59.css?v=1758532619827","css/Recycle.css?v=1758532619827","js/Terminal.js?v=1758532619827","js/terminal2.js?v=1758532619827","js/xterm.js?v=1758532619827","js/xterm-addon-canvas.js?v=1758532619827","css/xterm-addon-canvas.css?v=1758532619827","css/terminal.css?v=1758532619827","js/SoftLink.js?v=1758532619827","js/Share.js?v=1758532619827","js/index200.js?v=1758532619827","js/Permission.js?v=1758532619827","css/Permission.css?v=1758532619827","js/Properties.js?v=1758532619827","js/index108.js?v=1758532619827","css/index21.css?v=1758532619827","css/Properties.css?v=1758532619827","js/Del.js?v=1758532619827","css/Del.css?v=1758532619827","js/Compression.js?v=1758532619827","js/Decompress.js?v=1758532619827","js/index184.js?v=1758532619827","js/index101.js?v=1758532619827","css/index82.css?v=1758532619827"])))=>i.map(i=>d[i]);
import{v as t,r as e,i as a,t as n,x as i,m as l,c as s,w as o,a as r,be as c,p as u,cm as p,_ as d,n as f,a7 as m,h as v,R as h,q as y,u as g,cn as _,co as w,cp as b}from"./page_layout.js?v=1758532619827";import{r as k,aj as x,aC as C,aD as S,n as P,ap as z,X as R,F as O,_ as F,k as D,c as L,R as j,S as T,H as M,V as E,i as I,a2 as N,a3 as V,U as q,O as U,j as A,a4 as K,I as G,x as B,P as W,f as H,ad as Y,ae as J,o as X,an as Z,aw as Q,G as tt,l as et,v as at,ak as nt,av as it,w as lt,u as st,b as ot,$ as rt,p as ct,h as ut,a7 as pt,a0 as dt,aE as ft,a6 as mt}from"./vue.js?v=1758532619827";import{b as vt,a as ht,u as yt,q as gt}from"./public.js?v=1758532619827";import{_ as _t}from"./index.js?v=1758532619827";import{a0 as wt}from"./common.js?v=1758532619827";import{c as bt}from"./soft2.js?v=1758532619827";import{_ as kt,dc as xt,dm as Ct,aC as St,di as Pt,aZ as zt,au as Rt,az as Ot,dg as Ft,dh as Dt,de as Lt,dS as jt}from"./naive.js?v=1758532619827";import{a as Tt}from"./soft.js?v=1758532619827";import{i as Mt}from"./file2.js?v=1758532619827";import{_ as Et}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827";function It(t,a,n){e("FileEditorPath",n),openEditorView(t,a)}async function Nt(){await async function(){await t("/static/vite/oldjs/jquery-2.2.4.min.js?v=1758532619827"),await t("/static/layer/layer.js?v=1758532619827"),await t("/static/vite/oldjs/jsencrypt.min.js?v=1758532619827"),await t("/static/language/English/lan.js?v=1758532619827"),await t("/static/ace/ace.js?v=1758532619827"),await t("/static/ace/ext-language_tools.js?v=1758532619827"),await t("/static/vite/oldjs/polyfill.min.js?v=1758532619827"),await t("/static/vite/oldjs/public.js?v=1758532619827"),await t("/static/vite/oldjs/public_backup.js?v=1758532619827")}(),window.usePay=vt,$("#file-main").append('\n\t\t<script type="text/template" id="aceTmplate">\n\t\t\t\t<div id="ace_conter">\n\t\t\t\t\t\t<div class="ace_header" style="top: 0">\n\t\t\t\t\t\t\t\t<span class="saveFile"><i class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></i><span>Save</span></span>\n\t\t\t\t\t\t\t\t<span class="saveFileAll"><i class="glyphicon glyphicon-duplicate" aria-hidden="true"></i><span>Save All</span></span>\n\t\t\t\t\t\t\t\t<span class="refreshs"><i class="glyphicon glyphicon-refresh" aria-hidden="true"></i><span>Refresh</span></span>\n\t\t\t\t\t\t\t\t<span class="searchs"><i class="glyphicon glyphicon-search" aria-hidden="true"></i><span>Search</span></span>\n\t\t\t\t\t\t\t\t<span class="replaces"><i class="glyphicon glyphicon-retweet" aria-hidden="true"></i><span>Replace</span></span>\n\t\t\t\t\t\t\t\t<span class="jumpLine"><i class="glyphicon glyphicon-pushpin" aria-hidden="true"></i><span>JumpLine</span></span>\n\t\t\t\t\t\t\t\t<span class="fontSize"><i class="glyphicon glyphicon-text-width" aria-hidden="true"></i><span>Font</span></span>\n\t\t\t\t\t\t\t\t<span class="themes"><i class="glyphicon glyphicon-magnet" aria-hidden="true"></i><span>Theme</span></span>\n\t\t\t\t\t\t\t\t<span class="setUp"><i class="glyphicon glyphicon-cog" aria-hidden="true"></i><span>Set</span></span>\n\t\t\t\t\t\t\t\t<span class="helps"><i class="glyphicon glyphicon-question-sign" aria-hidden="true"></i><span>Help</span></span>\n\t\t\t\t\t\t\t\t<div class="pull-down" title="Hide toolbar" style="top: 0"><i class="glyphicon glyphicon-menu-down" aria-hidden="true"></i></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ace_overall" style="top: 35px;">\n\t\t\t\t\t\t\t\t\x3c!-- 编辑器目录 --\x3e\n\t\t\t\t\t\t\t\t<div class="ace_catalogue" style="left:0px">\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_title">Directory<div class="dir-menu-right"><span class="glyphicon glyphicon-minus" aria-hidden="true"></span></div></div>\n\t\t\t\t\t\t\t\t\t<div class="ace_dir_tools">\n\t\t\t\t\t\t\t\t\t\t<div class="upper_level"  title="Return to parent directory">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-share-alt" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>Back</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="search_file" title="Search File">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-search" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>Search</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="new_folder" title="File/Folder">\n\t\t\t\t\t\t\t\t\t\t\t<i class="glyphicon glyphicon-plus"  aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t<span>New</span>\n\t\t\t\t\t\t\t\t\t\t\t<ul class="folder_down_up">\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="2"><i class="folder-icon"></i>Folder</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="3"><i class="text-icon"></i>File</li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="refresh_dir" title="Refresh list">\n\t\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>\n\t\t\t\t\t\t\t\t\t\t\t<span>Refresh</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<span class="ace_editor_main_storey"></span>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_list">\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="cd-accordion-menu"></ul>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="ace_catalogue_menu">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="0"><i class="glyphicon glyphicon-refresh" aria-hidden="true"></i><span>Refresh</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="1"><i class="glyphicon glyphicon-folder-open" aria-hidden="true"></i><span>Subdirectory</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="2"><i class="folder-icon"></i><span>New Folder</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="3"><i class="text-icon"></i><span>New File</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="4"><i class="rename-icon img-icon"></i><span>Rename</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="5"><i class="down-icon img-icon"></i><span>Download</span></li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="6"><i class="del-icon img-icon"></i><span>Delete</span></li>\n\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_catalogue_drag_icon">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="drag_icon_conter"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="fold_icon_conter" title="Hide file directory"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\x3c!-- 编辑内容 --\x3e\n\t\t\t\t\t\t\t\t<div class="ace_editor_main">\n\t\t\t\t\t\t\t\t\t\t<ul class="ace_conter_menu"></ul>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_tips"><div class="tips"></div></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_editor_main_storey"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_editor"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="ace_conter_toolbar">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="pull-left size_ellipsis">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="path" class="size_ellipsis"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="pull-right">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="cursor"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="history"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="tab"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="encoding"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span data-type="lang"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="ace_toolbar_menu" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-tabs" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set tabs</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="tabsType">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="nbsp">Indent using spaces</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="tabs">Indent using "Tab"</li>\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title" style="margin-top:15px">Set the tab length</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul class="tabsSize">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="1">1</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="2">2</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="3">3</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="4">4</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="5">5</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-value="6">6</li>\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-encoding" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set file save encoding format</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-files" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="text" class="menu-input" placeholder="Input language mode">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-close" aria-hidden="true"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set file language association</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-fontSize" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set editor font size</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="set_font_size">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="12" max="45"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="tips error">Font setting range 12-45</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="btn-save">Save</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-jumpLine" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Jump to specified line</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-conter">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="set_jump_line">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="number" min="0"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button class="btn-save">Jump</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-themes" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Set editor theme</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-history" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">History version</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="menu-item menu-setUp"  style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t<div class="menu-title">Editor setting [ Some settings need to be restart editor ]</div>\n\t\t\t\t\t\t\t\t\t\t\t<ul class="editor_menu">\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="wrap">Auto wrap</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="enableLiveAutocompletion">Code autocomplete</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="enableSnippets">Enable snippets</li>\n\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="showInvisibles">Show hidden characters</li>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<li data-type="showLineNumbers">Show line numbers</li>\n\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t<\/script>\n\t')}function Vt(t,e,a){const n=k(!0),i=k(0),l=k(0),s=k(0),o=k(0),r=k(0),c=k(0),u=k(0),p=k(0);let d;x(t)?d=t.value:"string"==typeof t?d=document.querySelector(t):t instanceof Element&&(d=t);const f=function(){let t=null;return!!e&&(()=>{t||(t=setTimeout((()=>{e({m_flag:n,m_left:i,m_right:l,m_bottom:o,m_top:s,m_x:u,m_y:p,m_height:r,m_width:c}),clearTimeout(t),t=null}),10))})}();function m(t){const{left:e,right:a,top:n,bottom:d,height:f,width:m,x:v,y:h}=t.getBoundingClientRect();i.value=e,l.value=a,s.value=n,o.value=d,r.value=f,c.value=m,u.value=v,p.value=h}const v=t=>{if(a&&a(t,{m_flag:n,m_left:i,m_right:l,m_bottom:o,m_top:s,m_x:u,m_y:p,m_height:r,m_width:c}),!n.value)return;const{left:e,right:v,top:h,bottom:y}=d.getBoundingClientRect(),g=document.createElement("div"),_=t.clientX,w=t.clientY;g.style.position="absolute",g.style.left=_-e+"px",g.style.top=w-h+"px",g.style.width="0px",g.style.height="0px",g.style.backgroundColor="rgba(135, 182, 130, 0.1)",g.classList.add("district-wrapper"),d.appendChild(g),t.preventDefault();const{pause:b,resume:k,isActive:x}=C((()=>{R.scrollTop>=R.scrollHeight-R.clientHeight?b():(g.style.height=g.offsetHeight+10+"px",g.style.marginTop=parseInt(getComputedStyle(g).marginTop)-10+"px",R.scrollTop+=10,O=R.scrollTop,m(g),f&&f())}),{immediate:!1}),{pause:S,resume:P,isActive:z}=C((()=>{R.scrollTop<=0?S():(g.style.height=g.offsetHeight+10+"px",R.scrollTop-=10,F+=10,m(g),f&&f())}),{immediate:!1}),R=d.querySelector(".n-scrollbar-container");let O=0,F=0;document.onmousemove=t=>{t.preventDefault(),x.value||z.value||(_<=t.clientX?g.style.width=t.clientX-_+"px":(g.style.width=_-t.clientX+"px",g.style.marginLeft=-(_-t.clientX)+"px"),w<=t.clientY?(g.style.height=t.clientY-w+O+"px",g.style.marginTop=-O+"px"):(g.style.height=w-t.clientY+F+"px",g.style.marginTop=-(w-t.clientY)+"px"),t.clientX<e&&(g.style.width=_-e+"px",g.style.marginLeft=-(_-e)+"px"),t.clientX>v&&(g.style.width=v-_+"px")),t.clientY>y&&k(),t.clientY<h&&P(),m(g),f&&f()},document.onmouseup=()=>{document.onmousemove=null,d.contains(g)&&d.removeChild(g)}};return d&&(d.onmousedown=v),{m_flag:n,m_x:u,m_y:p,m_left:i,m_right:l,m_top:s,m_bottom:o,m_height:r,m_width:c}}function qt(t,e){const a=S(t.m_left),n=S(t.m_right),i=S(t.m_top),l=S(t.m_bottom),s=S(e.left),o=S(e.right),r=S(e.top),c=S(e.bottom);return!(o<a||s>n||c<i||r>l)}function Ut(t){t.card_hover=!0}function At(t){t.card_hover=!1}const{t:Kt}=a.global;async function Gt(t){const{shareList:e,shareListPage:a,shareListTotal:l}=t;try{const t=await n.post("/files?action=get_download_url_list",{p:a.value,row:12});return e.value=t.message.data,l.value=i(t.message.page),e.value}catch(s){return console.warn(s),[]}}async function Bt(t,e){try{await n.post("/files?action=remove_download_url",{id:e},{requestOptions:{loading:Kt("file.shareListModal.deletingShare"),successMessage:!0}}),Ht(t)}catch(a){console.warn(a)}}const $t=z((t=>re(t)),100),{t:Wt}=a.global;async function Ht(t,e){var a;const{tableLoading:n,currentPath:l,favoriteList:s,fileRecycle:o,fileList:r,filesView:c,dirNums:u,fileNums:p,total:d,page:f,size:m,sort:v,reverse:h,diskMountPoint:y,currentFile:g,currentDirSize:_,uploadFileList:w,dragUploadRef:b}=t;n.value=!0;try{const n=await ia(l.value,(t=>{s.value=t.store,o.value=t.file_recycle,u.value=t.dir.length,p.value=t.files.length,d.value=i(t.page),y.value=t.disk,l.value=t.path}),{p:f.value,showRow:m.value,...v.value?{sort:v.value,reverse:h.value}:{},disk:!0,...e});g.value=null,_.value=-1,f.value=1;const k=await Jt(t);let x=[];k.length&&(x=k.map((t=>t.key)));const C=await Gt(t);let S=[];C.length&&(S=C.map((t=>t.filename))),r.value=n.map((t=>(t.remarks_hover=!1,t.isEditRemarks=!1,t.isCreate=!1,t.card_hover=!1,t.card_choosed=!1,t.isRenameForCard=!1,t.operation_show=!1,x.includes(t.path)?t.isFavorite=!0:t.isFavorite=!1,S.includes(t.path)&&(t.isShare=!0),t))),w.value=[],null==(a=b.value)||a.listenDragEvent(),P((()=>{"list"==c.value&&(Yt(t),function(t){const{tableRef:e,choosePathRef:a}=t;let n=0;const i=setInterval((()=>{if(n<10?n++:clearInterval(i),e.value){const n=e.value;n.querySelector(".n-data-table-base-table-body")&&Yt(t),n.oncontextmenu=e=>{e.preventDefault(),Xt(e,t)},n.onclick=e=>{"INPUT"!=e.target.nodeName&&($t(t),a.value.handleEnterDown())},clearInterval(i)}}),1e3)}(t))})),function(t){const{choosedKeys:e,waitForPaste:a}=t;e.value=[]}(t)}catch(k){console.warn(k)}finally{n.value=!1}}function Yt(t){const{tableRef:e}=t;e.value&&Vt(e.value.querySelector(".n-data-table-base-table-body"),(e=>function(t,e){const{trRectArr:a,choosedKeys:n}=t,i=[];for(let l=0;l<a.value.length;l++){const[[t,n]]=Object.entries(a.value[l]);qt(e,n.getClientRects()[0])&&i.push(t)}n.value=[...new Set(i)]}(t,e)),((e,a)=>function(t,e,a){const{choosedKeys:n}=a;if(t.target.closest(".n-checkbox-box"))return;if(t.target.classList.contains("file-checkbox")){const e=t.target.closest("tr").dataset.key;return void(n.value.includes(e)?n.value=n.value.filter((t=>t!==e)):n.value.push(e))}if(function(t){const{normalTrList:e,trRectArr:a}=t;e.value=document.querySelectorAll('[class*="normal-tr"]');const n=[];for(let i=0;i<e.value.length;i++){const t=e.value[i].dataset.key;n.push({[t]:e.value[i]})}a.value=n}(a),t.target.closest("tr")){const e=t.target.closest("tr").dataset.key;if(0==t.button&&(n.value=[e]),2==t.button){if(n.value.includes(e))return;n.value=[e]}}"INPUT"==t.target.nodeName?e.m_flag.value=!1:e.m_flag.value=!0}(e,a,t)))}async function Jt(t){const{resetFavoriteOptions:e,favoriteOptions:a}=t;try{const t=(await n.post("/files?action=get_files_store",{},{requestOptions:{isOriginalResult:!0}})).message.map((t=>({icon:t.type,label:t.name,key:t.path})));return e(),a.value=[...t,...a.value],a.value}catch(i){return console.warn(i),[]}}function Xt(t,e){const{choosedKeys:a,contextRef:n}=e;let i="empty";t.target.closest("tr")&&(i=a.value.length>1?"multiple":1==a.value.length?"single":"empty"),n.value.filesOperation(t,i)}function Zt(){var t;const e=null==(t=document.querySelector("#createInput"))?void 0:t.querySelector("input");null==e||e.focus(),null==e||e.select()}const Qt=z(((t,e)=>{const{choosedKeys:a}=t;"dir"==e.type&&(a.value=[e.nm],Ge(t))}),200);async function te(t,e){const{close:a}=l.loading("Processing, please wait...");try{await bt("tamper_core",71);const{message:a}=await n.post("/tamper_core/get_effective_path.json",{path:e.path},{requestOptions:{isOriginalResult:!0}});if(s(a)&&a.status){const{data:n}=a;"dir"===e.type?function(t,e,a){const{pid:n,lock:i,action:l}=a,s=(i?"Turning off protection ":"Turning on protection ")+"[".concat(e.path,"]"),o=Wt(i?"file.tableController.afterTurningOffProtectionDir":"file.tableController.afterTurningOnProtectionDir");ht({width:480,title:s,content:o,onConfirm:async()=>{if("create"===l[0]&&0===n)return await ee(e.path,[]),void Ht(t);const a=[];i?a.push({key:-1!=e.path.indexOf("/www/server/panel/class")?"add_wd":l[0],values:[e.path]}):a.push({key:l[0],values:[e.path]}),await ae(n,a),Ht(t)}})}(t,e,n):function(t,e,a){const{pid:n,lock:i,action:l}=a,s=Wt(i?"file.tableController.turningOffProtection":"file.tableController.turningOnProtection",{path:e.path}),o=Wt(i?"file.tableController.afterTurningOffProtectionFile":"file.tableController.afterTurningOnProtectionFile"),r=k(!1),c=k(!0);ht({title:s,width:480,content:()=>R(O,null,[R("div",null,[o]),R("div",{class:"mt-8px"},[R(kt,{checked:c.value,"onUpdate:checked":t=>c.value=t},{default:()=>[R("span",null,[Wt(i?"file.tableController.turningOffProtectionFile":"file.tableController.turningOnProtectionFile",{path:e.nm})])]})]),R("div",{class:"mt-8px"},[R(kt,{checked:r.value,"onUpdate:checked":t=>r.value=t},{default:()=>[R("span",null,[Wt(i?"file.tableController.turningOffProtectionSuffix":"file.tableController.turningOnProtectionSuffix",{suffix:e.ext})])]})])]),onConfirm:async()=>{if("create"===l[0]&&0===n){const a=e.path.substring(0,e.path.lastIndexOf("/")),n=[];if(c.value){const t=e.path.split("/"),a=t.length>=2?t[t.length-2]:"";n.push("".concat(a,"/").concat(e.nm))}return r.value&&n.push("."+e.ext),await ee(a,n),void Ht(t)}const a=[];i?(c.value&&(a.push({key:"remove_bf",values:[e.path]}),a.push({key:"add_wf",values:[e.path]})),r.value&&a.push({key:"remove_bf",values:["."+e.ext]})):(c.value&&(a.push({key:"add_bf",values:[e.path]}),a.push({key:"remove_wf",values:[e.path]})),r.value&&a.push({key:"add_bf",values:["."+e.ext]})),await ae(n,a),Ht(t)}})}(t,e,n)}}finally{a()}}async function ee(t,e){const{message:a}=await n.post("/tamper_core/create_path.json",{path:t,exts:JSON.stringify(e)},{requestOptions:{loading:Wt("file.tableController.creatingDirectoryProtection"),isOriginalResult:!0}});if(s(a)){if(!a.status)return l.error(a.msg),Promise.reject();l.success(a.msg)}}async function ae(t,e){const{message:a}=await n.post("/tamper_core/batch_setting.json",{pid:t,settings:JSON.stringify(e)},{requestOptions:{loading:Wt("file.tableController.executing"),isOriginalResult:!0}});if(s(a)){if(!a.status)return l.error(a.msg),Promise.reject();l.success(a.msg)}}function ne(t,e){const{currentPreviewImg:a,previewShow:n}=t;a.value=e,n.value=!0}function ie(t,e){const{currentPreviewVideo:a,previewVideoShow:n}=t;a.value={path:e.path,name:e.nm},n.value=!0}async function le(t){const{currentFile:e,currentPath:a}=t;if(e.value&&(e.value.isCreate&&e.value.isRename||e.value.isRenameForCard)&&(e.value.editName||(e.value.isCreate=!1),e.value.editName==e.value.nm&&(e.value.isCreate=!1),e.value.isCreate&&e.value.isRename||e.value.isRenameForCard)){if(e.value.editName!==e.value.nm){try{await(n=e.value.path,i=a.value+"/"+e.value.editName,Ve(n,i,{rename:!0})),Ht(t)}catch(l){console.log(l)}finally{e.value.isCreate=!1,e.value.isRenameForCard=!1,e.value.isRename=!1}return!0}e.value.isCreate=!1,e.value.isRenameForCard=!1,e.value.isRename=!1}var n,i}async function se(t){const{currentFile:e,currentPath:a,fileList:i}=t;if(e.value&&e.value.isCreate&&!e.value.isRename)if(""==e.value.editName)i.value.shift();else try{return"dir"==e.value.type?await fe(a.value+"/"+e.value.editName):await async function(t){try{await n.post("/files?action=CreateFile",{path:t},{requestOptions:{loading:de("file.buttonGroup.loading.creatingFile"),successMessage:!0}})}catch(e){console.warn(e)}}(a.value+"/"+e.value.editName),await Ht(t),!0}catch(l){i.value.shift(),console.warn(l)}}async function oe(t){const{currentFile:e}=t;if(e.value&&e.value.isEditRemarks)return e.value.editRemarks!=e.value.rmk?(await async function(t){await n.post("/files?action=set_file_ps",t,{requestOptions:{successMessage:!0}})}({filename:e.value.path,ps_type:0,ps_body:e.value.editRemarks}),await Ht(t),!0):(e.value.isEditRemarks=!1,e.value.remarks_hover=!1,!1)}async function re(t){if(await oe(t))return;if(await le(t))return;await se(t)}async function ce(){return n.post("/task?action=get_task_lists",{status:-3})}async function ue(t){if(document.querySelector(".file-task-modal"))return;const{message:e}=await ce();o(e)&&e.length>0&&yt({title:Wt("file.tableController.realtimeTaskQueue"),width:510,class:"file-task-modal",unstableShowMask:!1,data:{store:t,taskList:e},component:F((()=>r((()=>import("./FileTask.js?v=1758532619827")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))))})}async function pe(t){return n.post("/task?action=remove_task",{id:t},{requestOptions:{loading:Wt("file.tableController.deletingTask"),successMessage:!0}})}const{t:de}=a.global;async function fe(t){try{await n.post("/files?action=CreateDir",{path:t},{requestOptions:{loading:de("file.buttonGroup.loading.creatingDirectory"),successMessage:!0}})}catch(e){console.warn(e)}}async function me(t,e){try{await n.post("/files?action=CreateLink",{sfile:t,dfile:e},{requestOptions:{loading:de("file.buttonGroup.loading.creatingSoftlink"),successMessage:!0}})}catch(a){console.warn(a)}}function ve(t){ra(t,"UploadFile",(t=>{t.value.open()}))}function he(t){ra(t,"RemoteDownload",(t=>{t.value.open()}))}function ye(t){ra(t,"SearchFileContent",(t=>{t.value.open()}))}const ge=t=>{ra(t,"FavoriteList",(t=>{t.value.open()}))};function _e(t,e){const{currentPath:a}=t;"management"==e?ge(t):(a.value=e,Ht(t))}function we(t){ra(t,"ShareList",(t=>{t.value.open()}))}function be(t){const{currentPath:e}=t;e.value="/",Ht(t)}function ke(t){ra(t,"Backup",(t=>{t.value.open()}))}function xe(t){ra(t,"Recycle",(t=>{t.value.open()}))}function Ce(t){ra(t,"Terminal",(t=>{t.value.open()}))}function Se(t,e,a,n){const{fileList:i,currentFile:l}=t,s={nm:e,isCreate:!0,type:a,ext:n,path:"",editName:e};l.value=s,l.value.editName=l.value.nm,i.value.unshift(l.value),P(Zt)}function Pe(t,e){switch(e){case"dir":Se(t,de("file.buttonGroup.defaultNames.untitledDirectory"),"dir","folder");break;case"file":Se(t,de("file.buttonGroup.defaultNames.untitledFile"),"file","unknown");break;case"softlink":ra(t,"Softlink",(t=>{t.value.open()}))}}function ze(t){const{optionToolsRef:e,isMiniScreen:a}=t;e.value.offsetWidth<1560?a.value=!0:a.value=!1}async function Re(t,e){try{await n.post("/files?action=del_files_store",{path:e},{requestOptions:{loading:de("file.buttonGroup.loading.deletingFavorite"),successMessage:!0}}),Ht(t)}catch(a){console.warn(a)}}const{t:Oe}=a.global,Fe=t=>{const{fileRecycle:e}=t;e.value?De(t):Le(t)},De=t=>{const{currentPath:e,choosedKeys:a,fileList:n}=t,i=n.value.filter((t=>a.value.includes(t.nm)));ht({title:1===i.length?Oe("file.deleteController.deleteSingleFileTitle",{name:i[0].nm}):Oe("file.deleteController.batchDeleteTitle"),content:Oe("file.deleteController.recycleBinMessage"),width:400,onConfirm:async()=>{1===i.length?await je(i[0].path,i[0].type):await Te(i.map((t=>t.nm)),e.value),Ht(t)}})},Le=t=>{const{currentPath:e,choosedKeys:a,fileList:n}=t,i=n.value.filter((t=>a.value.includes(t.nm)));gt({title:1===i.length?Oe("file.deleteController.deleteSingleFileTitle",{name:i[0].nm}):Oe("file.deleteController.batchDeleteTitle"),content:()=>R("span",{class:"text-error"},[Oe("file.deleteController.permanentDeleteMessage")]),width:400,onConfirm:async()=>{1===i.length?await je(i[0].path,i[0].type):await Te(i.map((t=>t.nm)),e.value),Ht(t)}})};async function je(t,e){await n.post("/files?action=".concat("dir"===e?"DeleteDir":"DeleteFile"),{path:t},{requestOptions:{loading:Oe("file.deleteController.deletingSingle"),successMessage:!0}})}async function Te(t,e){await n.post("/files?action=SetBatchData",{data:JSON.stringify(t),type:4,path:e},{requestOptions:{loading:Oe("file.deleteController.deletingBatch"),successMessage:!0}})}const{t:Me}=a.global;async function Ee(t,e){return(await n.post("/files?action=CheckExistsFiles",{dfile:t,filename:e},{requestOptions:{isOriginalResult:!0}})).message.length>0}async function Ie(t,e){return await n.post("/files?action=CopyFile",{sfile:t,dfile:e},{requestOptions:{loading:Me("file.contextMenu.loading.copying"),successMessage:!0}})}async function Ne(t,e){return await n.post("/files?action=BatchPaste",{type:t,path:e},{requestOptions:{loading:Me("file.contextMenu.loading.pasting"),successMessage:!0}})}async function Ve(t,e,a){return await n.post("/files?action=MvFile",{sfile:t,dfile:e,...a},{requestOptions:{loading:Me("file.contextMenu.loading.moving"),successMessage:!0}})}async function qe(t,e,a,i){try{await n.post("/files?action=Zip",{sfile:t,dfile:e,z_type:a,path:i},{requestOptions:{loading:Me("file.contextMenu.loading.compressing"),successMessage:!0}})}catch(l){console.warn(l)}}async function Ue(t){await n.post("/files?action=UnZip",t,{requestOptions:{loading:Me("file.contextMenu.loading.decompressing"),successMessage:!0}})}function Ae(t,e){return e.map((e=>t[e]))}function Ke(t){const{choosedKeys:e,currentPath:a,fileList:n}=t,i=n.value.find((t=>t.nm==e.value[0]));i&&It(0,i.path,a.value)}function Ge(t){const{choosedKeys:e,currentPath:a,fileList:n}=t,i=n.value.find((t=>t.nm==e.value[0]));a.value=i.path,Ht(t)}async function Be(t,e,a){const{choosedKeys:i,fileList:s,fileCopyCache:o,waitForPaste:r,copiedFile:c,currentPath:u}=t;if(1==i.value.length)l.success(e),o.value=JSON.parse(JSON.stringify(i.value)),c.value=oa(s.value,o.value)[0],r.value=!0;else try{const t=await async function(t,e,a){return await n.post("/files?action=SetBatchData",{data:JSON.stringify(t),type:e,path:a},{requestOptions:{loading:Me("file.contextMenu.loading.batchSetting"),successMessage:!0}})}(i.value,a,u.value);0==t.status&&(o.value=JSON.parse(JSON.stringify(i.value)),r.value=!0)}catch(p){console.warn(p)}}async function $e(t){const{fileOperationFlag:e,waitForPaste:a}=t;e.value=1,await Be(t,Me("file.contextMenu.messages.copySuccess"),1),a.value=!0}async function We(t){const{fileOperationFlag:e,waitForPaste:a}=t;e.value=2,await Be(t,Me("file.contextMenu.messages.cutSuccess"),2),a.value=!0}async function He(t){const{fileCopyCache:e,currentPath:a,waitForPaste:n}=t;if(!n.value)return;let i=!1;1==e.value.length?i=await Ee(a.value,e.value[0]):e.value.length>1&&(i=await Ee(a.value)),i?ra(t,"PasteConfirm",(t=>t.value.open())):async function(t){const{fileCopyCache:e,fileOperationFlag:a,currentPath:n,copiedFile:i,waitForPaste:l}=t;e.value.length>1?await Ne(a.value,n.value):1==e.value.length&&(1==a.value?await Ie(i.value.path,n.value+"/"+i.value.nm):2==a.value&&await Ve(i.value.path,n.value+"/"+i.value.nm)),Ht(t),l.value=!1}(t)}function Ye(t){ra(t,"Compression",(t=>t.value.open()))}function Je(t,e){const{menuShow:a}=e;switch(t){case"edit":Ke(e);break;case"copy":$e(e);break;case"cut":We(e);break;case"paste":He(e);break;case"permission":ra(e,"Permission",(t=>t.value.open()));break;case"compression":Ye(e);break;case"decompress":ra(e,"Decompress",(t=>t.value.open()));break;case"conversion":console.log("conversion");break;case"del":Fe(e);break;case"refresh":Ht(e);break;case"upload":ra(e,"UploadFile",(t=>t.value.open()));break;case"createFile":Se(e,Me("file.contextMenu.defaultNames.untitledFile"),"file","file");break;case"createDir":Se(e,Me("file.contextMenu.defaultNames.untitledDirectory"),"dir","folder");break;case"download":!async function(t){const{currentPath:e,choosedKeys:a}=t;c("".concat("/"===e.value?"":e.value,"/").concat(a.value[0]))}(e);break;case"terminal":ra(e,"Terminal",(t=>t.value.open()));break;case"open":Ge(e);break;case"share":ra(e,"Share",(t=>t.value.open()));break;case"unShare":!function(t){const{choosedKeys:e,fileList:a,shareList:n}=t,i=oa(a.value,e.value)[0],l=n.value.find((t=>t.filename.includes(i.nm)));Bt(t,null==l?void 0:l.id)}(e);break;case"favorite":!async function(t){const{choosedKeys:e,fileList:a}=t,i=a.value.find((t=>t.nm==e.value[0]));try{await n.post("/files?action=add_files_store",{path:i.path},{requestOptions:{loading:Me("file.contextMenu.loading.addingToFavorites"),successMessage:!0}}),Jt(t),Ht(t)}catch(l){console.warn(l)}}(e);break;case"unfavorite":!async function(t){const{choosedKeys:e,fileList:a}=t;Re(t,oa(a.value,e.value)[0].path)}(e);break;case"rename":!async function(t){const{choosedKeys:e,fileList:a,currentFile:n,filesView:i}=t,l=oa(a.value,e.value)[0];n.value=l,"card"===i.value?(n.value.isRenameForCard=!0,n.value.editName=n.value.nm):(l.isCreate=!0,l.isRename=!0,l.editName=l.nm,P(Zt))}(e);break;case"attrs":ra(e,"Properties",(t=>t.value.open()));break;case"preview":!function(t){const{choosedKeys:e,fileList:a}=t;ne(t,oa(a.value,e.value)[0].path)}(e);break;case"playVideo":!function(t){const{choosedKeys:e,fileList:a}=t;ie(t,oa(a.value,e.value)[0])}(e)}a.value=!1}function Xe(t){const{type:e,list:a,path:n}=t,i=[];for(const l of a)i.push(Ze({type:e,item:l,path:n}));return i}function Ze(t){const{type:e,item:a,path:n}=t,{nm:i,sz:l,is_link:s,lnk:o,mt:r,ctime:c,atime:u,gid:p,uid:d,group:f,user:m,acc:v,rmk:h,durl:y,cmp:g,fav:_,top:w,sn:b}=a,k=function(t,e){if("dir"===e)return"folder";const a=["tar.gz"],n=t.toLowerCase();for(const l of a)if(n.endsWith(l))return l;const i=n.lastIndexOf(".");if(-1!==i)return n.substring(i+1);return"file"}(a.nm,e);return{ext:k,nm:i,sz:l,mt:r,acc:v,user:m,is_link:s?o:"",lnk:o,durl:y,cmp:g,fav:_,rmk:h,top:w,sn:b,path:Qe(n,i),ctime:c,atime:u,gid:p,uid:d,group:f,type:e}}function Qe(t,e){return function(t){return t.replace(/\/\//g,"/")}("".concat(t,"/").concat(e))}function ta(t){return["folder"].includes(t)?"file-dir":["txt","rtf","md","log","conf"].includes(t)?"file-txt":["json"].includes(t)?"file-json":["htm","html","xhtml"].includes(t)?"file-html":["css","less","scss"].includes(t)?"file-css":["js","ts"].includes(t)?"file-js":["php"].includes(t)?"file-php":["doc","docx","docm","dot","dotx","dotm"].includes(t)?"file-doc":["pdf","pdfa","pdfx","pdfu"].includes(t)?"file-pdf":["xlsx","xlsm","xltx","xltm"].includes(t)?"file-excel":["jpg","jpeg","png","gif","bmp","webp","tiff","tif","psd","ai","eps","cr2","cr3","nef","nrw","dng","svg","cdr","wmf","emf","apng","heic","ico","xbm","xpm","xcf","iff","pnm"].includes(t)?"file-img":["py","java","js","ts","c","cpp","cs","php","rb","go","swift","kt","html","css","jsx","vue","scss","less","tsx","json","xml","yaml","yml","ini","properties","env","sql","pl","sh","bat","ps1","m","swift","kt","gradle","makefile","cmake","jar","war","exe","md","gitignore","dockerfile","yml","ipynb","asm","lua","rs","hs"].includes(t)?"file-sh":["zip","rar","7z","tar","tar.gz","gz","tgz","tar.bz2","tar.xz","cab","iso","msi","rpm","deb","xz","zipx","lz4","zst","rar5","part1.rar","rar.part1","z01","z02"].includes(t)?"file-compression":"file-unknown-file"}function ea(t){return["mp4","avi","mov","mkv","wmv","flv","3gp","3g2","vob","webm","ogv"].includes(t)}function aa(t){return"file-img"===ta(t.ext)}function na(t){return"file-compression"===ta(t)}async function ia(t,e,a){try{const{message:i}=await n.post("/files?action=GetDirNew",{path:t,is_operating:!0,...a});e&&e(i);let l=Xe({type:"dir",list:i.dir,path:t}),s=Xe({type:"file",list:i.files,path:t});return l=l.map(((t,e)=>({...t,protected:i.tamper_data.dirs&&i.tamper_data.dirs[e]?Number(i.tamper_data.dirs[e].split(";")[0]):0,protected_rule:i.tamper_data.dirs&&i.tamper_data.dirs[e]?Number(i.tamper_data.dirs[e].split(";")[1]):0}))),s=s.map(((t,e)=>({...t,protected:i.tamper_data.files&&i.tamper_data.files[e]?Number(i.tamper_data.files[e].split(";")[0]):0,protected_rule:i.tamper_data.files&&i.tamper_data.files[e]?Number(i.tamper_data.files[e].split(";")[1]):0}))),[...l,...s]}catch(i){return console.warn(i),[]}}async function la(t,e,a){try{const i={path:t,p:1,showRow:5e3,sort:"name",reverse:!1,search:e};a&&(i.all=!0);const{message:l}=await n.post("/files?action=GetDirNew&tojs=GetFiles",i);let s=Xe({type:"dir",list:l.dir,path:t}),o=Xe({type:"file",list:l.files,path:t});return s=s.map(((t,e)=>({...t,protected:l.tamper_data.dirs&&l.tamper_data.dirs[e]?Number(l.tamper_data.dirs[e].split(";")[0]):0,protected_rule:l.tamper_data.dirs&&l.tamper_data.dirs[e]?Number(l.tamper_data.dirs[e].split(";")[1]):0}))),o=o.map(((t,e)=>({...t,protected:l.tamper_data.files&&l.tamper_data.files[e]?Number(l.tamper_data.files[e].split(";")[0]):0,protected_rule:l.tamper_data.files&&l.tamper_data.files[e]?Number(l.tamper_data.files[e].split(";")[1]):0}))),[...s,...o]}catch(i){return console.warn(i),[]}}async function sa(t,e,a,i,l,s,o=!1,r){const c=[],u=Math.ceil(t.size/a);console.log("总切片数：",u);for(let n=0;n<u;n++){const e=n*a,l=Math.min(e+a,t.size),s=t.slice(e,l),o=new FormData;o.append("f_path",i),o.append("f_name",t.name),o.append("f_size","".concat(t.size)),o.append("f_start","".concat(e)),o.append("blob",s),c.push(o)}try{for(let t=0;t<c.length;t++){const a=await n.post(e,c[t],{headers:{"Content-Type":"multipart/form-data"},requestOptions:{isOriginalResult:!0}});"number"==typeof a.message&&s&&s(a);l(Math.round(t/c.length*100),a)}l(100,null)}catch(p){return Promise.reject({msg:p.message})}}function oa(t,e){return t.filter((t=>e.includes(t.nm)))}async function ra(t,e,a){const{dynamicCmptObj:n,dynamicCmpt:i,dynamicCmptRef:l}=t,s=n[e]();await s.__asyncLoader(),i.value=s,P((()=>{a&&a(l)}))}wt.create({baseURL:"/v2"});const ca=u(D({__name:"FileIcon",props:{ext:{type:String,default:""},size:{type:String,default:"medium"}},setup(t){const e=L((()=>na(t.ext)?"compress":"Dir"===t.ext?"folder":t.ext));return(a,n)=>(j(),T("div",{class:M(["files-icon",["".concat(E(e),"-icon"),"".concat(t.size,"-icon")]])},null,2))}}),[["__scopeId","data-v-51faac5f"]]),ua={class:"video-container"},pa=["src"],da={class:"video-list"},fa=["onClick"],ma=u(D({__name:"VideoPlayer",setup(t){const e=I("fileStore"),{videoWaitPreview:a,previewVideoShow:n,currentPreviewVideo:i}=e,l=k(),s=k(0),o=L((()=>"/download?filename=".concat(i.value.path)));function r(){s.value=l.value.offsetHeight}return(t,e)=>{const c=p,u=_t;return j(),N(u,{show:E(n),"onUpdate:show":e[0]||(e[0]=t=>x(n)?n.value=t:null),width:"70%",title:t.$t("file.videoPlayerModal.title"),onAfterEnter:r},{default:V((()=>[q("div",ua,[q("video",{src:E(o),controls:"true",preload:"auto",width:"100%",ref_key:"videoRef",ref:l},null,8,pa),q("div",da,[R(c,{style:G({height:E(s)+"px"})},{default:V((()=>[(j(!0),T(O,null,U(E(a),(t=>(j(),T("div",{class:M(["video-item",{active:t.path==E(i).path}]),key:t.path,onClick:e=>i.value=t},[R(ca,{ext:"mp4"}),R(E(xt),null,{default:V((()=>[A(K(t.name),1)])),_:2},1024)],10,fa)))),128))])),_:1},8,["style"])])])])),_:1},8,["show","title"])}}}),[["__scopeId","data-v-6be9ab69"]]),va=k([]),ha=k(!1),ya=k(null),ga=k(1),{t:_a}=a.global;const wa={class:"drag-upload"},ba={class:"upload-area"},ka={class:"tip"},xa=u(D({__name:"DragUpload",setup(t,{expose:e}){const{t:a}=W(),n=I("fileStore"),{uploadFileList:i,uploadShow:s,uploadComplete:o,startUpload:r}=n,c=k(!1),u=k(0);function p(t){const e=t.dataTransfer;return!!e&&e.types.some((t=>"Files"===t||"application/x-moz-file"===t))}function d(t){t.preventDefault(),p(t)&&(u.value++,c.value=!0)}function f(t){t.preventDefault(),p(t)&&(u.value--,u.value<=0&&(c.value=!1,u.value=0))}function m(t){t.preventDefault(),p(t)&&(t.dataTransfer.dropEffect="copy")}async function v(t){const e=[];for(let a=0;a<t.length;a++){const n=t[a].webkitGetAsEntry();n&&e.push(n)}await h(e)&&l.error(a("file.uploadModal.fileAlreadyExists"),{close:!0})}async function h(t,e=""){o.value&&(i.value=[],r.value=!1,o.value=!1);let a=!1;for(const n of t)if(n.isDirectory){const t=n.createReader(),i=await new Promise((e=>{t.readEntries(e)}));await h(i,e?"".concat(e,"/").concat(n.name):n.name)&&(a=!0)}else if(n.isFile){if(-1!=i.value.findIndex((t=>g("".concat(t.relativePath,"/").concat(t.file.name))==g(n.fullPath)))){a=!0;continue}const t=await new Promise((t=>{n.file(t)}));i.value.push({file:t,status:0,progress:0,relativePath:e?"".concat(e):""})}return a}async function y(t){var e;t.preventDefault(),p(t)&&(u.value=0,c.value=!1,(null==(e=t.dataTransfer)?void 0:e.items)&&(await v(t.dataTransfer.items),ra(n,"UploadFile"),s.value=!0))}function g(t){return t.startsWith("/")?t.slice(1):t}function _(){document.ondragenter=d,document.ondragleave=f,document.ondragover=m,document.ondrop=y}return ra(n,"UploadFile"),e({listenDragEvent:_}),H((()=>{_()})),(t,e)=>{const a=Ct;return j(),T("div",wa,[R(a,{show:E(c),"onUpdate:show":e[0]||(e[0]=t=>x(c)?c.value=t:null)},{default:V((()=>[q("div",ba,[q("span",ka,K(t.$t("file.uploadModal.dragFilesHere")),1)])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-90e8c7cf"]]),Ca={class:"img-wrapper"},Sa=["src"],Pa=u(D({__name:"ImagePreview",setup(t){const e=I("fileStore"),{imgWaitPreview:a,currentPreviewImg:n,previewShow:i}=e,l=k(.5),s=L((()=>"/download?filename=".concat(a.value[o.value]))),o=k(0);function r(){o.value=a.value.findIndex((t=>t===n.value))}function c(){o.value>0&&o.value--}function u(){o.value<a.value.length-1&&o.value++}function p(){l.value>2||(l.value+=.1)}function d(){l.value<.2||(l.value-=.1)}function f(){i.value=!1}function m(t){l.value-t.deltaY/1e3<.2||l.value-t.deltaY/1e3>2||(l.value-=t.deltaY/1e3)}return(t,e)=>{const a=Ct;return j(),N(a,{show:E(i),"onUpdate:show":e[0]||(e[0]=t=>x(i)?i.value=t:null),"close-on-esc":!1,"mask-closable":!1,"on-after-enter":r},{default:V((()=>[q("div",Ca,[q("img",{src:E(s),style:G({transform:"translate(-50%, -50%) scale(".concat(E(l),")")}),onWheel:m},null,44,Sa),q("div",{class:"tools"},[q("i",{class:"i-ic:outline-arrow-circle-left text-16 text-[#fff] cursor-pointer",onClick:c}),q("i",{class:"i-ic:baseline-zoom-in text-16 text-[#fff] cursor-pointer",onClick:p}),q("i",{class:"i-ic:baseline-zoom-out text-16 text-[#fff] cursor-pointer",onClick:d}),q("i",{class:"i-ic:outline-arrow-circle-right text-16 text-[#fff] cursor-pointer",onClick:u})]),q("i",{class:"i-iconoir:xmark-circle text-16 text-[#fff] cursor-pointer close-icon",onClick:f})])])),_:1},8,["show"])}}}),[["__scopeId","data-v-7045f818"]]),za={key:0,class:"group-left"},Ra={key:1,class:"group-left"},Oa={class:"group-right"},Fa={class:"view-change"},Da=u(D({__name:"ButtonGroup",props:{filesView:{type:String,default:"list"},filesViewModifiers:{}},emits:Y(["viewChange"],["update:filesView"]),setup(t,{emit:e}){const a=e,{t:n}=W(),i=I("fileStore"),{favoriteOptions:l,choosedKeys:o,waitForPaste:r,optionToolsRef:c,isMiniScreen:u}=i,p=J(t,"filesView"),f=L((()=>[{label:n("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>R(d,{name:"file-dir",size:"16"},null)},{label:n("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>R(d,{name:"base-file",size:"16"},null)},{label:n("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>R(d,{name:"file-soft-link",size:"15"},null)}])),m=L((()=>[{label:n("file.buttonGroup.miniScreenOptions.upload"),key:"Upload",icon:()=>R(d,{name:"file-upload",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.remoteDownload"),key:"Remote Download",icon:()=>R(d,{name:"file-download",size:"16"},null)},{label:n("file.buttonGroup.miniScreenOptions.new"),key:"create",icon:()=>R(d,{name:"base-dir",size:"14",class:"mr-5px"},null),children:[{label:n("file.buttonGroup.createOptions.newDirectory"),key:"dir",icon:()=>R(d,{name:"file-dir",size:"16"},null)},{label:n("file.buttonGroup.createOptions.newFile"),key:"file",icon:()=>R(d,{name:"base-file",size:"16"},null)},{label:n("file.buttonGroup.createOptions.softLink"),key:"softlink",icon:()=>R(d,{name:"file-soft-link",size:"15"},null)}]},{label:n("file.buttonGroup.miniScreenOptions.searchFileContent"),key:"Search File Content",icon:()=>R(d,{name:"search",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.favorite"),key:"Favorite",icon:()=>R(d,{name:"file-favorite",size:"14",class:"mr-5px"},null),children:h.value},{label:n("file.buttonGroup.miniScreenOptions.shareList"),key:"Share List",icon:()=>R(d,{name:"file-share",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.terminal"),key:"Terminal",icon:()=>R(d,{name:"file-terminal",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.rootDirectory"),key:"Root Directory",icon:()=>R(d,{name:"file-disk",size:"14"},null)},{label:n("file.buttonGroup.miniScreenOptions.fileProtection"),key:"File/Dir protection",icon:()=>R(d,{name:"file-protect",size:"14"},null)}]));function v(t,e){switch(t){case"Upload":ve(i);break;case"Remote Download":he(i);break;case"dir":Pe(i,"dir");break;case"file":Pe(i,"file");break;case"softlink":Pe(i,"softlink");break;case"Search File Content":ye(i);break;case"Share List":we(i);break;case"Terminal":Ce(i);break;case"Root Directory":be(i);break;case"File/Dir protection":y();break;default:!function(t){_e(i,t)}(t)}}const h=L((()=>l.value.map((t=>({key:t.key,icon:()=>{return R(d,{name:(e=t.icon,"dir"==e?"file-dir":"settings"==e?"flow-action":"file-record"),size:"16"},null);var e},label:()=>R("div",{class:"flex"},[R("div",{class:"max-w-300px"},[R(xt,null,{default:()=>[t.label]})])]),meta:{type:"favorite"}}))))),y=async()=>{const t=await bt("tamper_core",75);s(t)&&Tt(t)};function g(){ra(i,"Permission",(t=>t.value.open()))}function _(){Fe(i)}function w(t){!function(t,e){const{filesView:a}=t;a.value=e}(i,t),a("viewChange",t)}return X((()=>{ze(i),window.addEventListener("resize",(()=>ze(i)))})),(t,e)=>{const a=d,n=St,l=Pt,s=zt;return j(),T("div",{class:"button-group",ref_key:"optionToolsRef",ref:c},[!E(u)&&E(o).length<=1?(j(),T("div",za,[R(n,{onClick:e[0]||(e[0]=t=>E(ve)(E(i)))},{icon:V((()=>[R(a,{name:"file-upload",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.upload")),1)])),_:1}),R(n,{onClick:e[1]||(e[1]=t=>E(he)(E(i)))},{icon:V((()=>[R(a,{name:"file-download",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.remoteDownload")),1)])),_:1}),R(l,{trigger:"hover",options:E(f),placement:"bottom-start","on-select":t=>E(Pe)(E(i),t)},{default:V((()=>[R(n,{"icon-placement":"right",class:"btn-behavior"},{default:V((()=>[R(a,{name:"base-dir",size:"14",class:"mr-5px"}),A(" "+K(t.$t("file.create"))+" ",1),R(a,{name:"base-arrow-right",size:"14"})])),_:1})])),_:1},8,["options","on-select"]),R(n,{onClick:e[2]||(e[2]=t=>E(ye)(E(i)))},{icon:V((()=>[R(a,{name:"search",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.searchContent")),1)])),_:1}),R(l,{placement:"bottom-start",scrollable:!0,style:{maxHeight:"480px"},options:E(h),onSelect:e[4]||(e[4]=t=>E(_e)(E(i),t))},{default:V((()=>[R(n,{"icon-placement":"right",class:"btn-behavior",onClick:e[3]||(e[3]=t=>E(ge)(E(i)))},{default:V((()=>[R(a,{name:"file-favorite",size:"14",class:"mr-5px"}),A(" "+K(t.$t("file.favorite"))+" ",1),R(a,{name:"base-arrow-right",size:"14"})])),_:1})])),_:1},8,["options"]),R(n,{onClick:e[5]||(e[5]=t=>E(we)(E(i)))},{icon:V((()=>[R(a,{name:"file-share",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.shareList")),1)])),_:1}),R(n,{onClick:e[6]||(e[6]=t=>E(Ce)(E(i)))},{icon:V((()=>[R(a,{name:"file-terminal",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.terminal")),1)])),_:1}),e[16]||(e[16]=q("div",{class:"divider"},null,-1)),R(n,{onClick:e[7]||(e[7]=t=>E(be)(E(i)))},{icon:V((()=>[R(a,{name:"file-disk",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.rootDirectory")),1)])),_:1}),e[17]||(e[17]=q("div",{class:"divider"},null,-1)),R(n,{onClick:y},{icon:V((()=>[R(a,{name:"file-protect",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.protection")),1)])),_:1})])):E(u)||E(o).length>1?(j(),T("div",Ra,[R(l,{placement:"bottom-start",scrollable:!0,"menu-props":()=>({style:"max-height: 480px"}),options:E(m),"on-select":v},{default:V((()=>[R(n,{"icon-placement":"right",class:"btn-behavior"},{default:V((()=>[R(a,{name:"base-dir",size:"14",class:"mr-5px"}),A(" "+K(t.$t("file.buttonGroup.fileOperations"))+" ",1),R(a,{name:"base-arrow-right",size:"14"})])),_:1})])),_:1},8,["options"])])):Z("",!0),q("div",Oa,[E(o).length>1?(j(),N(s,{key:0},{default:V((()=>[R(n,{onClick:e[8]||(e[8]=t=>E($e)(E(i)))},{icon:V((()=>[R(a,{name:"common-copy",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.copy")),1)])),_:1}),R(n,{onClick:e[9]||(e[9]=t=>E(We)(E(i)))},{icon:V((()=>[R(a,{name:"file-cut",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.cut")),1)])),_:1}),R(n,{onClick:e[10]||(e[10]=t=>E(Ye)(E(i)))},{icon:V((()=>[R(a,{name:"file-compression",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.compress")),1)])),_:1}),R(n,{onClick:g},{icon:V((()=>[R(a,{name:"file-dir-permission",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.buttonGroup.permissions")),1)])),_:1}),R(n,{onClick:_},{icon:V((()=>[R(a,{name:"file-recycling-bin",size:"16"})])),default:V((()=>[A(" "+K(t.$t("file.delete")),1)])),_:1})])),_:1})):Z("",!0),E(r)?(j(),N(n,{key:1,onClick:e[11]||(e[11]=()=>E(He)(E(i)))},{icon:V((()=>[R(a,{name:"file-paste",size:"20"})])),default:V((()=>[A(" "+K(t.$t("file.paste")),1)])),_:1})):Z("",!0),R(n,{onClick:e[12]||(e[12]=t=>E(ke)(E(i)))},{default:V((()=>[A(K(t.$t("file.backup")),1)])),_:1}),R(n,{onClick:e[13]||(e[13]=t=>E(xe)(E(i)))},{icon:V((()=>[R(a,{name:"file-recycling-bin",size:"14"})])),default:V((()=>[A(" "+K(t.$t("file.recycleBin")),1)])),_:1}),q("div",Fa,[q("div",{class:M(["card",{active:"card"==p.value}]),onClick:e[14]||(e[14]=t=>w("card"))},[R(a,{name:"file-card-view",size:"14"})],2),q("div",{class:M(["list",{active:"list"==p.value}]),onClick:e[15]||(e[15]=t=>w("list"))},[R(a,{name:"file-list-view",size:"16"})],2)])])],512)}}}),[["__scopeId","data-v-062d5ea2"]]),La={class:"path-dir"},ja={class:"path-arrow reversal"},Ta={class:"path-dir"},Ma={class:"path-arrow"},Ea=["onClick"],Ia={class:"path-dir"},Na={class:"path-arrow"},Va=u(D({__name:"ChoosePath",props:{currentPath:{type:String,default:"/"}},emits:["pathChange"],setup(t,{expose:e,emit:a}){const i=t,l=a,{t:o}=W(),r=I("fileStore"),c=k(""),u=Q("pathListRef"),p=k(0),f=L((()=>i.currentPath.split("/").filter((t=>""!==t)).map(((t,e)=>({name:t,originalIndex:e}))))),m=L((()=>{if(!p.value||0===f.value.length)return f.value;let t=p.value-80;const e=[...f.value].reverse(),a=[];for(const n of e){const e=Math.min(8*n.name.length,150)+20+12;if(!(t>=e))break;a.unshift(n),t-=e}return a})),v=L((()=>m.value.length<f.value.length)),h=L((()=>{const t=f.value.length-m.value.length;return f.value.slice(0,t)})),y=L((()=>{const t=h.value.map((t=>({key:t.originalIndex,label:t.name,icon:()=>R(d,{name:"file-dir",size:"16"},null)})));return t.unshift({key:"/",label:o("file.rootDirectory"),icon:()=>R(d,{name:"file-dir",size:"16"},null)}),t})),g=t=>{F(t)},_=k(!0),w=Q("inputRef");let b=null;function C(){u.value&&(p.value=u.value.offsetWidth)}function S(t){_.value=t,_.value?(c.value="",P((()=>{C()}))):c.value=i.currentPath}X((()=>{u.value&&(C(),b=new ResizeObserver((()=>{C()})),b.observe(u.value))})),tt((()=>{b&&b.disconnect()}));const z=()=>{S(!1),P((()=>{var t;null==(t=w.value)||t.focus()}))};function F(t,e){const a=i.currentPath.split("/").filter((t=>""!==t));let n="";"number"==typeof t&&(a.splice(t+1),n="/"+a.join("/")),"/"==t&&(n="/"),l("pathChange",n),null==e||e.stopPropagation()}async function D(){var t;if(c.value==i.currentPath||""==c.value)null==(t=w.value)||t.blur(),S(!0);else if(Mt(c.value))try{const{message:t}=await n.post("/files?action=test_path",{path:c.value});if(s(t)&&t.exists)t.is_dir?l("pathChange",t.path):l("pathChange",function(t){let e=t.replace(/\/$/,"");const a=e.lastIndexOf("/");if(-1===a)return e.includes(".")?"/":"/"+e;if(e.substring(a+1).includes(".")){let t=e.substring(0,a);return t.startsWith("/")?t:"/"+t}return e.startsWith("/")?e:"/"+e}(t.path)),S(!0);else{let t=c.value;ht({title:o("file.pathNotExists"),content:o("file.pathNotExistsConfirm",{path:t}),onPublicClose:()=>S(!1),onConfirm:async()=>{await fe(t),l("pathChange",t)},onCancel(){var t;null==(t=w.value)||t.blur(),S(!0)}})}}catch(e){console.warn(e)}else S(!1)}function M(){const t=i.currentPath.split("/").filter((t=>""!==t));if(0!=t.length){t.pop();let e="/"+t.join("/");l("pathChange",e)}}function G(){Ht(r)}return e({handleEnterDown:D}),(t,e)=>{const a=St,n=Pt,i=xt,l=Rt,s=Ot;return j(),N(s,null,{default:V((()=>[R(a,{onClick:M},{default:V((()=>[R(d,{name:"file-back",size:"16"})])),_:1}),E(_)?(j(),T("div",{key:0,ref_key:"pathListRef",ref:u,class:"path-list",onClick:z},[R(n,{trigger:"click",placement:"bottom-start",options:E(y),onSelect:g},{default:V((()=>[et(q("div",{class:"path-item",onClick:e[0]||(e[0]=t=>t.stopPropagation())},[q("div",La,[R(d,{name:"file-dir",size:"16"})]),q("div",ja,[R(d,{name:"base-arrow-right"})])],512),[[at,E(v)]])])),_:1},8,["options"]),et(q("div",{class:"path-item",onClick:e[1]||(e[1]=t=>F("/",t))},[q("div",Ta,K(t.$t("file.rootDirectory")),1),q("div",Ma,[R(d,{name:"base-arrow-right"})])],512),[[at,!E(v)]]),(j(!0),T(O,null,U(E(m),((t,e)=>(j(),T("div",{class:"path-item",key:"".concat(t,"_").concat(e),onClick:e=>F(t.originalIndex,e)},[q("div",Ia,[R(i,{class:"max-w-150px!"},{default:V((()=>[A(K(t.name),1)])),_:2},1024)]),q("div",Na,[R(d,{name:"base-arrow-right"})])],8,Ea)))),128))],512)):(j(),N(l,{key:1,ref_key:"inputRef",ref:w,value:E(c),"onUpdate:value":e[2]||(e[2]=t=>x(c)?c.value=t:null),class:"flex-1",placeholder:" ",onFocus:e[3]||(e[3]=t=>S(!1)),onBlur:e[4]||(e[4]=t=>S(!0)),onKeydown:nt(D,["enter"])},null,8,["value"])),R(a,{onClick:G},{default:V((()=>[R(d,{name:"base-refresh",size:"16"})])),_:1})])),_:1})}}}),[["__scopeId","data-v-e33954c3"]]),qa={class:"filter-tools"},Ua=u(D({__name:"SearchTools",setup(t){const e=I("fileStore"),{currentPath:a}=e,n=k(""),i=k(void 0),{choosePathRef:l}=e;async function s(){const t={search:n.value};i.value&&(t.all="True"),Ht(e,t)}function o(t){a.value=t,Ht(e)}return(t,e)=>{const r=kt,c=Rt,u=d,p=St,f=Ot;return j(),T("div",qa,[R(Va,{class:"w-50%","current-path":E(a),onPathChange:o,ref_key:"choosePathRef",ref:l},null,8,["current-path"]),R(f,{class:"dir-search"},{default:V((()=>[R(c,{placeholder:t.$t("file.search"),status:"success",value:E(n),"onUpdate:value":e[1]||(e[1]=t=>x(n)?n.value=t:null),onKeyup:nt(s,["enter"])},{suffix:V((()=>[R(r,{checked:E(i),"onUpdate:checked":e[0]||(e[0]=t=>x(i)?i.value=t:null)},{default:V((()=>[A(K(t.$t("file.includeSubdir")),1)])),_:1},8,["checked"])])),_:1},8,["placeholder","value"]),R(p,{type:"primary",onClick:s},{icon:V((()=>[R(u,{name:"search",size:"16"})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-70ba294c"]]),Aa=D({__name:"ContextMenu",setup(t,{expose:e}){const{t:a}=W(),n=I("fileStore"),{waitForPaste:i}=n,l=k(!1),s=k("empty"),o=k(0),r=k(1),c=L((()=>{switch(s.value){case"single":return function(t,e){const{fileList:a,choosedKeys:n}=t,i=oa(a.value,n.value)[0];let l=["share","favorite","permission","copy","cut","rename","del","compression","attrs"];if(!i)return Ae(e.value,["refresh","upload","create","terminal"]);if("dir"==i.type?l.unshift("open"):l.unshift("edit","download"),aa(i)&&(l.unshift("preview"),l=l.filter((t=>"edit"!==t))),ea(i.ext)&&(l.unshift("playVideo"),l=l.filter((t=>"edit"!==t))),i.isFavorite){const t=l.findIndex((t=>"favorite"==t));l[t]="unfavorite"}if(i.isShare){const t=l.findIndex((t=>"share"==t));l[t]="unShare"}return na(i.ext)&&(l.unshift("decompress"),l=l.filter((t=>"edit"!==t))),Ae(e.value,l)}(n,p);case"multiple":return Ae(p.value,["copy","cut","permission","compression","del"]);default:return i.value?Ae(p.value,["refresh","upload","create","terminal","paste"]):Ae(p.value,["refresh","upload","create","terminal"])}}));function u(t){Je(t,n),l.value=!1}const p=k({edit:{label:a("Public.Btn.Edit"),key:"edit",icon:()=>R(d,{name:"common-copy",size:"14"},null)},copy:{label:a("Public.Btn.Copy"),key:"copy",icon:()=>R(d,{name:"common-copy",size:"14"},null)},cut:{label:a("file.fileOperation.cut"),key:"cut",icon:()=>R(d,{name:"file-cut",size:"16"},null)},permission:{label:a("file.fileOperation.permission"),key:"permission",icon:()=>R(d,{name:"file-dir-permission",size:"14"},null)},compression:{label:a("file.contextMenu.createCompression"),key:"compression",icon:()=>R(d,{name:"file-compression",size:"16"},null)},decompress:{label:a("file.fileOperation.decompress"),key:"decompress",icon:()=>R(d,{name:"file-compression",size:"16"},null)},conversion:{label:a("file.contextMenu.formatConversion"),key:"conversion",icon:()=>R(d,{name:"file-conversion",size:"16"},null)},del:{label:a("Public.Btn.Delete"),key:"del",icon:()=>R(d,{name:"file-recycling-bin",size:"16"},null)},refresh:{label:a("Public.Btn.Refresh"),key:"refresh",icon:()=>R(d,{name:"base-refresh",size:"14"},null)},upload:{label:a("Public.Btn.Upload"),key:"upload",icon:()=>R(d,{name:"file-upload",size:"16"},null)},create:{label:a("file.contextMenu.newFolderFile"),key:"create",icon:()=>R(d,{name:"base-dir",size:"14"},null),children:[{label:a("file.contextMenu.newFolder"),key:"createDir",icon:()=>R(d,{name:"base-dir",size:"14"},null)},{label:a("file.contextMenu.newFile"),key:"createFile",icon:()=>R(d,{name:"base-file",size:"14"},null)}]},download:{label:a("Public.Btn.Download"),key:"download",icon:()=>R(d,{name:"file-download",size:"16"},null)},terminal:{label:a("file.contextMenu.terminal"),key:"terminal",icon:()=>R(d,{name:"file-terminal",size:"16"},null)},paste:{label:a("file.contextMenu.paste"),key:"paste",icon:()=>R(d,{name:"file-paste",size:"16"},null)},open:{label:a("file.fileOperation.open"),key:"open",icon:()=>R(d,{name:"file-open",size:"16"},null)},share:{label:a("file.contextMenu.externalShare"),key:"share",icon:()=>R(d,{name:"file-share",size:"16"},null)},unShare:{label:a("file.contextMenu.cancelShare"),key:"unShare",icon:()=>R(d,{name:"file-share",size:"16"},null)},favorite:{label:a("file.contextMenu.addToFavorites"),key:"favorite",icon:()=>R(d,{name:"file-favorite",size:"14"},null)},unfavorite:{label:a("file.contextMenu.removeFromFavorites"),key:"unfavorite",icon:()=>R(d,{name:"file-favorite",size:"14"},null)},rename:{label:a("file.fileOperation.rename"),key:"rename",icon:()=>R(d,{name:"file-rename",size:"16"},null)},attrs:{label:a("file.contextMenu.properties"),key:"attrs",icon:()=>R(d,{name:"file-attrs",size:"16"},null)},"new-window":{label:a("file.contextMenu.openInNewWindow"),key:"new-window",icon:()=>R(d,{name:"file-new-window",size:"14"},null)},top:{label:a("file.contextMenu.pinToTop"),key:"top",icon:()=>R(d,{name:"file-top",size:"18"},null)},"file-sync":{label:a("file.contextMenu.fileSync"),key:"file-sync",icon:()=>R(d,{name:"common-copy",size:"16"},null)},scan:{label:a("file.contextMenu.malwareScan"),key:"scan",icon:()=>R(d,{name:"file-scan",size:"16"},null)},duplicate:{label:a("file.contextMenu.createCopy"),key:"duplicate",icon:()=>R(d,{name:"common-copy",size:"16"},null)},preview:{label:a("Public.Btn.Preview"),key:"preview",icon:()=>R(d,{name:"drag-preview",size:"14"},null)},playVideo:{label:"播放",key:"playVideo",icon:()=>R(d,{name:"file-play-video",size:"16"},null)}});function f(){l.value=!1}return e({filesOperation:function(t,e){t.preventDefault(),l.value=!1,s.value=e,P().then((()=>{l.value=!0,o.value=t.clientX,r.value=t.clientY}))}}),(t,e)=>{const a=Pt;return j(),N(a,{placement:"bottom-start",trigger:"manual",x:E(o),y:E(r),options:E(c),show:E(l),"on-clickoutside":f,onSelect:u},null,8,["x","y","options","show"])}}}),Ka={key:0,class:"operation-wrapper"},Ga={class:"mr-4px"},Ba={class:"mr-4px"},$a=u(D({__name:"FileOperation",props:{file:{}},setup(t){const e=t,a=k(),n=I("fileStore"),{isMiniScreen:i}=n,{t:l}=W(),s=k([{label:l("Public.Btn.Download"),value:"download",handle:()=>Je("download",n)},{label:l("Public.Btn.Copy"),value:"copy",handle:()=>Je("copy",n)},{label:l("file.fileOperation.cut"),value:"cut",handle:()=>Je("cut",n)},{label:l("file.fileOperation.rename"),value:"rename",handle:()=>Je("rename",n)},{label:l("file.fileOperation.PMSN"),value:"permission",handle:()=>Je("permission",n)},{label:l("file.fileOperation.compress"),value:"compress",handle:()=>Je("compression",n)},{label:l("Public.Btn.Delete"),value:"delete",handle:()=>Je("del",n)}]);L((()=>s.value.map((t=>({label:t.label,key:t.value,handle:t.handle})))));const o=L((()=>{if(aa(e.file))return[{label:l("Public.Btn.Preview"),value:"preview",handle:()=>ne(n,e.file.path)},...s.value];if("dir"===e.file.type){const t=[...s.value],e=t.findIndex((t=>"download"==t.value));return t.splice(e,1),[{label:l("file.fileOperation.open"),value:"open",handle:()=>Je("open",n)},...t]}if(t=e.file,["file-txt","file-json","file-html","file-css","file-js","file-php","file-doc","file-sh"].includes(ta(t.ext)))return[{label:l("Public.Btn.Edit"),value:"edit",handle:()=>Je("edit",n)},...s.value];var t;if(na(e.file.ext)){const t=[...s.value];return t.splice(-2,0,{label:l("file.fileOperation.decompress"),value:"decompress",handle:()=>Je("decompress",n)}),t}return s.value}));function r(t){!function(t,e){const{choosedKeys:n}=e;let i="empty";t.target.closest("tr")&&(i=n.value.length>1?"multiple":1==n.value.length?"single":"empty"),P((()=>a.value.filesOperation(t,i)))}(t,n)}return(t,e)=>{const n=St,l=d;return j(),T(O,null,[E(i)?(j(),N(n,{key:1,text:"","icon-placement":"right",onClick:r},{default:V((()=>[q("span",Ba,K(t.$t("Public.Table.Action")),1),R(l,{name:"down",size:"14"})])),_:1})):(j(),T("div",Ka,[(j(!0),T(O,null,U(E(o),(t=>(j(),N(n,{key:t.value,text:"",type:"primary",onClick:it(t.handle,["stop"])},{default:V((()=>[A(K(t.label),1)])),_:2},1032,["onClick"])))),128)),R(n,{text:"","icon-placement":"right",onClick:r},{default:V((()=>[q("span",Ga,K(t.$t("Public.Btn.More")),1),R(l,{name:"down",size:"14"})])),_:1})])),R(Aa,{ref_key:"fileOperationContextRef",ref:a},null,512)],64)}}}),[["__scopeId","data-v-8101ae96"]]),Wa={key:1,class:"i-svg-spinners:90-ring-with-bg text-[#36ad6a] text-7"},Ha=D({__name:"CalcSize",props:{path:{}},setup(t){const{t:e}=W(),a=t,i=k(-1),l=k(!1);async function s(){-1==i.value&&(l.value=!0,i.value=await async function(t){try{return(await n.post("/files?action=GetDirSize",{path:t},{requestOptions:{isOriginalResult:!0}})).message}catch(e){return console.warn(e),"计算失败"}}(a.path),l.value=!1)}return(t,a)=>{const n=St;return E(l)?(j(),T("i",Wa)):(j(),N(n,{key:0,text:"",type:"primary",onClick:s},{default:V((()=>[A(K(-1!==E(i)?E(i):E(e)("file.tableFooter.calculate")),1)])),_:1}))}}});const Ya=u(D({__name:"FileTable",setup(t){function e(t){}const a=I("fileStore"),{sort:n,reverse:i,tableRef:l,fileList:s,choosedKeys:o,tableLoading:r,contextRef:c,currentFile:u,dataTableRef:p}=a,h=k({}),y=t=>t.nm,g=t=>({"data-key":t.nm,onContextmenu(t){t.preventDefault(),Xt(t,a)},onDblclick(){!function(t,e){const{currentPath:a}=t;"dir"==e.type?(a.value="/"==a.value?"/".concat(e.nm):a.value+"/"+e.nm,Ht(t)):aa(e)?ne(t,e.path):na(e.ext)?ra(t,"Decompress",(t=>t.value.open())):ea(e.ext)?ie(t,e):It(0,e.path,a.value)}(a,t)},onMouseenter(){t.operation_show=!0},onMouseleave(){t.operation_show=!1}}),_=(t,e)=>o.value.includes(t.nm)?"active-row normal-tr-".concat(t.nm):"normal-tr-".concat(t.nm),{t:w}=W(),b=k([{type:"selection",width:40,className:"file-checkbox",cellProps:()=>({style:{cursor:"pointer"}})},{title:()=>w("file.fileName"),key:"name",width:"22%",minWidth:164,sorter:!0,sortOrder:!1,render:t=>t.isCreate?R("div",{class:"flex justify-between items-center gap-2.5 w-100%"},[R("div",{class:"flex justify-start items-center"},[R(ca,{ext:t.ext},null),R(Rt,{"input-props":{autocomplete:"on",name:"filename"},value:t.editName,"onUpdate:value":e=>t.editName=e,autofocus:!0,id:"createInput",onKeydown:t=>{"Enter"===t.key&&(t.preventDefault(),re(a))},onBlur:()=>{re(a)}},null)])]):R("div",{class:"flex cursor-pointer",onClick:()=>Qt(a,t)},[R("div",{class:"flex-1 flex items-center w-0 gap-4px"},[R("div",{class:"flex-1 w-0 flex items-center"},[R("div",{class:"flex items-center"},[R(ca,{ext:t.ext},null)]),R("div",{class:"min-w-0"},[R(xt,null,{default:()=>[R("span",{class:"hover:text-primary cursor-pointer"},[t.lnk?t.nm+t.lnk:t.nm])]})])]),R("div",{class:"flex items-center gap-4px"},[t.isShare?R(d,{name:"file-share",size:"16"},null):null,t.isFavorite?R(d,{name:"file-favorite",size:"16"},null):null])])])},{title:()=>w("file.protected"),key:"protection",width:"8%",minWidth:114,render:t=>R("div",{class:"flex justify-start gap-4px items-center cursor-pointer",onClick:()=>te(a,t)},[R("span",{class:1===t.protected?"text-primary":""},[1==t.protected?w("file.protectedStatus"):w("file.unprotectedStatus")]),R(d,{size:"14",name:1==t.protected?"file-lock":"file-unlock",class:1===t.protected?"text-primary":"text-weak"},null)])},{title:"PMSN/Owner",key:"accept",width:"8%",minWidth:108,sorter:!0,sortOrder:!1,render:t=>"".concat(t.acc," / ").concat(t.user)},{title:()=>w("file.size"),key:"size",width:"7%",minWidth:90,sorter:!0,sortOrder:!1,render(t){if("dir"===t.type)return R(Ha,{path:t.path},null);{let a;return R(St,{type:"primary",text:!0},"function"==typeof(e=a=f(t.sz))||"[object Object]"===Object.prototype.toString.call(e)&&!st(e)?a:{default:()=>[a]})}var e}},{title:()=>w("file.modifyTime"),key:"mtime",width:"10%",minWidth:140,sorter:!0,sortOrder:!1,render:t=>m(t.mt)},{title:()=>w("file.remarks"),key:"rmk",minWidth:164,render:t=>R("div",{class:"min-w-134px min-h-26px",onMouseenter:()=>{return(e=t).remarks_hover=!0,void(e.editRemarks=e.rmk);var e},onMouseleave:()=>{var e;(e=t).isEditRemarks||(e.remarks_hover=!1)}},[t.remarks_hover?R(Rt,{value:t.editRemarks,"onUpdate:value":e=>t.editRemarks=e,size:"small",onClick:e=>{e.preventDefault(),t.isEditRemarks=!0,h.value=t,u.value=t,u.value.editRemarks=t.rmk,u.value.isEditRemarks=!0},onBlur:()=>{re(a)},onKeydown:t=>{"Enter"===t.key&&(t.preventDefault(),re(a))}},null):R("span",{title:t.rmk},[t.rmk])])},{title:()=>w("file.operation"),key:"operation",width:"22%",maxWidth:340,align:"right",render(t){if(t.operation_show||o.value.includes(t.nm))return R($a,{file:t},null)}}]),x=t=>{b.value.forEach((e=>{const a=e;a.key===t.columnKey?a.sortOrder=t.order:a.sortOrder=!1})),v(t.order)?(i.value="ascend"===t.order?"False":"True",n.value="".concat(t.columnKey)):(n.value="",i.value="False"),Ht(a)};function C(t,e){o.value=t}return lt(o,(()=>ze(a))),X((()=>{Yt(a),l.value.oncontextmenu=t=>{t.preventDefault(),t.target.closest("tr")||(o.value.length,c.value.filesOperation(t))}})),(t,a)=>{const n=Ft;return j(),T(O,null,[q("div",{ref_key:"tableRef",ref:l,class:"h-full relative"},[R(n,{class:"h-full",ref_key:"dataTableRef",ref:p,"flex-height":"",columns:E(b),"row-key":y,data:E(s),"row-class-name":_,"on-update:checked-row-keys":C,"row-props":g,"checked-row-keys":E(o),loading:E(r),"scrollbar-props":{trigger:"none"},"onUpdate:sorter":x,"on-scroll":e},null,8,["columns","data","checked-row-keys","loading"])],512),R(Aa,{ref_key:"contextRef",ref:c},null,512)],64)}}}),[["__scopeId","data-v-2f7fd2d3"]]),Ja={class:"h-full overflow-auto"},Xa=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu","onDblclick"],Za={class:"single-line-ellipsis"},Qa=["onMouseenter","onMouseleave","onClick","data-key","onContextmenu"],tn=u(D({__name:"CardList",setup(t){const e=I("fileStore"),{normalCardList:a,cardRectArr:n,fileList:i,choosedKeys:l,tableLoading:s,currentFile:o}=e,r=k(),c=k(),u=k();lt(o,(t=>{(null==t?void 0:t.isCreate)&&P((()=>{const t=c.value.querySelector("input");t&&(t.focus(),t.select())}))}));const p=L((()=>i.value.map((t=>(l.value.includes(t.nm)?t.card_choosed=!0:t.card_choosed=!1,t)))));async function d(t){t.isRenameForCard||(l.value=[t.nm],"dir"===t.type&&await Ge(e))}function f(t){const e=[];for(let a=0;a<n.value.length;a++){const[[i,l]]=Object.entries(n.value[a]);qt(t,l.getClientRects()[0])&&e.push(i)}l.value=e}function m(t,i){!function(){a.value=document.querySelectorAll(".file-item");const t=[];for(let e=0;e<a.value.length;e++){const n=a.value[e].dataset.key;t.push({[n]:a.value[e]})}n.value=t}(),"INPUT"==t.target.nodeName?i.m_flag.value=!1:(i.m_flag.value=!0,re(e))}function v(t){if(t.target.closest("div.file-item")){const e=t.target.closest("div.file-item").dataset.key;if(l.value.includes(e))return;l.value=[e]}else l.value=[]}function y(t,e){l.value.length>1?r.value.filesOperation(t,"multiple"):(1==l.value.length||(l.value=[e.nm]),r.value.filesOperation(t,"single"))}return X((()=>{u.value=Vt(c,f,m),c.value.oncontextmenu=t=>{t.preventDefault(),t.target.closest("div.file-item")||(l.value.length,r.value.filesOperation(t))}})),ot((()=>{c.value.oncontextmenu=null})),(t,a)=>{const n=Dt,i=Rt,o=h;return j(),T("div",Ja,[R(o,{show:E(s),class:"h-full"},{default:V((()=>[q("div",{class:"card-list",ref_key:"cardListRef",ref:c,onContextmenu:v},[(j(!0),T(O,null,U(E(p),(t=>(j(),T(O,{key:t.nm},[t.isRenameForCard||t.isCreate?t.isRenameForCard||t.isCreate?(j(),T("div",{key:1,class:M(["file-item",{active:t.card_hover||t.card_choosed}]),onMouseenter:e=>E(Ut)(t),onMouseleave:e=>E(At)(t),onClick:e=>d(t),"data-key":t.nm,onContextmenu:e=>y(e,t)},[R(ca,{ext:t.ext,size:"large"},null,8,["ext"]),R(i,{value:t.editName,"onUpdate:value":e=>t.editName=e,size:"small",autofocus:"",autoselect:"",onClick:it((()=>!1),["stop"]),onKeydown:a[0]||(a[0]=nt((()=>E(re)(E(e))),["enter"]))},null,8,["value","onUpdate:value"])],42,Qa)):Z("",!0):(j(),N(n,{key:0,trigger:"hover",placement:"bottom"},{trigger:V((()=>[q("div",{class:M(["file-item",{active:t.card_hover||t.card_choosed}]),onMouseenter:e=>E(Ut)(t),onMouseleave:e=>E(At)(t),onClick:e=>d(t),"data-key":t.nm,onContextmenu:e=>y(e,t),onDblclick:a=>function(t){t.isRenameForCard||"dir"!==t.type&&(l.value=[t.nm],Ke(e))}(t)},[R(ca,{ext:t.ext,size:"large"},null,8,["ext"]),q("span",Za,K(t.nm),1)],42,Xa)])),default:V((()=>[A(" "+K(t.nm),1)])),_:2},1024))],64)))),128))],544)])),_:1},8,["show"]),R(Aa,{ref_key:"contextRef",ref:r},null,512)])}}}),[["__scopeId","data-v-ae5d241c"]]),en={class:"flex items-center justify-between"},an={class:"flex justify-start items-center whitespace-pre"},nn={key:1,class:"i-svg-spinners:90-ring-with-bg text-7 text-primary"},ln=D({__name:"FileTableFooter",setup(t){const{t:e}=W(),a=I("fileStore"),{dirNums:i,fileNums:l,page:s,size:o,total:r,currentPath:c,currentDirSize:u}=a,p=k(!1),d=[100,500,1e3,1500,2e3];async function f(){try{p.value=!0;const t=await n.post("/files?action=GetDirSize",{path:c.value},{requestOptions:{isOriginalResult:!0}});u.value=t.message}catch(t){console.warn(t)}finally{p.value=!1}}return(t,n)=>{const c=St,m=Et;return j(),T("div",en,[q("div",an,[A(K(E(e)("file.tableFooter.summary",{dirNum:E(i),fileNum:E(l)}))+" ",1),E(p)?(j(),T("i",nn)):(j(),T(O,{key:0},[-1===E(u)?(j(),N(c,{key:0,type:"primary",text:"",onClick:f},{default:V((()=>[A(K(E(e)("file.tableFooter.calculate")),1)])),_:1})):(j(),N(c,{key:1,text:"",type:"primary"},{default:V((()=>[A(K(E(u)),1)])),_:1}))],64))]),R(m,{page:E(s),"onUpdate:page":n[0]||(n[0]=t=>x(s)?s.value=t:null),"page-size":E(o),"onUpdate:pageSize":n[1]||(n[1]=t=>x(o)?o.value=t:null),"item-count":E(r),"page-sizes":d,onRefresh:n[2]||(n[2]=()=>E(Ht)(E(a)))},null,8,["page","page-size","item-count"])])}}}),sn={class:"flex flex-col gap-16px h-full p-16px overflow-hidden"},on=D({__name:"main",props:{path:{default:"/"},view:{default:"list"}},emits:["currentPathChange","viewChange","rendered"],setup(t,{emit:e}){const a=t,n=k(),i=function(){const t=k(),e=k("list"),a=k("/www"),n=k([]),i=k(!1),l=k([]),s=k([]),o=k([]),c=k(),u=k(),p=k(),d=k([]),f=k([]),m=k({url:"http://",path:a.value,filename:""}),v=k({reference:"",per:0,speed:"0",used:"0",except:"--",total:0}),h=k(!1),y=k([]),g=k({text:"",exts:"html,php",path:a.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}),_=k({}),w=k({files:0,times:0}),b=k([]),x=k([{label:_a("file.favoriteListModal.management"),key:"management",icon:"settings"}]),C=k([]),S=k([]),P=k({back_sub_dir:1,path:"",remark:""}),z=ga,R=va,O=ha,D=ya,j={PasteConfirm:()=>F((()=>r((()=>import("./PasteConfirm.js?v=1758532619827")),__vite__mapDeps([16,9,2,3,5,6,1,4,8,7,10,17,18,11,12,13,14,19])))),UploadFile:()=>F((()=>r((()=>import("./UploadFile.js?v=1758532619827")),__vite__mapDeps([20,9,2,3,5,6,1,4,8,7,10,11,12,13,14,21])))),RemoteDownload:()=>F((()=>r((()=>import("./RemoteDownload.js?v=1758532619827")),__vite__mapDeps([22,9,2,3,5,6,1,4,8,7,10,23,11,12,13,14])))),SearchFileContent:()=>F((()=>r((()=>import("./SearchFileContent.js?v=1758532619827")),__vite__mapDeps([24,9,2,3,5,6,1,4,8,7,10,25,26,11,12,13,14,27])))),FavoriteList:()=>F((()=>r((()=>import("./FavoriteList.js?v=1758532619827")),__vite__mapDeps([28,9,2,3,5,6,1,4,8,7,10,11,12,13,14])))),ShareList:()=>F((()=>r((()=>import("./ShareList.js?v=1758532619827")),__vite__mapDeps([29,9,2,3,5,6,1,4,8,7,10,30,23,11,12,13,14])))),Backup:()=>F((()=>r((()=>import("./Backup.js?v=1758532619827")),__vite__mapDeps([31,9,2,3,5,6,1,4,8,7,10,25,26,11,12,13,14])))),Recycle:()=>F((()=>r((()=>import("./Recycle.js?v=1758532619827")),__vite__mapDeps([32,9,2,3,5,6,1,4,8,7,10,33,34,35,11,12,13,14,36])))),Terminal:()=>F((()=>r((()=>import("./Terminal.js?v=1758532619827")),__vite__mapDeps([37,9,2,3,5,6,1,4,8,7,10,38,39,40,41,42])))),Softlink:()=>F((()=>r((()=>import("./SoftLink.js?v=1758532619827")),__vite__mapDeps([43,9,2,3,5,6,1,4,8,7,10,23,25,26,11,12,13,14])))),Share:()=>F((()=>r((()=>import("./Share.js?v=1758532619827")),__vite__mapDeps([44,9,2,3,5,6,1,4,8,7,10,23,45,30,11,12,13,14])))),Permission:()=>F((()=>r((()=>import("./Permission.js?v=1758532619827")),__vite__mapDeps([46,9,2,3,5,6,1,4,8,7,10,11,12,13,14,47])))),Properties:()=>F((()=>r((()=>import("./Properties.js?v=1758532619827")),__vite__mapDeps([48,9,2,3,5,6,1,4,8,7,10,49,50,11,12,13,14,51])))),Del:()=>F((()=>r((()=>import("./Del.js?v=1758532619827")),__vite__mapDeps([52,17,1,2,3,4,5,6,7,8,18,9,10,11,12,13,14,53])))),Compression:()=>F((()=>r((()=>import("./Compression.js?v=1758532619827")),__vite__mapDeps([54,9,2,3,5,6,1,4,8,7,10,23,25,26,11,12,13,14])))),Decompress:()=>F((()=>r((()=>import("./Decompress.js?v=1758532619827")),__vite__mapDeps([55,9,2,3,5,6,1,4,8,7,10,23,11,12,13,14])))),AceEditor:()=>F((()=>r((()=>import("./index184.js?v=1758532619827")),__vite__mapDeps([56,1,2,3,4,5,6,7,8,57,9,10,11,12,13,14,58]))))},T=B(null),M=k(),E=k(!1),I=k(!1),N=k([]),V=k(!1),q=k(!1),U=k(!1),A=k(!1),K=k(),G=k(!1),$=L((()=>n.value.filter((t=>aa(t))).map((t=>t.path)))),W=L((()=>n.value.filter((t=>ea(t.ext))).map((t=>({path:t.path,name:t.nm}))))),H=k(""),Y=k({path:"",name:""}),J=k(!1),X=k(!1),Z=k(1),Q=k(0),tt=k(0),et=k(1),at=k(100),nt=k(""),it=k("False"),lt=k(0),st=k(null),ot=k(),rt=k([]),ct=k(1),ut=k(0),pt=k(-1),dt=k();return{mainRef:t,filesView:e,currentPath:a,fileList:n,tableLoading:i,normalTrList:l,trRectArr:s,choosedKeys:o,tableRef:c,dataTableRef:u,contextRef:p,normalCardList:d,cardRectArr:f,downloadFileFormData:m,downloadProgressData:v,downloadProgressShow:h,resourceManagerWindow:y,searchFileContentFormData:g,resetSearchFileContentFormData:function(){g.value={text:"",exts:"html,php",path:a.value,is_subdir:0,mode:0,isword:0,iscase:1,noword:0}},searchRes:_,searchStatistics:w,favoriteList:b,favoriteOptions:x,resetFavoriteOptions:function(){x.value=[{label:_a("file.favoriteListModal.management"),key:"management",icon:"settings"}]},shareList:C,backupList:S,backupForm:P,fileOperationFlag:z,fileCopyCache:R,waitForPaste:O,copiedFile:D,dynamicCmptObj:j,dynamicCmpt:T,dynamicCmptRef:M,fileRecycle:E,menuShow:I,uploadFileList:N,uploadShow:V,uploadComplete:q,startUpload:U,fileConflictShow:A,optionToolsRef:K,isMiniScreen:G,imgWaitPreview:$,videoWaitPreview:W,currentPreviewImg:H,currentPreviewVideo:Y,previewShow:J,previewVideoShow:X,operationType:Z,dirNums:Q,fileNums:tt,page:et,size:at,sort:nt,reverse:it,total:lt,currentFile:st,choosePathRef:ot,diskMountPoint:rt,shareListPage:ct,shareListTotal:ut,currentDirSize:pt,dragUploadRef:dt}}(),l=rt();ct("fileStore",i);const{dynamicCmpt:s,dynamicCmptRef:o,currentPath:c,filesView:u,choosedKeys:p,mainRef:d,copiedFile:f,currentFile:m,dragUploadRef:v}=i;c.value=a.path,u.value=a.view;const h=e;function g(t){h("viewChange",{view:t,currentPath:c.value})}return lt(c,(t=>{sessionStorage.setItem("currentPath",t),h("currentPathChange",t)})),H((()=>{Ht(i),document.onkeydown=async t=>{var e,a,n;if("/files"!=l.path)return;if((null==(e=m.value)?void 0:e.isCreate)||(null==(a=m.value)?void 0:a.isEditRemarks)||(null==(n=m.value)?void 0:n.isRename))return;if(!document.querySelector(".aceEditors")){if(t.ctrlKey&&"c"===t.key){if(0==p.value.length)return;await $e(i)}if(t.ctrlKey&&"v"===t.key&&He(i),t.ctrlKey&&"x"===t.key){if(0==p.value.length)return;We(i)}}}})),ut((()=>{Ht(i)})),ue(i),X((()=>h("rendered",c.value))),(t,e)=>{const a=y;return j(),T("div",{ref_key:"mainRef",ref:d,class:"flex-1 overflow-hidden"},[q("div",sn,[q("div",null,[R(Ua)]),R(a),q("div",null,[R(Da,{"files-view":E(u),"onUpdate:filesView":e[0]||(e[0]=t=>x(u)?u.value=t:null),onViewChange:g},null,8,["files-view"])]),q("div",{ref_key:"listRef",ref:n,class:"flex-1 overflow-hidden",tabindex:"0"},["list"==E(u)?(j(),N(Ya,{key:0})):"card"==E(u)?(j(),N(tn,{key:1})):Z("",!0)],512),R(ln)]),(j(),N(pt(E(s)),{ref_key:"dynamicCmptRef",ref:o},null,512)),R(xa,{ref_key:"dragUploadRef",ref:v},null,512),R(Pa),R(ma)],512)}}}),rn={class:"tabs"},cn=["onClick"],un={class:"flex justify-start gap-5"},pn={class:"tab-tit"},dn={class:"tab-tit"},fn=u(D({__name:"index",setup(t){const e=k(null),{mainHeight:a}=dt(g()),n=L((()=>a.value-16-16)),i=k(),s=k(),o=k(),r=k(!1),c={id:"tab-0",title:"wwwroot",path:"/www/wwwroot",view:"list"},u=ft("file-tabs",[Lt(c)]),p=ft("file-tabs-active","tab-0"),f=ft("file-tabs-view","list");lt(p,(t=>{const e=u.value.find((e=>e.id==t));e&&(f.value=e.view)}),{immediate:!0});const m=L((()=>{const t=u.value.find((t=>t.id==p.value));return t?t.path:"tab-0"}));function v(){if(u.value.length>=14)return void l.warning("Only 14 tags can be opened at most");const t="tab-".concat((new Date).getTime()),e=Lt(c);e.id=t,u.value.push(e),p.value=t}function h(t){const e=t.split("/").slice(-1)[0];u.value.forEach((a=>{a.id==p.value&&(a.path=t,a.title=""==e?"/":e)}))}function y({view:t,path:e}){f.value=t,u.value.forEach((a=>{a.id==p.value&&(a.path=e,a.view=t)}))}function x(t){"left"==t?o.value.scrollLeft-=100:"right"==t&&(o.value.scrollLeft+=100)}return X((()=>{o.value.addEventListener("mousewheel",(t=>{t.preventDefault(),o.value.scrollLeft+=t.deltaY}))})),function(){const t=w("Path");if(t){const e="tab-".concat((new Date).getTime());u.value.push({id:e,title:t,path:t,view:"list"});const a=u.value.find((e=>e.path==t));a&&(p.value=a.id)}b("Path")}(),X((async()=>{await _("/static/ace/styles/icons.css?v=1758532619827",e.value),Nt()})),(t,a)=>{const l=d,c=Dt,g=jt;return j(),T("div",{ref_key:"fileRef",ref:e,id:"file-main",class:"p-16px"},[R(g,{style:G({height:E(n)+"px"}),"content-style":{display:"flex",flexDirection:"column",overflow:"hidden"}},{default:V((()=>[q("div",rn,[q("div",{class:M(["tabs-scroll",{"has-scroll":E(r)}]),ref_key:"tabScrollRef",ref:i},[E(r)?(j(),T("div",{key:0,class:"left",onClick:a[0]||(a[0]=t=>x("left"))},a[2]||(a[2]=[q("i",{class:"i-tdesign:caret-left text-7"},null,-1)]))):Z("",!0),E(r)?(j(),T("div",{key:1,class:"right",onClick:a[1]||(a[1]=t=>x("right"))},a[3]||(a[3]=[q("i",{class:"i-tdesign:caret-right text-7"},null,-1)]))):Z("",!0),q("div",{class:"scroll-container",ref_key:"tabScrollContainerRef",ref:o},[q("div",{class:"tabs-wrapper",ref_key:"tabWrapperRef",ref:s},[(j(!0),T(O,null,U(E(u),(t=>(j(),N(c,{placement:"bottom",key:t.id},{trigger:V((()=>[q("div",{class:M(["tab-item",{active:t.id==E(p)}]),onClick:e=>{return a=t.id,void(p.value=a);var a}},[q("div",un,[R(l,{name:"file-dir",size:"18"}),q("span",pn,K(t.title),1)]),t.id==E(p)&&E(u).length>1?(j(),N(l,{key:0,name:"base-error",size:"18",color:"#bbb",onClick:e=>function(t){if(1==u.value.length)return void(p.value=u.value[0].id);const e=u.value.findIndex((e=>e.id==t));u.value.splice(e,1),setTimeout((()=>p.value=u.value[u.value.length-1].id),50)}(t.id)},null,8,["onClick"])):Z("",!0)],10,cn)])),default:V((()=>[q("span",dn,K(t.title),1)])),_:2},1024)))),128)),q("div",{class:"tab-item add",onClick:v},[R(l,{name:"base-add",size:"18",color:"#ccc"})])],512)],512)],2)]),(j(),N(mt,null,[(j(),N(pt(on),{key:E(p),onCurrentPathChange:h,path:E(m),view:E(f),onViewChange:y},null,40,["path","view"]))],1024))])),_:1},8,["style"])],512)}}}),[["__scopeId","data-v-eaf83717"]]),mn=Object.freeze(Object.defineProperty({__proto__:null,default:fn},Symbol.toStringTag,{value:"Module"}));export{Ne as B,Va as C,ca as F,ue as a,ta as b,Ie as c,Re as d,Bt as e,oa as f,Ht as g,Gt as h,me as i,qe as j,Ue as k,ce as l,pe as m,mn as n,It as o,ia as r,la as s,sa as u};
