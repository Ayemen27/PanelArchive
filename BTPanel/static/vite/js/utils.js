import{c as e,r as a}from"./public.js?v=1758532619827";import{t as s,i as t,c as i,n as l,_ as n}from"./page_layout.js?v=1758532619827";import{a as o}from"./soft.js?v=1758532619827";import{Z as r,r as u,a0 as c,X as _,j as p,F as d}from"./vue.js?v=1758532619827";import{d8 as m,dX as g}from"./naive.js?v=1758532619827";const k=()=>s.post("/mod/backup_restore/com/get_backup_list"),f=e=>s.post("/mod/backup_restore/com/add_backup",e,{requestOptions:{loading:t.global.t("Component.Pay.index_12"),successMessage:!0}}),b=e=>s.post("/mod/backup_restore/com/get_progress",e),y=e=>s.post("/mod/backup_restore/com/task_stop",e,{requestOptions:{loading:t.global.t("Component.Pay.index_12"),successMessage:!0}}),x=e=>s.post("/mod/backup_restore/com/exec_backup",e,{requestOptions:{loading:t.global.t("Component.Pay.index_12"),successMessage:!0}}),C=(e,a=!0)=>s.post("/mod/backup_restore/com/del_backup",e,{requestOptions:{loading:a?t.global.t("Component.Pay.index_12"):"",successMessage:a}}),B=e=>s.post("/mod/backup_restore/com/get_details",e),v=e=>s.post("/mod/backup_restore/com/get_exec_logs",e),w=e=>s.post("/mod/backup_restore/com/add_restore",e,{requestOptions:{loading:t.global.t("Component.Pay.index_12"),successMessage:!0}}),{t:z}=t.global,h=r("backup",(()=>{const e=u(!1),a=u(!1),t=u([]),l=u({});return{backupData:l,storageType:t,showBackupStatus:a,loading:e,getData:async n=>{try{let o;if(e.value=!0,n)a.value=!0,o=n;else{a.value=!1;o=(await s.post("/mod/backup_restore/com/get_data_total")).message}i(o)&&(N.value=o.oss_list&&o.oss_list.length?o.oss_list.map((e=>({label:e.name,value:e.value,disabled:!e.status}))):[],N.value.unshift({value:"local",label:z("Crontab.Script.index_24"),disabled:!1}),l.value=o,F.data=o.site_list,I.data=o.database_list,L.data=[{name:"SSH",size:o.ssh_info.ssh_size,status:o.ssh_info.status,err_msg:o.ssh_info.err_msg},{name:"Command",size:o.ssh_info.command_size,status:o.ssh_info.status,err_msg:o.ssh_info.err_msg}],X.data=o.wp_list,E.data=o.ftp_list,J.data=o.crontab_list,W.data=[{name:"IP Rules",value:o.firewall_info.firewall_ip,status:o.firewall_info.status,err_msg:o.firewall_info.err_msg},{name:"Region Rules",value:o.firewall_info.firewall_conutry,status:o.firewall_info.status,err_msg:o.firewall_info.err_msg},{name:"Port Rules",value:o.firewall_info.firewall_new,status:o.firewall_info.status,err_msg:o.firewall_info.err_msg},{name:"Port Forwarding Rules",value:o.firewall_info.firewall_forward,status:o.firewall_info.status,err_msg:o.firewall_info.err_msg}],ee.data=o.plugin_list,se.data=o.soft_data,Z.data=Object.values(o.vmail_info).length?[o.vmail_info]:[],U.data=[...o.ssl_info.ssl_list.map((e=>({...e,type:"ssl"}))),...o.ssl_info.provider_list.map((e=>({...e,type:"provider"})))],o.oss_list&&o.oss_list.length&&(t.value=o.oss_list.map((e=>({label:e.name,value:e.value,disabled:!e.status}))).concat({label:"Local Storage",value:"local",disabled:!1})))}finally{e.value=!1}}}})),P=h(),{showBackupStatus:j}=c(P),{t:D}=t.global,M=e=>e<Date.now()-864e5,N=u([]),S=e=>e.disabled?_("div",null,[_("span",null,[e.label]),_("span",{class:"float-right cursor-pointer color-#ef0808",onClick:()=>(async(e,s)=>{await a(e),await o({name:e,title:s,admin:!0})})(e.value,e.label)},[p("["),D("Crontab.Planned.index_47"),p("]")])]):_("span",null,[e.label]),q=e=>{const a=new Date(e||Date.now()),s=e=>e<10?"0"+e:e,t=a.getFullYear(),i=s(a.getMonth()+1),l=s(a.getDate()),n=s(a.getHours()),o=s(a.getMinutes());return"Backup-".concat(t,"-").concat(i,"-").concat(l,"-").concat(n).concat(o)},O=e=>({key:"name",title:D("Config.Backup.index_22"),render:a=>0===a.backup_status?_("span",{class:"text-#999"},[D("Config.Backup.index_23")]):1===a.restore_status?_("span",{class:"text-warning cursor-pointer",onClick:()=>{e("restore")}},[D("Config.Backup.index_24")]):1===a.backup_status?_("span",{class:"text-primary cursor-pointer",onClick:()=>{e("backup")}},[D("Config.Backup.index_25")]):_("div",{class:"items-center! cursor-pointer",onClick:()=>{e("log",a)}},[_(g,{type:"success",dot:!0},null),p(" "),D("Config.Backup.index_26"),p("("),a.backup_count.success||"--",p(")"),_(g,{type:"error",class:"ml-10px!",dot:!0},null),p(" "),D("Config.Backup.index_27"),p("("),a.backup_count.failed||"--",p(")")])}),R=()=>({title:D("Public.Table.Status"),key:"status",align:"center",width:80,render:e=>j.value?2===e.status?_(n,{name:"base-success",class:"text-#20a53a",size:"16"},null):_(m,null,{trigger:()=>_(n,{name:"base-error",class:"text-error",size:"16"},null),default:()=>_(d,null,[e.err_msg])}):_("span",{class:"text-#20a53a"},[p("Ready")])}),{table:F,columns:H}=e([{title:D("Config.Backup.index_28"),key:"name"},{title:D("Config.Backup.index_29"),key:"size",render:e=>l(Number(e.size))},{title:D("Config.Backup.index_30"),key:"type"},R()]),{table:I,columns:T}=e([{title:D("Config.Backup.index_31"),key:"name"},{title:D("Config.Backup.index_32"),key:"size",render:e=>l(Number(e.size))},{title:D("Config.Backup.index_33"),key:"type"},R()]),{table:X,columns:A}=e([{title:D("Config.Backup.index_28"),key:"name"},{title:D("Config.Backup.index_29"),key:"size",render:e=>l(Number(e.size))},{title:D("Config.Backup.index_30"),key:"type"},R()]),{table:E,columns:G}=e([{title:D("Config.Backup.index_34"),key:"name"},R()]),{table:J,columns:K}=e([{title:D("Config.Backup.index_35"),key:"name"},R()]),{table:L,columns:Y}=e([{title:D("Config.Backup.index_36"),key:"name"},{title:D("Config.Backup.index_37"),key:"size",render:e=>l(Number(e.size))},R()]),{table:Z,columns:Q}=e([{title:D("Config.Backup.index_38"),key:"name"},{title:D("Config.Backup.index_39"),key:"size",render:e=>l(Number(e.size))},R()]),{table:U,columns:V}=e([{title:D("Config.Backup.index_40"),key:"type"},{title:D("Config.Backup.index_41"),key:"name"},{title:D("Config.Backup.index_42"),key:"ps"},R()]),{table:W,columns:$}=e([{title:D("Config.Backup.index_43"),key:"name"},{title:D("Config.Backup.index_44"),key:"value"},R()]),{table:ee,columns:ae}=e([{title:D("Config.Backup.index_45"),key:"name"},{title:D("Config.Backup.index_46"),key:"size",render:e=>l(Number(e.size))},R()]),{table:se,columns:te}=e([{title:D("Config.Backup.index_47"),key:"name"},{title:D("Config.Backup.index_48"),key:"version"},{title:D("Config.Backup.index_37"),key:"size",render:e=>l(Number(e.size))},R()]);export{Y as A,q as B,N as C,S as D,M as E,f as F,w as G,B as H,v as I,y as J,b as K,H as a,O as b,I as c,C as d,T as e,A as f,k as g,E as h,x as i,G as j,K as k,Q as l,U as m,V as n,W as o,$ as p,ee as q,ae as r,F as s,J as t,h as u,Z as v,X as w,se as x,te as y,L as z};
