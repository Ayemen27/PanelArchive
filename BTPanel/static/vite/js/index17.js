const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index114.js?v=1758532619827","js/index105.js?v=1758532619827","js/page_layout.js?v=1758532619827","js/vue.js?v=1758532619827","js/__commonjsHelpers__.js?v=1758532619827","js/naive.js?v=1758532619827","js/common.js?v=1758532619827","js/public.js?v=1758532619827","css/public.css?v=1758532619827","css/page_layout.css?v=1758532619827","css/index19.css?v=1758532619827","js/index.js?v=1758532619827","css/index108.css?v=1758532619827","js/index.vue_vue_type_script_setup_true_lang.js?v=1758532619827","js/backup-info.js?v=1758532619827","js/utils.js?v=1758532619827","js/soft.js?v=1758532619827","css/backup-info.css?v=1758532619827","js/migrate-success.js?v=1758532619827","js/migrate-error.js?v=1758532619827"])))=>i.map(i=>d[i]);
import{n as e,_ as a,R as t,t as s,i as o,c as l,a as r}from"./page_layout.js?v=1758532619827";import{_ as i}from"./index.js?v=1758532619827";import{e as n,q as p,_ as d}from"./public.js?v=1758532619827";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang.js?v=1758532619827";import _ from"./backup-info.js?v=1758532619827";import{u as c}from"./utils.js?v=1758532619827";import{k as m,P as g,a0 as h,R as w,a2 as f,a3 as x,X as b,V as v,j as C,a4 as y,U as k,r as M,e as j,a5 as T,_ as P}from"./vue.js?v=1758532619827";import{dd as q,dh as D,d9 as O,dP as R,dS as U,dk as $,au as E,df as I,aC as S}from"./naive.js?v=1758532619827";const V=m({__name:"index",setup(s){const{t:o}=g(),l=c(),{loading:r,backupData:i}=h(l);return l.getData(),(s,l)=>{const n=q,p=a,d=D,c=O,m=R,g=u,h=t;return w(),f(h,{show:v(r),class:"p-16px"},{default:x((()=>[b(g,{ref:"formRef"},{default:x((()=>[b(m,{label:v(o)("Config.Migrate.index_10")},{default:x((()=>[b(c,null,{default:x((()=>[b(n,{class:"mr-8px"},{default:x((()=>[C(y(v(e)(v(i).disk_use)),1)])),_:1}),k("div",null,[k("span",null,y(v(o)("Config.Migrate.index_11")),1),b(n,{type:"success",class:"ml-16px mr-8px"},{default:x((()=>[C(y(v(e)(v(i).disk_free)),1)])),_:1}),b(d,{trigger:"hover",placement:"top-start"},{trigger:x((()=>[b(p,{name:"base-warning",class:"text-warning mr-4px",size:"16"})])),default:x((()=>[k("span",null,[k("li",null,y(v(o)("Config.Migrate.index_12"))+" "+y(v(e)(1.5*v(i).disk_use)),1),k("li",null,y(v(o)("Config.Migrate.index_13")),1)])])),_:1})])])),_:1})])),_:1},8,["label"]),b(m,{label:"Backup Data"},{default:x((()=>[b(_,{class:"w-600px"})])),_:1})])),_:1},512)])),_:1},8,["show"])}}}),A=()=>s.post("/mod/backup_restore/com/get_migrate_progress"),L=()=>s.post("/mod/backup_restore/com/stop_migrate",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}),z=()=>s.post("/mod/backup_restore/com/close_migrate_popup",{},{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!1}}),B=m({__name:"index",setup(e){const a=P((()=>r((()=>import("./index114.js?v=1758532619827")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])))),t=P((()=>r((()=>import("./migrate-success.js?v=1758532619827")),__vite__mapDeps([18,7,2,3,4,5,6,9,8,11,12,13,14,15,16,17])))),_=P((()=>r((()=>import("./migrate-error.js?v=1758532619827")),__vite__mapDeps([19,7,2,3,4,5,6,9,8,11,12,13,14,15,16,17])))),{t:c}=g(),m=n(c("Config.Migrate.index_4")),h=n(c("Config.Migrate.index_5"),{onRefresh:(e,a)=>{"success"===e?(q.data=a,q.show=!0):(D.data.errData=a,D.show=!0)}}),q=n(c("Config.Migrate.index_6")),D=n(c("Config.Migrate.index_7"),{onRetry:e=>{D.show=!1,h.show=!1,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password,F()}}),A=M(null),L=j({ip:"",port:22,account:"",password:""}),z={ip:{required:!0,message:c("Term.index_9"),trigger:["blur","input"]},port:{required:!0,type:"number",message:c("Security.Conf.Index_28"),trigger:["blur","input"]},account:{required:!0,message:c("Term.index_11"),trigger:["blur","input"]},password:{required:!0,message:c("Term.index_14"),trigger:["blur","input"]}},B=()=>{m.show=!0},X=()=>({auth_type:"password",server_ip:L.ip,ssh_port:L.port,ssh_user:L.account,password:L.password,ps:L.ip}),F=async()=>{var e;await(null==(e=A.value)?void 0:e.validate()),p({title:c("Config.Migrate.index_8"),content:()=>b("span",null,[b(T("i18n-t"),{keypath:"Config.Migrate.index_9",scope:"global"},{default:()=>[b("b",{class:"color-warning text-2xl"},[C(" "),L.ip,C(" ")])]})]),onConfirm:async()=>{var e;await(e=X(),s.post("/mod/backup_restore/com/ssh_auth_check",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}})),await(e=>s.post("/mod/backup_restore/com/add_migrate_task",e,{requestOptions:{loading:o.global.t("Component.Pay.index_12"),successMessage:!0}}))(X()),h.show=!0}})};return(async()=>{const{message:e}=await s.post("/mod/backup_restore/com/get_migrate_status");l(e)&&e.is_running&&(h.show=!0,L.ip=e.server_ip,L.port=e.ssh_port,L.account=e.ssh_user,L.password=e.password)})(),(e,s)=>{const o=E,l=R,r=I,n=O,p=S,g=u,M=d,j=i,T=U;return w(),f(T,{class:"p-16px"},{default:x((()=>[b(v($),{type:"warning",class:"mb-16px"},{default:x((()=>[k("span",null,y(v(c)("Config.Migrate.index_1")),1)])),_:1}),b(g,{ref_key:"formRef",ref:A,model:v(L),rules:z},{default:x((()=>[b(n,null,{default:x((()=>[b(l,{label:e.$t("Term.index_8"),path:"ip"},{default:x((()=>[b(o,{class:"w-190px!",value:v(L).ip,"onUpdate:value":s[0]||(s[0]=e=>v(L).ip=e),placeholder:e.$t("Term.index_9")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{path:"port"},{default:x((()=>[b(r,{"show-button":!1,class:"w-80px!",value:v(L).port,"onUpdate:value":s[1]||(s[1]=e=>v(L).port=e),placeholder:e.$t("Docker.Container.create.index_7")},null,8,["value","placeholder"])])),_:1})])),_:1}),b(l,{label:e.$t("Term.index_10"),path:"account"},{default:x((()=>[b(o,{class:"w-280px!",value:v(L).account,"onUpdate:value":s[2]||(s[2]=e=>v(L).account=e),placeholder:e.$t("Term.index_11")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{label:e.$t("Database.index_14"),path:"password"},{default:x((()=>[b(o,{class:"w-280px!",value:v(L).password,"onUpdate:value":s[3]||(s[3]=e=>v(L).password=e),placeholder:e.$t("Term.index_14")},null,8,["value","placeholder"])])),_:1},8,["label"]),b(l,{label:" "},{default:x((()=>[b(p,{type:"primary",onClick:F},{default:x((()=>[C(y(v(c)("Config.Migrate.index_2")),1)])),_:1})])),_:1})])),_:1},8,["model"]),b(M,null,{default:x((()=>[s[8]||(s[8]=k("li",{class:"text-warning font-bold"},"Please use root user",-1)),k("li",null,[b(p,{type:"primary",text:"",onClick:B},{default:x((()=>[C(y(v(c)("Config.Migrate.index_3")),1)])),_:1})])])),_:1,__:[8]}),b(j,{show:v(m).show,"onUpdate:show":s[4]||(s[4]=e=>v(m).show=e),title:v(m).title,data:v(m).data,width:"850","min-height":250,component:V},null,8,["show","title","data"]),b(j,{show:v(h).show,"onUpdate:show":s[5]||(s[5]=e=>v(h).show=e),title:v(h).title,hideClose:!0,data:v(h).data,width:"750","min-height":250,component:v(a)},null,8,["show","title","data","component"]),b(j,{show:v(q).show,"onUpdate:show":s[6]||(s[6]=e=>v(q).show=e),title:v(q).title,hideClose:!0,data:v(q).data,width:"750","min-height":250,component:v(t)},null,8,["show","title","data","component"]),b(j,{show:v(D).show,"onUpdate:show":s[7]||(s[7]=e=>v(D).show=e),title:v(D).title,hideClose:!0,data:v(D).data,width:"750","min-height":250,component:v(_)},null,8,["show","title","data","component"])])),_:1})}}}),X=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{z as a,L as c,A as g,X as i};
