import{_ as e}from"./index.js?v=1758532619827";import{m as a,t as l,_ as t,q as s,bI as n,bJ as o,p as c}from"./page_layout.js?v=1758532619827";import{k as i,P as r,i as u,r as d,R as f,S as h,X as p,a3 as m,U as v,V as _,j as b,a4 as C,a2 as k,an as F,F as j,O as y,av as x,aj as M}from"./vue.js?v=1758532619827";import{o as g}from"./index39.js?v=1758532619827";import{R as $}from"./ResourceManagerWindow.js?v=1758532619827";import{au as w,aC as U,az as O,dP as R,_ as P,dU as S,dT as W,dW as D}from"./naive.js?v=1758532619827";import"./common.js?v=1758532619827";import"./__commonjsHelpers__.js?v=1758532619827";import"./public.js?v=1758532619827";import"./soft2.js?v=1758532619827";import"./soft.js?v=1758532619827";import"./file2.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827";const H={class:"search-wrapper"},I={class:"w-100% flex justify-start gap-6 items-center"},T={class:"w-100% flex justify-between"},q={class:"search-res"},z={class:"top-desc"},L={class:"mr-5px"},E={class:"match-list"},J={class:"text-font1 fw-bold"},K=["innerHTML"],V=c(i({__name:"SearchFileContent",props:{currentPath:{type:String,default:"/"}},setup(c,{expose:i}){const V=c,{t:X}=r(),A=u("fileStore"),{currentPath:B,resetSearchFileContentFormData:G,choosedKeys:N}=A;function Q(){G()}i({open:function(){te.value=!0,ee.value.path=B.value},close:Q});const{searchStatistics:Y,searchRes:Z,searchFileContentFormData:ee}=A,ae=d(),le=d(V.currentPath),te=d(!1);function se(){!async function(){const e=a.loading(X("file.searchFileContentModal.searching"));try{const e=await l.post("/files?action=files_search",ee.value,{requestOptions:{isOriginalResult:!0}});Z.value=e.message,Object.keys(Z.value).length&&(Y.value.files=Object.keys(Z.value).length,Y.value.times=Object.values(Z.value).flat().reduce(((e,a)=>e+Object.values(a).length),0))}catch(t){console.warn(t)}finally{e.close()}}()}function ne(e,a){const l=new RegExp(a,"g");return e.replace(l,'<span style="color:#ff3300">'.concat(a,"</span>"))}function oe(){ae.value.open()}function ce(e){ee.value.path=e}return(a,l)=>{const c=w,i=U,r=O,u=R,d=P,V=t,X=S,A=W,G=D,N=s,ie=n,re=o,ue=e;return f(),h(j,null,[p(ue,{show:_(te),"onUpdate:show":l[7]||(l[7]=e=>M(te)?te.value=e:null),title:a.$t("file.searchFileContentModal.title"),width:720,onPublicClose:Q},{default:m((()=>[v("div",H,[p(G,{"label-placement":"left","label-width":60,"label-align":"left"},{default:m((()=>[p(u,{label:a.$t("file.searchFileContentModal.search")},{default:m((()=>[p(r,null,{default:m((()=>[p(c,{value:_(ee).text,"onUpdate:value":l[0]||(l[0]=e=>_(ee).text=e)},null,8,["value"]),p(i,{type:"primary",onClick:se},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.search")),1)])),_:1})])),_:1})])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.suffix")},{default:m((()=>[p(c,{value:_(ee).exts,"onUpdate:value":l[1]||(l[1]=e=>_(ee).exts=e)},null,8,["value"])])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.folder")},{default:m((()=>[v("div",I,[p(c,{value:_(ee).path,"onUpdate:value":l[3]||(l[3]=e=>_(ee).path=e)},{suffix:m((()=>[p(d,{checked:_(ee).is_subdir,"onUpdate:checked":l[2]||(l[2]=e=>_(ee).is_subdir=e),"checked-value":1,"unchecked-value":0},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.subdir")),1)])),_:1},8,["checked"])])),_:1},8,["value"]),p(V,{name:"file-dir",color:"#000",size:"24",style:{cursor:"pointer"},onClick:oe})])])),_:1},8,["label"]),p(u,{label:a.$t("file.searchFileContentModal.mode")},{default:m((()=>[v("div",T,[p(A,{value:_(ee).mode,"onUpdate:value":l[4]||(l[4]=e=>_(ee).mode=e)},{default:m((()=>[p(X,{value:0},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.words")),1)])),_:1}),p(X,{value:1},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.regex")),1)])),_:1})])),_:1},8,["value"]),v("div",null,[0==_(ee).mode?(f(),k(d,{key:0,checked:_(ee).isword,"onUpdate:checked":l[5]||(l[5]=e=>_(ee).isword=e),label:a.$t("file.searchFileContentModal.matchWholeWord"),class:"mr-5","checked-value":1,"unchecked-value":0},null,8,["checked","label"])):F("",!0),p(d,{checked:_(ee).iscase,"onUpdate:checked":l[6]||(l[6]=e=>_(ee).iscase=e),label:a.$t("file.searchFileContentModal.matchCase"),"checked-value":1,"unchecked-value":0},null,8,["checked","label"])])])])),_:1},8,["label"])])),_:1}),v("div",q,[v("div",z,[v("span",L,C(a.$t("file.searchFileContentModal.searchResult")),1),v("span",null,C(_(Y).times)+" "+C(a.$t("file.searchFileContentModal.matchesIn"))+" "+C(_(Y).files)+" "+C(a.$t("file.searchFileContentModal.files")),1)]),p(N,{style:{"margin-bottom":"20px"}}),(f(!0),h(j,null,y(_(Z),((e,l)=>(f(),k(re,{key:l,class:"mb-10px"},{default:m((()=>[p(ie,{title:"".concat(l," (").concat(a.$t("file.searchFileContentModal.match")," ").concat(Object.values(e).length," ").concat(a.$t("file.searchFileContentModal.times"),")"),name:"1"},{"header-extra":m((()=>[p(i,{text:"",type:"primary",onClick:x((e=>async function(e){g(0,e,B.value)}(l)),["stop"])},{default:m((()=>[b(C(a.$t("file.searchFileContentModal.edit")),1)])),_:2},1032,["onClick"])])),default:m((()=>[v("div",E,[(f(!0),h(j,null,y(e,((e,l)=>(f(),h("div",{class:"match-list-item",key:l},[v("div",J,C(a.$t("file.searchFileContentModal.line"))+" "+C(l)+": ",1),v("div",{innerHTML:ne(e,_(ee).text)},null,8,K)])))),128))])])),_:2},1032,["title"])])),_:2},1024)))),128))])])])),_:1},8,["show","title"]),p($,{"current-path":_(le),ref_key:"resourceRef",ref:ae,onChooseDir:ce},null,8,["current-path"])],64)}}}),[["__scopeId","data-v-85d18df6"]]);export{V as default};
