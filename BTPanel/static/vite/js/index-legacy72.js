System.register(["./page_layout-legacy.js?v=1758532619827","./public-legacy.js?v=1758532619827","./vue-legacy.js?v=1758532619827","./naive-legacy.js?v=1758532619827","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1758532619827","./index-legacy.js?v=1758532619827","./echartsGl-legacy.js?v=1758532619827","./common-legacy.js?v=1758532619827","./interface-legacy.js?v=1758532619827","./echarts-legacy.js?v=1758532619827","./tools-legacy2.js?v=1758532619827","./__commonjsHelpers__-legacy.js?v=1758532619827","./rules-legacy.js?v=1758532619827"],(function(e,t){"use strict";var a,l,o,i,r,n,s,c,d,u,p,v,f,m,x,h,y,b,g,w,_,k,S,O,W,$,C,j,L,z,T,D,E,q,R,M,A,I,U,H,N,G,P,B,F,V,Q,X,Y,Z,J,K,ee,te,ae,le,oe,ie,re,ne,se,ce,de,ue,pe,ve,fe,me,xe,he,ye,be;return{setters:[e=>{a=e.p,l=e.d6,o=e.q,i=e.bd,r=e.a7,n=e.a4,s=e.d7,c=e.w,d=e.R,u=e.l,p=e.a,v=e.d8,f=e.o,m=e.am,x=e.d9,h=e.c,y=e.k,b=e.da,g=e.s,w=e.cr},e=>{_=e.l,k=e.e,S=e.c,O=e.h,W=e.a},e=>{$=e.R,C=e.a2,j=e.a3,L=e.q,z=e.k,T=e.am,D=e.e,E=e.U,q=e.a4,R=e.V,M=e.X,A=e.r,I=e.P,U=e.ae,H=e.y,N=e.S,G=e.F,P=e.O,B=e.j,F=e.aj,V=e.W,Q=e.a0,X=e.aH,Y=e.an,Z=e.H,J=e._,K=e.w,ee=e.n,te=e.aw,ae=e.o,le=e.b},e=>{oe=e.dS,ie=e.bH,re=e.dh,ne=e.dZ,se=e.dT,ce=e.H,de=e.dj,ue=e.e2},e=>{pe=e._},e=>{ve=e._},e=>{fe=e.i,me=e.a,xe=e.b},e=>{he=e.a0},null,e=>{ye=e.a4},e=>{be=e.a},null,null],execute:function(){var ge=document.createElement("style");ge.textContent='.wap-card[data-v-93a608a4]{--n-border-radius: 6px;--n-title-font-size: 14px;box-shadow:0 1px 3px 1px rgba(0,0,0,.05)}.wap-card[data-v-93a608a4] .n-card-header{height:50px;padding:0 16px}.refresh-progress[data-v-8898e53f]{width:28px;cursor:pointer}.bt-radio[data-v-f8a2b372] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-f8a2b372] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}.count-item[data-v-a0dab078]{color:var(--waf-overview-text-color)}.count-item+.count-item[data-v-a0dab078]{padding-top:20px;margin-top:20px;border-top:1px solid var(--color-border)}.count-item .count-tit[data-v-a0dab078]{margin-bottom:12px;font-size:14px}.count-item .count-val[data-v-a0dab078]{display:flex;align-items:baseline;padding-left:12px}.count-item .count-num[data-v-a0dab078]{font-size:22px;font-weight:700;cursor:pointer}.district-legend[data-v-b48493e2]{position:absolute;left:4%;bottom:4%;display:flex;align-items:center;color:var(--color-text-2)}.district-legend .item[data-v-b48493e2]{width:15px;height:4px}.district-legend .item+.item[data-v-b48493e2]{margin-left:6px}.district-legend .item[data-v-b48493e2]:nth-of-type(1){background-color:rgba(62,183,82,.125)}.district-legend .item[data-v-b48493e2]:nth-of-type(2){background-color:rgba(62,183,82,.5)}.district-legend .item[data-v-b48493e2]:nth-of-type(3){background-color:#3eb752}.attack-map{width:100%;height:100%}.attack-map>div:first-child:before{content:"";background:radial-gradient(closest-side,#fff,var(--color-bg-1));border-radius:100%;width:464px;height:464px;display:inline-block;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;border:26px solid var(--color-bg-2)}.attack-map>div:first-child:after{content:"";background:var(--color-bg-2);border-radius:100%;display:inline-block;width:534px;height:534px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;border:10px solid var(--color-bg-1)}.attack-map canvas{z-index:4}\n',document.head.appendChild(ge);const we=a({},[["render",function(e,t){const a=oe;return $(),C(a,{class:"wap-card"},{header:j((()=>[L(e.$slots,"header",{},void 0,!0)])),default:j((()=>[L(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-93a608a4"]]),_e={class:"flex items-center h-184px text-font3 color-[var(--waf-overview-text-color)]"},ke={class:"flex-1 flex-center flex-col"},Se={class:"flex items-center mb-16px"},Oe={class:"ml-8px text-14px"},We={class:"text-22px font-bold"},$e={class:"flex-1 flex-center flex-col"},Ce={class:"flex items-center mb-16px"},je={class:"ml-8px text-14px"},Le=z({__name:"index",setup(e){const t=l(),a=T(),i=D({request:0,malicious:0}),r=()=>{a.push("/waf/block")};return t.onReady("total",(e=>{i.request=e.count.today_request,i.malicious=e.count.malicious_request})),(e,t)=>{const a=o;return $(),C(we,null,{default:j((()=>[E("div",_e,[E("div",ke,[E("div",Se,[t[0]||(t[0]=E("img",{class:"icon",src:"/static/vite/images/today.svg"},null,-1)),E("span",Oe,q(e.$t("Waf.Overview.index_1")),1)]),E("div",We,q(R(i).request),1)]),M(a,{class:"text-106px",vertical:""}),E("div",$e,[E("div",Ce,[t[1]||(t[1]=E("img",{class:"icon",src:"/static/vite/images/malicious.svg"},null,-1)),E("span",je,q(e.$t("Waf.Overview.index_2")),1)]),E("div",{class:"text-22px font-bold cursor-pointer",onClick:r},q(R(i).malicious),1)])])])),_:1})}}}),ze={class:"text-desc text-12px leading-1"},Te=z({__name:"auto-refresh",props:{open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=A(0),o=A(a),i=A(!1),{loop:r}=_((async()=>{if(0===o.value)try{i.value=!0,await(t.refresh?.())}finally{l.value=0,o.value=a,i.value=!1}else o.value-=1,l.value=(a-o.value)/a*100}),1);return r(),(e,t)=>{const r=ie,n=re;return $(),C(n,{placement:"bottom"},{trigger:j((()=>[M(r,{class:"refresh-progress",type:"circle",status:"success",processing:R(i),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:R(l)},{default:j((()=>[E("span",ze,q(R(o)),1)])),_:1},8,["processing","percentage"])])),default:j((()=>[E("span",null,q(e.$t("Waf.Overview.index_8",[R(a)])),1)])),_:1})}}}),De=a(Te,[["__scopeId","data-v-8898e53f"]]),Ee={class:"flex"},qe=a(z({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=I(),a=A("today"),l=A(null),o=U(e,"value"),s=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],c=e=>{l.value=null,o.value=e},d=e=>{a.value=e?"":"today",o.value=i(e)?r(e,"yyyy-MM-dd"):"today"};return H((()=>{s.map((e=>e.value)).includes(o.value)?(a.value=o.value,l.value=null):(a.value="",l.value=new Date(o.value).getTime())})),(e,t)=>{const o=ne,i=se,r=n;return $(),N("div",Ee,[M(i,{value:R(a),"onUpdate:value":[t[0]||(t[0]=e=>F(a)?a.value=e:null),c],size:"small",class:"bt-radio"},{default:j((()=>[($(),N(G,null,P(s,(e=>M(o,{key:e.value,value:e.value},{default:j((()=>[B(q(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),M(r,{value:R(l),"onUpdate:value":[t[1]||(t[1]=e=>F(l)?l.value=e:null),d],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-f8a2b372"]]),Re={class:"flex justify-between flex-1"},Me={class:"flex items-center"},Ae={class:"mr-10px"},Ie={class:"flex-center h-134px p-10px"},Ue=z({__name:"index",setup(e){const{t:t}=I(),a=V("--chart-tooltip-bg-color"),o=V("--color-text-2"),i=V("--color-border"),n=l(),{loading:u,startTime:p}=Q(n),v=A(!0),f=()=>{n.getInfo()},m=async()=>{await n.getNewInfo()},x=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:o.value},nameTextStyle:{color:o.value},axisLine:{show:!0,lineStyle:{color:i.value}},axisTick:{show:!0,lineStyle:{color:i.value}}}),h=(e=[],a=[])=>[{name:t("Waf.Overview.index_4"),type:"line",data:e,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:"#A0BFE0"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(242, 242, 242, 0.6)"},{offset:.8,color:"rgba(242, 242, 242, 0)"}]}}},{name:t("Waf.Overview.index_5"),type:"line",data:a,sampling:"average",smooth:!0,symbol:"none",showSymbol:!1,itemStyle:{color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.6)"},{offset:1,color:"rgba(32, 164, 58, 0)"}]}}}],y=X({grid:{left:"5%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},legend:{icon:"circle",data:[t("Waf.Overview.index_5"),t("Waf.Overview.index_4")],top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{color:o.value,lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",backgroundColor:a.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},formatter(e){let a="";const l=Object.entries(e);return l.forEach((([,e],o)=>{0===o&&(a+=`${t("Waf.Overview.index_6",[r(s(p.value),"yyyy-MM-dd"),e.name])}<br />`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}<br />`,o===l.length-1&&(a+=`<div style="padding-left: 20px;">${t("Waf.Overview.index_7_1",[e.data.err_499])}<br />${t("Waf.Overview.index_7_2",[e.data.err_502])}</div>`)})),a}},xAxis:x(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:i.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:o.value},nameTextStyle:{color:o.value}},series:h()});return n.onReady("flow",(e=>{c(e.traffic_filter)&&e.traffic_filter.length>0?(v.value=!1,(e=>{const t=[],a=[],l=[];e.forEach((e=>{const o=e.hour<10?"0"+e.hour:e.hour,i=e.minute<10?"0"+e.minute:e.minute;t.push(`${o}:${i}`),a.push(e.proxy_count),l.push({value:e.request,err_499:e.err_499,err_502:e.err_502})})),y.xAxis=x(t),y.series=h(a,l)})(e.traffic_filter)):v.value=!0})),(e,t)=>{const a=ce,l=d;return $(),C(we,null,{header:j((()=>[E("div",Re,[E("div",Me,[E("div",Ae,q(e.$t("Waf.Overview.index_3")),1),M(qe,{value:R(p),"onUpdate:value":[t[0]||(t[0]=e=>F(p)?p.value=e:null),f]},null,8,["value"])]),M(De,{refresh:m})])])),default:j((()=>[M(l,{show:R(u)},{default:j((()=>[E("div",Ie,[R(v)?($(),C(a,{key:0})):($(),C(pe,{key:1,type:"line",height:"100%",option:R(y)},null,8,["option"]))])])),_:1},8,["show"])])),_:1})}}}),He={class:"h-134px p-10px"},Ne=z({__name:"index",setup(e){const{t:t}=I(),a=V("--chart-tooltip-bg-color"),o=V("--color-text-2"),i=V("--color-border"),n=l(),s=A(0),c=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:o.value,formatter:e=>r(u(e),"hh:mm:ss")},nameTextStyle:{color:o.value},axisLine:{show:!0,lineStyle:{color:i.value}},axisTick:{show:!0,lineStyle:{color:i.value}}}),d=(e=[])=>[{name:"QPS",type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],p=X({grid:{left:"5%",right:"10%",bottom:"3%",top:"20%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:a.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},formatter(e){let a="";return Object.entries(e).forEach((([,e],l)=>{0===l&&(a+=`${t("Waf.Overview.index_22",[r(e.axisValue)])}<br>`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}`})),a}},xAxis:c(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:i.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:o.value},nameTextStyle:{color:o.value}},series:d()}),v=[],f=[],m=()=>{var e;v.length>0&&(e=v[0],(new Date).getTime()-e>6e4)&&(v.shift(),f.shift()),p.xAxis=c(v),p.series=d(f)};return n.onReady("qps",(e=>{s.value=e.qps,v.push(Date.now()),f.push(e.qps),m()})),(e,t)=>($(),C(we,null,{header:j((()=>[E("span",null,q(e.$t("Waf.Overview.index_21",[R(s)])),1)])),default:j((()=>[E("div",He,[M(pe,{type:"line",height:"100%",option:R(p)},null,8,["option"])])])),_:1}))}}),Ge={class:"flex-center h-292px p-10px"},Pe=z({__name:"index",setup(e){const{t:t}=I(),a=V("--color-bg-2"),o=V("--color-text-1"),i=V("--color-text-2"),r=V("--color-text-3"),n=V("--color-border"),s=l(),c=A(!1),d=X({backgroundColor:a.value,title:u(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return`${t.marker} ${t.name}: ${t.value} (${t.percent}%)`}},series:v()});function u(e=0){return{text:t("Waf.Overview.index_32"),textStyle:{color:o.value,fontSize:17},subtext:`${e}`,subtextStyle:{color:i.value,fontSize:15},itemGap:20,left:"center",top:"42%"}}const p=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function v(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:r.value,lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":t("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:n.value}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:n.value}},color:e=>p[e.dataIndex]},emphasis:{scaleSize:15}}]}return s.onReady("block",(e=>{c.value=0===e.type.length,(e=>{let t=0;const a=[];e.forEach((e=>{t+=e[1],a.push({name:e[0],value:e[1]})})),d.title=u(t),d.series=v(a)})(e.type)})),(e,t)=>{const a=ce;return $(),C(we,{class:"mb-16px"},{header:j((()=>[E("span",null,q(e.$t("Waf.Overview.index_31")),1)])),default:j((()=>[E("div",Ge,[R(c)?($(),C(a,{key:0})):($(),C(pe,{key:1,type:"pie",height:"100%",option:R(d)},null,8,["option"]))])])),_:1})}}}),Be={class:"flex flex-col justify-center h-306px p-20px"},Fe={class:"count-item"},Ve={class:"count-tit"},Qe={class:"count-val"},Xe={class:"count-item"},Ye={class:"count-tit"},Ze={class:"count-val"},Je={class:"count-item"},Ke={class:"count-tit"},et={class:"count-val"},tt=a(z({__name:"index",setup(e){const a=J((()=>p((()=>t.import("./shell-legacy.js?v=1758532619827")),void 0))),o=J((()=>p((()=>t.import("./site-legacy2.js?v=1758532619827")),void 0))),i=J((()=>p((()=>t.import("./cc-legacy.js?v=1758532619827")),void 0))),{t:r}=I(),n=l(),s=D({webshell:0,site:0,siteList:[],cc:0,ccList:[]}),c=k(r("Waf.Overview.index_14")),d=()=>{},u=k(r("Waf.Overview.index_15")),m=async()=>{await v(),n.getNewInfo()},x=()=>{u.data.list=s.siteList,u.show=!0},h=k(r("Waf.Overview.index_16")),y=()=>{h.data.list=s.ccList,h.show=!0};return n.onReady("count",(e=>{s.webshell=e.count.webshell,s.site=e.count.unprotected_site,s.siteList=e.count.unprotected_site_list,s.cc=e.count.maybe_err_cc,s.ccList=e.count.maybe_err_cc_list})),(e,t)=>{const l=f,r=ve;return $(),C(we,null,{default:j((()=>[E("div",Be,[E("div",Fe,[E("div",Ve,q(e.$t("Waf.Overview.index_9")),1),E("div",Qe,[E("div",{class:"count-num",onClick:d},q(R(s).webshell),1)])]),E("div",Xe,[E("div",Ye,q(e.$t("Waf.Overview.index_10")),1),E("div",Ze,[E("div",{class:"count-num",onClick:x},q(R(s).site),1),R(s).site>0?($(),N(G,{key:0},[M(l,{class:"ml-20px",onClick:m},{default:j((()=>[B(q(e.$t("Waf.Overview.index_11")),1)])),_:1}),M(l,{class:"ml-20px",onClick:x},{default:j((()=>[B(q(e.$t("Waf.Overview.index_12")),1)])),_:1})],64)):Y("",!0)])]),E("div",Je,[E("div",Ke,q(e.$t("Waf.Overview.index_13")),1),E("div",et,[E("div",{class:Z(["count-num",{"text-error":R(s).cc>0}]),onClick:y},q(R(s).cc),3),R(s).cc>0?($(),C(l,{key:0,class:"ml-20px",onClick:y},{default:j((()=>[B(q(e.$t("Waf.Overview.index_12")),1)])),_:1})):Y("",!0)])])]),M(r,{show:R(c).show,"onUpdate:show":t[0]||(t[0]=e=>R(c).show=e),title:R(c).title,width:800,"min-height":236,component:R(a)},null,8,["show","title","component"]),M(r,{show:R(u).show,"onUpdate:show":t[1]||(t[1]=e=>R(u).show=e),title:R(u).title,data:R(u).data,width:440,"min-height":236,component:R(o)},null,8,["show","title","data","component"]),M(r,{show:R(h).show,"onUpdate:show":t[2]||(t[2]=e=>R(h).show=e),title:R(h).title,data:R(h).data,width:800,"min-height":236,component:R(i)},null,8,["show","title","data","component"])])),_:1})}}}),[["__scopeId","data-v-a0dab078"]]),at={class:"w-full h-full"},lt={class:"district-legend"},ot={class:"mr-2"},it={class:"ml-2"},rt=a(z({__name:"Map2d",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),a=m(),l=V("--waf-map-color"),o=V("--waf-map-border-color"),i=X({title:{left:"center",top:"top"},grid:{top:70,bottom:40,left:0,right:0},tooltip:{padding:4,borderColor:"rgba(50, 50, 50, 0)",backgroundColor:"rgba(50, 50, 50, 0.7)",textStyle:{color:"#fff"},formatter:e=>{const a=e;let l="";const o=`${a.value}`.split(".");return l="NaN"===o[0]?a.name:`${a.name}<br />${t("Waf.Overview.index_26",[o[0]])}`,l}},visualMap:{min:0,max:100,left:-200,range:null,inRange:{color:["rgba(62, 183, 82, 0.13)","rgba(62, 183, 82, 0.5)","#3eb752"]}},series:r()});function r(e=[]){return[{name:"World Population (2010)",type:"map",map:"world",zoom:1.2,itemStyle:{borderColor:o.value,areaColor:l.value},label:{show:!1},emphasis:{itemStyle:{borderColor:o.value,areaColor:a.value.primaryColor}},data:e}]}return K((()=>e.data),(e=>{ee((()=>{var t;t=e,i.series=r(t)}))}),{immediate:!0}),(e,t)=>($(),N("div",at,[E("div",lt,[E("span",ot,q(e.$t("Waf.Overview.index_24")),1),t[0]||(t[0]=E("div",{class:"item"},null,-1)),t[1]||(t[1]=E("div",{class:"item"},null,-1)),t[2]||(t[2]=E("div",{class:"item"},null,-1)),E("span",it,q(e.$t("Waf.Overview.index_25")),1)]),M(pe,{type:"map",height:"100%",option:R(i)},null,8,["option"])]))}}),[["__scopeId","data-v-b48493e2"]]),nt=z({__name:"Map3d",setup(e){const t=te("mapRef");let a=null;const l=A(0),o=A(0),i=A([]),r=()=>{const e=document.createElement("canvas"),t=ye.init(e,null,{width:4096,height:2048});return t.setOption({backgroundColor:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#9ed6ff"},{offset:.7,color:"#fafcfa"},{offset:1,color:"#9ed6ff"}]},series:[{type:"map",map:"world",left:0,top:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]],label:{show:!1,color:"#fff",fontSize:20},itemStyle:{areaColor:"#44b359",borderColor:"#fff",borderWidth:1}}]}),t},n=async()=>{if(!t.value)return;const{message:e}=await x();h(e)&&(l.value=e.load_ip.latitude,o.value=e.load_ip.longitude,i.value=e.attack_ip.map((t=>({coords:[[t.ip_longitude,t.ip_latitude],[e.load_ip.longitude,e.load_ip.latitude]],value:1})))),a=ye.init(t.value);const n={tooltip:{show:!0},globe:{silent:!0,shading:"color",baseTexture:r(),viewControl:{distance:240,targetCoord:[o.value,l.value],maxDistance:240,minDistance:240,rotateSensitivity:2,autoRotateSpeed:10}},series:[{type:"bar3D",coordinateSystem:"globe",shading:"lambert",opacity:1,bevelSize:.2,itemStyle:{color:"#EBE806"},label:{show:!1,formatter:"{b}"},data:[]},{name:"lines3D",type:"lines3D",coordinateSystem:"globe",effect:{show:!0,period:2,trailWidth:4,trailLength:.5,trailOpacity:1,trailColor:"red"},blendMode:"lighter",lineStyle:{width:1,color:"red",opacity:0},data:i.value,silent:!1},{type:"lines3D",coordinateSystem:"globe",effect:{show:!0,trailWidth:5,trailOpacity:1,trailLength:.2,constantSpeed:5},blendMode:"lighter",lineStyle:{color:"#EBE806",width:1,opacity:1},data:[]}]};a.setOption(n)},s=()=>{a?.resize()};return ye.use([fe,me,xe]),ae((async()=>{await(async()=>{const{data:e}=await he.get("/static/vite/data/world.json");ye.registerMap("world",e)})(),n(),window.addEventListener("resize",s)})),le((()=>{a?.dispose(),a=null,window.removeEventListener("resize",s)})),(e,a)=>($(),N("div",{ref_key:"mapRef",ref:t,class:"attack-map"},null,512))}}),st=z({__name:"Table",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),{columns:a}=S([{key:"ip",width:120,title:t("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>M("a",{class:"bt-link",href:"javascript:;",onClick:()=>{be({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:t("Waf.Overview.index_28")},{key:"address",title:t("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(t,l)=>{const o=O;return $(),C(o,{"max-height":520,bordered:!1,data:e.data,columns:R(a)},null,8,["data","columns"])}}}),ct={class:"flex items-center justify-between flex-1"},dt={class:"flex items-center"},ut={class:"mr-8px text-12px"},pt={class:"bt-link text-12px",href:"/btwaf/content_report.html",target:"_blank"},vt={class:"flex gap-12px h-616px p-16px"},ft={class:"relative flex-1"},mt={class:"w-320px min-w-320px"},xt=z({__name:"index",setup(e){const{t:t}=I(),a=l(),i=A(u(y("waf-map-type","0"))),r=A(!0),n=A([]),s=A([]),c=e=>{W({title:t(e?"Waf.Overview.index_35":"Waf.Overview.index_36"),content:t(e?"Waf.Overview.index_37":"Waf.Overview.index_38"),onConfirm:async()=>{await b(),r.value=e,i.value=e?3:2,g("waf-map-type",i.value)}})},d=e=>{g("waf-map-type",e)};return a.onReady("map",(e=>{n.value=e.map,s.value=e.attack_details,r.value=e["3D"],0===i.value&&(i.value=e["3D"]?3:2)})),(e,t)=>{const a=de,l=o,u=ne,p=se;return $(),C(we,null,{header:j((()=>[E("div",ct,[E("div",null,q(e.$t("Waf.Overview.index_23")),1),E("div",dt,[E("span",ut,q(e.$t("Waf.Overview.index_34")),1),M(a,{value:R(r),size:"small","onUpdate:value":c},null,8,["value"]),M(l,{vertical:""}),E("a",pt,q(e.$t("Waf.Overview.index_30")),1)])])])),default:j((()=>[E("div",vt,[E("div",ft,[R(r)?($(),C(p,{key:0,value:R(i),"onUpdate:value":[t[0]||(t[0]=e=>F(i)?i.value=e:null),d],class:"absolute top-0 left-0 z-1000",size:"small"},{default:j((()=>[M(u,{value:3},{default:j((()=>t[1]||(t[1]=[B("3D")]))),_:1,__:[1]}),M(u,{value:2},{default:j((()=>t[2]||(t[2]=[B("2D")]))),_:1,__:[2]})])),_:1},8,["value"])):Y("",!0),3===R(i)?($(),C(nt,{key:1})):Y("",!0),2===R(i)?($(),C(rt,{key:2,data:R(n)},null,8,["data"])):Y("",!0)]),E("div",mt,[M(st,{data:R(s)},null,8,["data"])])])])),_:1})}}});e("default",z({__name:"index",setup:e=>(l().getInfo(),(e,t)=>{const a=ue,l=w;return $(),N("div",null,[M(l,{"x-gap":"16","y-gap":"16"},{default:j((()=>[M(a,{span:"6 992:24"},{default:j((()=>[M(Le)])),_:1}),M(a,{span:"12 992:24"},{default:j((()=>[M(Ue)])),_:1}),M(a,{span:"6 992:24"},{default:j((()=>[M(Ne)])),_:1}),M(a,{span:"6 992:24"},{default:j((()=>[M(Pe),M(tt)])),_:1}),M(a,{span:"18 992:24"},{default:j((()=>[M(xt)])),_:1})])),_:1})])})}))}}}));
