import{_ as a}from"./index245.js?v=1758532619827";import{u as e,q as s,dK as t,dL as n,h as l,dM as o,p as u,dN as i,c as p,R as r}from"./page_layout.js?v=1758532619827";import{k as c,D as A,h as d,d as g,aj as m}from"./public.js?v=1758532619827";import{H as _,d9 as x,aC as f}from"./naive.js?v=1758532619827";import{k as y,P as C,X as v,F as k,u as b,r as h,w as j,b as w,aq as B,R as L,a2 as M,a3 as Q,U as R,S as D,O as E,V as I,a4 as z,j as F,l as U,an as H,a0 as N,e as O,x as S,aj as P}from"./vue.js?v=1758532619827";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1758532619827";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827";import{_ as K}from"./index105.js?v=1758532619827";import"./common.js?v=1758532619827";import"./__commonjsHelpers__.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1758532619827";const $=y({name:"EmptyBox",setup(a,{slots:t}){const n=e(),{t:l}=C(),o=()=>{c()};return()=>{var a;let e;return v(k,null,[0===n.taskCount?v(_,{class:"pt-80px",size:"huge",description:l("Layout.MessageBox.index_1")},null):v(k,null,[v(x,{class:"justify-between! flex-nowrap!"},{default:()=>{return[v("span",null,[l("Layout.MessageBox.index_2")]),v(f,{text:!0,type:"primary",onClick:o},(a=e=l("Public.Status.Restart"),"function"==typeof a||"[object Object]"===Object.prototype.toString.call(a)&&!b(a)?e:{default:()=>[e]}))];var a}}),v(s,{class:"mt-12px! mb-16px!"},null),null==(a=t.default)?void 0:a.call(t)])])}}}),G={class:"h-460px overflow-auto"},J={class:"install"},T={key:0,class:"cmd"},X=u(y({__name:"index",setup(a,{expose:s}){const u=e(),i=t(),p=n(),r=h(""),{send:c,close:d}=A("/sock_shell",{onMessage:(a,e)=>{const s=e.data;l(s)&&(r.value+=s)}}),g=()=>{if(p.taskList.length){const{type:a,status:e}=p.taskList[0];"execshell"===a&&("-1"===e?(r.value="",c("tail -n 100 -f /tmp/panelExec.log")):setTimeout((async()=>{await p.getList(),g()}),2e3))}};j((()=>u.taskCount),(a=>{a&&g(),i.getMessageCount()})),w((()=>{d()}));const m=async()=>{await p.getList(),0!==u.taskCount&&(g(),p.onRepetion())};return m(),s({init:m}),(a,e)=>{const s=f,t=x,n=B("scroll-bottom");return L(),M(I($),null,{default:Q((()=>[R("div",G,[(L(!0),D(k,null,E(I(p).taskList,(l=>(L(),D("div",{key:l.id},["execshell"===l.type?(L(),D(k,{key:0},[v(t,{class:"justify-between! mb-8px"},{default:Q((()=>[R("span",J,z(l.name),1),R("div",null,[F(z("0"===l.status?"waiting":a.$t("Soft.index_40"))+" ",1),e[0]||(e[0]=R("img",{src:"data:image/gif;base64,R0lGODlhDgACAIAAAHNzcwAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFDgABACwAAAAAAgACAAACAoRRACH5BAUOAAEALAQAAAACAAIAAAIChFEAIfkEBQ4AAQAsCAAAAAIAAgAAAgKEUQAh+QQJDgABACwAAAAADgACAAACBoyPBpu9BQA7"},null,-1)),e[1]||(e[1]=R("span",{class:"px-5px"},"|",-1)),v(s,{text:"",color:"#20a53a",onClick:a=>(async a=>{d(),await o({id:a}),await p.getList()})(l.id)},{default:Q((()=>[F(z(a.$t("Public.Btn.Del")),1)])),_:2},1032,["onClick"])])])),_:2},1024),"-1"===l.status?U((L(),D("pre",T,[F(z(I(r)),1)])),[[n]]):H("",!0)],64)):H("",!0)])))),128))])])),_:1})}}}),[["__scopeId","data-v-7b9da2ab"]]),W=y({__name:"index",setup(a,{expose:e}){const s=t(),{loading:n,table:l,columns:o,search:u}=N(s),i=()=>{s.getMessageCount()};return e({init:i}),(a,e)=>{const s=d,t=q,p=V;return L(),M(p,null,{table:Q((()=>[v(s,{loading:I(n),data:I(l).data,columns:I(o)},null,8,["loading","data","columns"])])),pageRight:Q((()=>[v(t,{page:I(u).p,"onUpdate:page":e[0]||(e[0]=a=>I(u).p=a),"page-size":I(u).limit,"onUpdate:pageSize":e[1]||(e[1]=a=>I(u).limit=a),"item-count":I(l).total,"page-slot":5,"show-size-picker":!1,onRefresh:i},null,8,["page","page-size","item-count"])])),_:1})}}}),Y=u(y({__name:"index",setup(a,{expose:e}){const s=h("None"),{loading:t,setLoading:n}=g(),o=async()=>{try{n(!0);const{message:a}=await i();p(a)&&(s.value=l(a.result)?a.result:"None")}finally{n(!1)}};return o(),e({init:o}),(a,e)=>{const n=K,l=r;return L(),M(l,{class:"h-full",show:I(t)},{default:Q((()=>[v(n,{log:I(s)},null,8,["log"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-8405edde"]]),Z={class:"h-550px"},aa=y({__name:"index",setup(s,{expose:n}){const{t:l}=C(),o=e(),u=t(),i=h("task"),p=O([{key:"task",label:()=>v("span",null,[l("Layout.MessageBox.index_3"),F(" ("),o.taskCount,F(")")]),component:S(X)},{key:"message",label:()=>v("span",null,[l("Layout.MessageBox.index_4"),F(" ("),u.listConut,F(")")]),component:S(W)},{key:"log",label:l("Layout.MessageBox.index_5"),component:S(Y)}]);return u.getMessageCount(),n({onClose:()=>{m()}}),(e,s)=>{const t=a;return L(),D("div",Z,[v(t,{value:I(i),"onUpdate:value":s[0]||(s[0]=a=>P(i)?i.value=a:null),ref:"tabsRef",data:I(p)},null,8,["value","data"])])}}});export{aa as default};
