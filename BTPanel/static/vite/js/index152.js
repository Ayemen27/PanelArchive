import{c as a,f as t,a as e,d as s,h as o,_ as i}from"./public.js?v=1758532619827";import{_ as n}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1758532619827";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1758532619827";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1758532619827";import{bh as r,a7 as d,n as c,f0 as m,f3 as u,c as _,x as g}from"./page_layout.js?v=1758532619827";import{a as f}from"./file.js?v=1758532619827";import{o as h}from"./upload.js?v=1758532619827";import{aC as y}from"./naive.js?v=1758532619827";import{k as b,P as x,e as w,R as j,S as k,X as v,a3 as D,j as z,a4 as q,V as C,U}from"./vue.js?v=1758532619827";import"./common.js?v=1758532619827";import"./__commonjsHelpers__.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1758532619827";const R={class:"p-20px"},S=b({__name:"index",props:{data:{}},setup(b){const{t:S}=x(),P=b,{row:$,type:L}=P.data,B=r(),E=w({p:1,limit:10,keyword:""}),F=async()=>{E.p=1,await X()},H=()=>{const a=(()=>{if(!B.backupPath)throw new Error(S("Database.tools.index_35"));const a="".concat(B.backupPath,"/database");switch(L){case"pgsql":return"".concat(a,"/pgsql");case"mongodb":return"".concat(a,"/mongodb");default:return a}})(),t="pgsql"==B.type?".sql":".sql,.gz,.tar.gz,.zip";h({path:a,uploadData:{multiple:!1,accept:t},onUploadSuccess:()=>{X()}})},{table:J,columns:Q}=a([{key:"name",title:S("Component.UploadFile.index_3"),ellipsis:{tooltip:{width:"trigger"}}},{key:"addtime",title:S("Database.tools.index_77"),width:150,render:a=>d(a.ctime)},{key:"size",title:S("Database.tools.index_14"),width:100,render:a=>c(a.size)},t({width:120,options:a=>[{label:S("Waf.Setting.index_13"),onClick:()=>{e({title:S("Database.tools.index_17"),content:S("Database.tools.index_36"),onConfirm:async({hide:t})=>{await(async a=>{await m(B.type,{file:a.path,name:$.name})})(a),t()}})}},{label:S("Public.Btn.Del"),onClick:()=>{e({title:"".concat(S("Database.tools.index_37")," [").concat(a.name,"]"),content:S("Database.tools.index_38",[a.name]),onConfirm:async({hide:t})=>{await(async a=>{await f({path:a.path}),X(),B.setRefresh(!0)})(a),t()}})}}]})]),{loading:V,setLoading:W}=s(),X=async()=>{try{W(!0);const{message:a}=await u({p:E.p,limit:E.limit,search:E.keyword,type_sql:L});_(a)&&(J.data=a.data,J.total=g(a.page))}finally{W(!1)}};return X(),(a,t)=>{const e=y,s=p,r=o,d=l,c=n,m=i;return j(),k("div",R,[v(c,null,{toolsLeft:D((()=>[v(e,{onClick:H},{default:D((()=>[z(q(a.$t("Database.tools.index_31")),1)])),_:1})])),toolsRight:D((()=>[v(s,{value:C(E).keyword,"onUpdate:value":t[0]||(t[0]=a=>C(E).keyword=a),onSearch:F},null,8,["value"])])),table:D((()=>[v(r,{"max-height":348,loading:C(V),data:C(J).data,columns:C(Q)},null,8,["loading","data","columns"])])),pageRight:D((()=>[v(d,{page:C(E).p,"onUpdate:page":t[1]||(t[1]=a=>C(E).p=a),"page-size":C(E).limit,"onUpdate:pageSize":t[2]||(t[2]=a=>C(E).limit=a),"item-count":C(J).total,onRefresh:X,showQuickJumper:!1},null,8,["page","page-size","item-count"])])),_:1}),v(m,{class:"mt-16px"},{default:D((()=>[U("li",null,q(a.$t("Database.tools.index_32"))+" sql, zip, (tar.gz|gz|tgz)",1),U("li",null,q(a.$t("Database.tools.index_33")),1),U("li",null,q(a.$t("Database.tools.index_34")),1)])),_:1})])}}});export{S as default};
