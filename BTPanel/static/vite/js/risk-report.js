const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/HighRiskSection.js?v=1758532619827","js/vue.js?v=1758532619827","js/__commonjsHelpers__.js?v=1758532619827","js/page_layout.js?v=1758532619827","js/naive.js?v=1758532619827","js/common.js?v=1758532619827","js/public.js?v=1758532619827","css/public.css?v=1758532619827","css/page_layout.css?v=1758532619827","css/HighRiskSection.css?v=1758532619827","js/MidRiskSection.js?v=1758532619827","css/MidRiskSection.css?v=1758532619827","js/CveSection.js?v=1758532619827","css/CveSection.css?v=1758532619827","js/LowRiskSection.js?v=1758532619827","css/LowRiskSection.css?v=1758532619827","js/MaliciousSection.js?v=1758532619827","css/MaliciousSection.css?v=1758532619827","js/WebVulnSection.js?v=1758532619827","css/WebVulnSection.css?v=1758532619827","js/ServerSecSection.js?v=1758532619827","css/ServerSecSection.css?v=1758532619827","js/html2pdf.js?v=1758532619827"])))=>i.map(i=>d[i]);
import{u as s,a as e,m as t,R as i,p as a}from"./page_layout.js?v=1758532619827";import{b as l}from"./public.js?v=1758532619827";import{B as n}from"./index42.js?v=1758532619827";import{k as r,e as o,r as c,c as d,o as u,R as v,a2 as p,a3 as m,U as _,a4 as g,H as h,V as f,S as w,F as b,O as y,j as S,an as k,a7 as x,_ as T}from"./vue.js?v=1758532619827";import"./naive.js?v=1758532619827";import"./common.js?v=1758532619827";import"./__commonjsHelpers__.js?v=1758532619827";import"./index103.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1758532619827";import"./soft.js?v=1758532619827";import"./index168.js?v=1758532619827";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1758532619827";const L={id:"reportContent",class:"report-content"},H={class:"report-page cover-page"},j={class:"cover-header"},M={class:"report-date"},R={class:"cover-content"},z={class:"level-badge"},E={class:"stats-summary"},A={class:"stats-item"},D={class:"stats-icon warning-icon"},V=["innerHTML"],N={class:"stats-info"},C={class:"stats-value"},O={class:"stats-item"},P={class:"stats-icon cve-icon"},I=["innerHTML"],q={class:"stats-info"},F={class:"stats-value"},U={class:"stats-item"},B={class:"stats-icon scan-icon"},W=["innerHTML"],K={class:"stats-info"},X={class:"stats-value"},Y={class:"cover-info"},G={class:"info-grid"},J={class:"info-item"},Q={class:"info-value"},Z={class:"info-item"},$={class:"info-value"},ss={class:"info-item"},es={class:"info-value"},ts={class:"info-item"},is={class:"info-value"},as={class:"report-page toc-page"},ls={class:"toc-content"},ns={class:"toc-title"},rs={class:"toc-page"},os={class:"report-page content-page"},cs={class:"security-rating"},ds={class:"rating-value"},us={class:"rating-info"},vs=["innerHTML"],ps={class:"rating-date"},ms={class:"last-scan"},_s={class:"report-page content-page"},gs={class:"security-stats"},hs={class:"stats-row"},fs={class:"stats-icon warning-icon"},ws=["innerHTML"],bs={class:"stats-content"},ys={class:"stats-breakdown"},Ss={class:"stats-item high"},ks={class:"stats-item medium"},xs={class:"stats-item low"},Ts={class:"stats-row"},Ls={class:"stats-icon scan-icon"},Hs=["innerHTML"],js={class:"stats-content"},Ms={class:"stats-breakdown breakdown-block"},Rs={class:"breakdown-group"},zs={class:"group-items"},Es={class:"stats-item db-item"},As={class:"breakdown-group"},Ds={class:"group-items"},Vs={class:"stats-item scan-item"},Ns={class:"stats-item scan-item"},Cs={class:"stats-item scan-item"},Os={class:"page-header"},Ps={key:0},Is={class:"page-number"},qs={class:"report-page content-page"},Fs={class:"page-header"},Us={class:"page-number"},Bs={class:"scan-stats"},Ws={class:"stats-row"},Ks={class:"stats-value"},Xs={class:"stats-row"},Ys={class:"stats-value"},Gs={class:"stats-row"},Js={class:"stats-value"},Qs={class:"stats-info"},Zs={class:"stats-desc"},$s={class:"stats-desc"},se={class:"stats-desc"},ee=a(r({__name:"risk-report",setup(a,{expose:r}){const ee='<svg\r\n  t="1658198918096"\r\n  viewBox="0 0 1024 1024"\r\n  version="1.1"\r\n  xmlns="http://www.w3.org/2000/svg"\r\n  p-id="3020">\r\n  <path\r\n    d="M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z"\r\n    p-id="3021">\r\n  </path>\r\n</svg>\r\n',te="<svg class='icon' viewBox='0 0 1024 1024' xmlns='http://www.w3.org/2000/svg' data-spm-anchor-id='a313x.7781069.0.i7'>\r\n\t<path d='M842.667 981.333H181.333A53.393 53.393 0 0 1 128 928V96a53.393 53.393 0 0 1 53.333-53.333H648.08a52.987 52.987 0 0 1 37.713 15.62L880.38 252.873A52.987 52.987 0 0 1 896 290.587V928a53.393 53.393 0 0 1-53.333 53.333zm-661.334-896A10.667 10.667 0 0 0 170.667 96v832a10.667 10.667 0 0 0 10.666 10.667h661.334A10.667 10.667 0 0 0 853.333 928V298.667h-160A53.393 53.393 0 0 1 640 245.333v-160zM682.667 115.5v129.833A10.667 10.667 0 0 0 693.333 256h129.834zM704 768H320a21.333 21.333 0 0 1 0-42.667h384A21.333 21.333 0 0 1 704 768zm0-213.333H320A21.333 21.333 0 0 1 320 512h384a21.333 21.333 0 0 1 0 42.667zm-213.333-256H320A21.333 21.333 0 0 1 320 256h170.667a21.333 21.333 0 0 1 0 42.667z' />\r\n</svg>\r\n",ie=s(),ae=o({first:null,second:null,third:null,fourth:null,fifth:null,sixth:null,malicious_files:null,website_vulnerabilities:null,server_security:null}),le=c(!1),ne=[{key:"high_risk",title:"High-risk issues",component:T((()=>e((()=>import("./HighRiskSection.js?v=1758532619827")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])))),data:()=>{var s;return null==(s=ae.fifth)?void 0:s.focus_high_list},pageSize:2},{key:"mid_risk",title:"Mid-risk issues",component:T((()=>e((()=>import("./MidRiskSection.js?v=1758532619827")),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11])))),data:()=>{var s;return null==(s=ae.fifth)?void 0:s.focus_mid_list},pageSize:2},{key:"cve",title:"CVE vulnerabilities",component:T((()=>e((()=>import("./CveSection.js?v=1758532619827")),__vite__mapDeps([12,1,2,3,4,5,6,7,8,13])))),data:()=>{var s;return null==(s=ae.fifth)?void 0:s.focus_cve_list},pageSize:2},{key:"low_risk",title:"Low-risk issues",component:T((()=>e((()=>import("./LowRiskSection.js?v=1758532619827")),__vite__mapDeps([14,1,2,3,4,5,6,7,8,15])))),data:()=>{var s;return null==(s=ae.sixth)?void 0:s.low_warn_list},pageSize:2},{key:"malicious",title:"Malicious file detection",component:T((()=>e((()=>import("./MaliciousSection.js?v=1758532619827")),__vite__mapDeps([16,1,2,3,4,5,6,7,8,17])))),data:()=>{var s;return null==(s=ae.malicious_files)?void 0:s.detected},pageSize:8},{key:"web_vuln",title:"Website vulnerability detection",component:T((()=>e((()=>import("./WebVulnSection.js?v=1758532619827")),__vite__mapDeps([18,1,2,3,4,5,6,7,8,19])))),data:()=>{var s;return null==(s=ae.website_vulnerabilities)?void 0:s.info},pageSize:1},{key:"server_sec",title:"Server security detection",component:T((()=>e((()=>import("./ServerSecSection.js?v=1758532619827")),__vite__mapDeps([20,1,2,3,4,5,6,7,8,21])))),data:()=>{var s;return null==(s=ae.server_security)?void 0:s.server_security_list},pageSize:8}];const re=d((()=>ne.map((s=>{const e=function(s,e){if(!s||!s.length)return[];const t=[];for(let i=0;i<s.length;i+=e)t.push(s.slice(i,i+e));return t}(s.data(),s.pageSize);return{...s,pages:e,pageCount:e.length}})))),oe=d((()=>{let s=3;const e=[{title:"Security Rating Overview",page:s++},{title:"Security Overview Statistics",page:s++}];return re.value.forEach((t=>{t.pageCount&&(e.push({title:t.title,page:s}),s+=t.pageCount)})),e.push({title:"Scan Statistics",page:s++}),e}));function ce(s,e=0){let t=4;for(const i of re.value){if(i.key===s)return t+e;t+=i.pageCount}return t}return u((()=>{(async()=>{try{le.value=!0;const{message:s}=await n();s&&"object"==typeof s&&(ae.first=s.first||null,ae.second=s.second||null,ae.third=s.third||null,ae.fourth=s.fourth||null,ae.fifth=s.fifth||null,ae.sixth=s.sixth||null,ae.malicious_files=s.malicious_files||null,ae.website_vulnerabilities=s.website_vulnerabilities||null,ae.server_security=s.server_security||null)}finally{le.value=!1}})()})),r({onConfirm:async()=>{if(ie.isFree)return void l({source:399});const s=t.loading("Exporting PDF...");try{const s=await e((()=>import("./html2pdf.js?v=1758532619827").then((s=>s.h))),__vite__mapDeps([22,2,3,1,4,5,6,7,8])),i=document.getElementById("reportContent");if(!i)return void t.error("Failed to get report content");const a={margin:0,filename:"Security Scan Report_".concat((new Date).toISOString().split("T")[0],".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0,scrollX:0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};await s.default().set(a).from(i).save(),t.success("PDF export successful")}catch(i){t.error("PDF export failed")}finally{s.close()}}}),(s,e)=>{const t=i;return v(),p(t,{show:f(le),description:"Loading...",class:"p-20px"},{default:m((()=>{var s,t,i,a,l,n,r,o,c,d,u,m,T,ie,le,ne,de,ue,ve,pe,me,_e,ge,he,fe,we,be,ye,Se,ke,xe,Te,Le,He,je,Me,Re,ze;return[_("div",L,[_("div",H,[_("div",j,[e[0]||(e[0]=_("div",{class:"logo"},[_("img",{src:"/static/vite/images/aapanel.png",alt:"Logo"}),_("div",{class:"logo-text"},"aaPanel Security")],-1)),_("div",M,g((new Date).toISOString().split("T")[0]),1)]),_("div",R,[e[5]||(e[5]=_("h1",{class:"report-title"},"Security Scan Report",-1)),_("div",{class:h(["security-level","level-"+((null==(t=null==(s=f(ae).second)?void 0:s.level)?void 0:t.toLowerCase())||"normal")])},[_("div",z,g((null==(i=f(ae).second)?void 0:i.level)||"Unknown"),1),e[1]||(e[1]=_("div",{class:"level-text"},"Security Level",-1))],2),_("div",E,[_("div",A,[_("div",D,[_("div",{innerHTML:f(ee),class:"w-24px h-24px text-yellow-500"},null,8,V)]),_("div",N,[_("div",C,g(Number((null==(a=f(ae).fourth)?void 0:a.high_warn)||0)+Number((null==(l=f(ae).fourth)?void 0:l.low_warn)||0)+Number((null==(n=f(ae).fourth)?void 0:n.mid_warn)||0)),1),e[2]||(e[2]=_("div",{class:"stats-label"},"Security Risks",-1))])]),_("div",O,[_("div",P,[_("div",{innerHTML:f('<svg t="1735025023293" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10305">\n\t<path d="M896 170.666667H128v512h768V170.666667zM85.333333 85.333333h853.333334c23.552 0 42.666667 16.981333 42.666666 37.930667v606.805333c0 20.949333-19.114667 37.930667-42.666666 37.930667H85.333333c-23.552 0-42.666667-16.981333-42.666666-37.930667V123.264C42.666667 102.314667 61.781333 85.333333 85.333333 85.333333z m196.266667 768h460.8c14.165333 0 25.6 9.557333 25.6 21.333334v42.666666c0 11.776-11.434667 21.333333-25.6 21.333334H281.6c-14.122667 0-25.6-9.557333-25.6-21.333334v-42.666666c0-11.776 11.477333-21.333333 25.6-21.333334z m187.733333-106.666666h85.333334v128h-85.333334v-128z" p-id="10306"></path>\n</svg>'),class:"w-24px h-24px text-purple-500"},null,8,I)]),_("div",q,[_("div",F,g((null==(r=f(ae).fourth)?void 0:r.cve_num)||0),1),e[3]||(e[3]=_("div",{class:"stats-label"},"Scan Item",-1))])]),_("div",U,[_("div",B,[_("div",{innerHTML:f(te),class:"w-24px h-24px text-blue-500"},null,8,W)]),_("div",K,[_("div",X,g(Number((null==(o=f(ae).fourth)?void 0:o.web_num)||0)+Number((null==(c=f(ae).fourth)?void 0:c.sys_num)||0)+Number((null==(d=f(ae).fourth)?void 0:d.kernel_num)||0)),1),e[4]||(e[4]=_("div",{class:"stats-label"},"Detection Type",-1))])])])]),_("div",Y,[_("div",G,[_("div",J,[e[6]||(e[6]=_("div",{class:"info-label"},"Host Name",-1)),_("div",Q,g((null==(u=f(ae).first)?void 0:u.host)||"Unknown"),1)]),_("div",Z,[e[7]||(e[7]=_("div",{class:"info-label"},"IP Address",-1)),_("div",$,g((null==(m=f(ae).first)?void 0:m.ip)||"Unknown"),1)]),_("div",ss,[e[8]||(e[8]=_("div",{class:"info-label"},"Report Date",-1)),_("div",es,g((null==(T=f(ae).first)?void 0:T.date)||"Unknown"),1)]),_("div",ts,[e[9]||(e[9]=_("div",{class:"info-label"},"Last Scan",-1)),_("div",is,g((null==(ie=f(ae).second)?void 0:ie.last_date)||"Unknown"),1)])])]),e[10]||(e[10]=_("div",{class:"cover-footer"},[_("div",{class:"footer-text"},"aaPanel Security Scanning System"),_("div",{class:"footer-note"},"This report provides a comprehensive security assessment of your server.")],-1))]),_("div",as,[e[12]||(e[12]=_("div",{class:"toc-header"},[_("h2",null,"Table of Contents")],-1)),_("div",ls,[(v(!0),w(b,null,y(f(oe),((s,t)=>(v(),w("div",{class:"toc-item",key:s.title},[_("span",ns,g(t+1)+". "+g(s.title),1),e[11]||(e[11]=_("span",{class:"toc-dots"},"...",-1)),_("span",rs,g(s.page),1)])))),128))])]),_("div",os,[e[14]||(e[14]=_("div",{class:"page-header"},[_("h2",null,"1. Security Rating Overview"),_("div",{class:"page-number"},"3")],-1)),_("div",cs,[_("div",{class:h(["rating-card","level-"+((null==(le=f(ae).second)?void 0:le.total_level.toLowerCase())||"normal")])},[_("div",ds,g((null==(ne=f(ae).second)?void 0:ne.total_level)||"Unknown"),1),e[13]||(e[13]=_("div",{class:"rating-label"},"Security Level",-1))],2),_("div",us,[_("div",{class:"rating-reason",innerHTML:(null==(de=f(ae).second)?void 0:de.level_reason)||""},null,8,vs),_("div",ps," Report Date: "+g((null==(ue=f(ae).second)?void 0:ue.date)||""),1),_("div",ms," Last Scan: "+g((null==(ve=f(ae).second)?void 0:ve.last_date)||""),1)])])]),_("div",_s,[e[19]||(e[19]=_("div",{class:"page-header"},[_("h2",null,"2. Security Overview Statistics"),_("div",{class:"page-number"},"4")],-1)),_("div",gs,[_("div",hs,[_("div",fs,[_("div",{innerHTML:f(ee),class:"w-24px h-24px text-yellow-500"},null,8,ws)]),_("div",bs,[_("div",null,[e[15]||(e[15]=_("div",{class:"stats-label"},"Security Risks",-1)),_("div",{class:h(["stats-value",{"text-warning!":Number((null==(pe=f(ae).fourth)?void 0:pe.high_warn)||0)+Number((null==(me=f(ae).fourth)?void 0:me.low_warn)||0)+Number((null==(_e=f(ae).fourth)?void 0:_e.mid_warn)||0)>0}])},g(Number((null==(ge=f(ae).fourth)?void 0:ge.high_warn)||0)+Number((null==(he=f(ae).fourth)?void 0:he.low_warn)||0)+Number((null==(fe=f(ae).fourth)?void 0:fe.mid_warn)||0)),3)]),_("div",ys,[_("span",Ss,"High: "+g((null==(we=f(ae).fourth)?void 0:we.high_warn)||0),1),_("span",ks,"Medium: "+g((null==(be=f(ae).fourth)?void 0:be.mid_warn)||0),1),_("span",xs,"Low: "+g((null==(ye=f(ae).fourth)?void 0:ye.low_warn)||0),1)])])]),_("div",Ts,[_("div",Ls,[_("div",{innerHTML:f(te),class:"w-24px h-24px text-blue-500"},null,8,Hs)]),_("div",js,[e[18]||(e[18]=_("div",{class:"stats-label"},"Virus Database & Scan Types",-1)),_("div",Ms,[_("div",Rs,[e[16]||(e[16]=_("div",{class:"group-title db-label"},"🦠 Virus Database",-1)),_("div",zs,[_("span",Es,"Number: "+g((null==(Se=f(ae).fourth)?void 0:Se.cve_num)||0),1)])]),_("div",As,[e[17]||(e[17]=_("div",{class:"group-title scan-label"},"🔍 Scan Types",-1)),_("div",Ds,[_("span",Vs,"Web risk: "+g((null==(ke=f(ae).fourth)?void 0:ke.web_num)||0),1),_("span",Ns,"System risk: "+g((null==(xe=f(ae).fourth)?void 0:xe.sys_num)||0),1),_("span",Cs,"Kernel risk: "+g((null==(Te=f(ae).fourth)?void 0:Te.kernel_num)||0),1)])])])])])])]),(v(!0),w(b,null,y(f(re),(s=>(v(),w(b,null,[(v(!0),w(b,null,y(s.pages,((e,t)=>(v(),w("div",{key:t,class:"report-page content-page"},[_("div",Os,[_("h2",null,[S(g(s.title),1),t>0?(v(),w("span",Ps,"（Continue "+g(t+1)+"）",1)):k("",!0)]),_("div",Is,g(ce(s.key,t)),1)]),(v(),p(x(s.component),{data:e,"total-pages":s.pageCount,"page-index":t},null,8,["data","total-pages","page-index"]))])))),128))],64)))),256)),_("div",qs,[_("div",Fs,[e[20]||(e[20]=_("h2",null,"Scan Statistics",-1)),_("div",Us,g(ce("stats",0)),1)]),_("div",Bs,[_("div",Ws,[e[21]||(e[21]=_("div",{class:"stats-label"},"Number of Security Scans:",-1)),_("div",Ks,g((null==(Le=f(ae).third)?void 0:Le.warn_times)||0),1)]),_("div",Xs,[e[22]||(e[22]=_("div",{class:"stats-label"},"Number of Vulnerability Scans:",-1)),_("div",Ys,g((null==(He=f(ae).third)?void 0:He.cve_times)||0),1)]),_("div",Gs,[e[23]||(e[23]=_("div",{class:"stats-label"},"Number of Repair Actions:",-1)),_("div",Js,g((null==(je=f(ae).third)?void 0:je.repair_times)||0),1)]),_("div",Qs,[_("div",Zs,g((null==(Me=f(ae).third)?void 0:Me.second_warn)||""),1),_("div",$s,g((null==(Re=f(ae).third)?void 0:Re.second_cve)||""),1),_("div",se,g((null==(ze=f(ae).third)?void 0:ze.repair)||""),1)])])])])]})),_:1},8,["show"])}}}),[["__scopeId","data-v-661164a0"]]);export{ee as default};
