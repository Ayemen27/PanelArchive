System.register(["./index-legacy.js?v=1758532619827","./public-legacy.js?v=1758532619827","./page_layout-legacy.js?v=1758532619827","./ResourceManagerWindow-legacy.js?v=1758532619827","./naive-legacy.js?v=1758532619827","./vue-legacy.js?v=1758532619827","./common-legacy.js?v=1758532619827","./__commonjsHelpers__-legacy.js?v=1758532619827","./index-legacy39.js?v=1758532619827","./soft-legacy2.js?v=1758532619827","./soft-legacy.js?v=1758532619827","./file-legacy2.js?v=1758532619827","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1758532619827"],(function(e,a){"use strict";var l,t,i,n,u,s,c,o,p,r,d,f,m,k,v,g,h,y,b,_,x,w,M,j,C,B,P,R;return{setters:[e=>{l=e._},e=>{t=e.f,i=e.a,n=e.h},e=>{u=e.a7,s=e.t,c=e.w,o=e.m,p=e._},e=>{r=e.R},e=>{d=e.au,f=e.aC,m=e.az},e=>{k=e.k,v=e.P,g=e.i,h=e.r,y=e.aw,b=e.R,_=e.S,x=e.X,w=e.a3,M=e.U,j=e.V,C=e.j,B=e.a4,P=e.aj,R=e.F},null,null,null,null,null,null,null],execute:function(){const a={class:"p-20px"},U={class:"flex items-center gap-16px mb-16px"},N={class:"p-20px"},S={class:"mb-16px text-14px"},q={class:"flex items-center gap-20px"},z={class:"text-13px"};e("default",k({__name:"Backup",setup(e,{expose:k}){const{t:D}=v(),F=g("fileStore"),{currentPath:O,backupForm:T}=F,H=h(!1),V=h(!1),W=h([]);k({open(){T.value.path="",H.value=!0,K()},close(){H.value=!1,W.value=[]}});const X=h(!1),A=y("resourceManagerRef"),E=h([{key:"time",title:D("file.backupModal.backupTime"),width:160,render:e=>u(e.time)},{key:"path",title:D("file.backupModal.backupPath"),ellipsis:{tooltip:!0}},{key:"name",title:D("file.backupModal.backupName"),width:120,ellipsis:{tooltip:!0},render:e=>e.name||"--"},t({width:100,options:e=>[{label:D("Public.Btn.Delete"),onClick:()=>{i({title:D("file.backupModal.deleteBackup"),content:D("file.backupModal.deleteConfirm"),onConfirm:async()=>{await s.post("/files?action=del_path_premissions",{id:e.id},{requestOptions:{loading:D("file.backupModal.deletingBackup"),successMessage:!0}}),K()}})}}]})]);function G(){A.value?.open()}function I(e){T.value.path=e}function J(){T.value.path?X.value=!0:o.warning(D("file.backupModal.pleaseSelectPath"))}async function K(){try{V.value=!0;const{message:e}=await s.post("/files?action=get_all_back");c(e)?W.value=e.map((e=>({id:Number(e[0]),time:Number(e[2]),name:e[1],path:e[3]}))):W.value=[]}finally{V.value=!1}}async function L(){try{await s.post("/files?action=back_path_permissions",T.value,{requestOptions:{loading:D("file.backupModal.executingBackup"),successMessage:!0}}),K(),T.value.path="",T.value.remark=""}catch(e){console.warn(e)}}return(e,t)=>{const i=d,u=p,s=f,c=m,o=n,k=l;return b(),_(R,null,[x(k,{show:j(H),"onUpdate:show":t[1]||(t[1]=e=>P(H)?H.value=e:null),title:j(D)("file.backupModal.title"),width:"700"},{default:w((()=>[M("div",a,[M("div",U,[x(c,null,{default:w((()=>[x(i,{value:j(T).path,"onUpdate:value":t[0]||(t[0]=e=>j(T).path=e)},null,8,["value"]),x(s,{onClick:G},{icon:w((()=>[x(u,{name:"file-dir",size:"20"})])),_:1})])),_:1}),x(s,{type:"primary",onClick:J},{default:w((()=>[C(B(j(D)("file.backupModal.backupButton")),1)])),_:1})]),x(o,{loading:j(V),"max-height":370,data:j(W),columns:j(E)},null,8,["loading","data","columns"])])])),_:1},8,["show","title"]),x(k,{show:j(X),"onUpdate:show":t[3]||(t[3]=e=>P(X)?X.value=e:null),title:j(D)("file.backupModal.confirmTitle"),width:320,footer:!0,onConfirm:L},{default:w((()=>[M("div",N,[M("div",S,B(j(D)("file.backupModal.enterBackupName")),1),M("div",q,[M("div",z,B(j(D)("file.backupModal.remarks")),1),x(i,{class:"flex-1",value:j(T).remark,"onUpdate:value":t[2]||(t[2]=e=>j(T).remark=e)},null,8,["value"])])])])),_:1},8,["show","title"]),x(r,{ref_key:"resourceManagerRef",ref:A,"current-path":j(O),onChooseDir:I},null,8,["current-path"])],64)}}}))}}}));
